var agt=navigator.userAgent.toLowerCase();var is_major=parseInt(navigator.appVersion);var is_minor=parseFloat(navigator.appVersion);var is_nav=((agt.indexOf("mozilla")!=-1)&&(agt.indexOf("spoofer")==-1)&&(agt.indexOf("compatible")==-1)&&(agt.indexOf("opera")==-1)&&(agt.indexOf("webtv")==-1)&&(agt.indexOf("hotjava")==-1));var is_nav2=(is_nav&&(is_major==2));var is_nav3=(is_nav&&(is_major==3));var is_nav4=(is_nav&&(is_major==4));var is_nav4up=(is_nav&&(is_major>=4));var is_navonly=(is_nav&&((agt.indexOf(";nav")!=-1)||(agt.indexOf("; nav")!=-1)));var is_nav6=(is_nav&&(is_major==5));var is_nav6up=(is_nav&&(is_major>=5));var is_gecko=(agt.indexOf("gecko")!=-1);var is_ie=((agt.indexOf("msie")!=-1)&&(agt.indexOf("opera")==-1));is_ie=is_ie||(agt.search(/trident.*; rv:[0-9.]+/)>=0);var is_ie3=(is_ie&&(is_major<4));var is_ie4=(is_ie&&(is_major==4)&&(agt.indexOf("msie 4")!=-1));var is_ie4up=(is_ie&&(is_major>=4));var is_ie5=(is_ie&&(is_major==4)&&(agt.indexOf("msie 5.0")!=-1));var is_ie5_5=(is_ie&&(is_major==4)&&(agt.indexOf("msie 5.5")!=-1));var is_ie5up=(is_ie&&!is_ie3&&!is_ie4);var is_ie5_5up=(is_ie&&!is_ie3&&!is_ie4&&!is_ie5);var is_ie6=(is_ie&&(is_major==4)&&(agt.indexOf("msie 6.")!=-1));var is_ie6up=(is_ie&&!is_ie3&&!is_ie4&&!is_ie5&&!is_ie5_5);var is_aol=(agt.indexOf("aol")!=-1);var is_aol3=(is_aol&&is_ie3);var is_aol4=(is_aol&&is_ie4);var is_aol5=(agt.indexOf("aol 5")!=-1);var is_aol6=(agt.indexOf("aol 6")!=-1);var is_opera=(agt.indexOf("opera")!=-1);var is_opera2=(agt.indexOf("opera 2")!=-1||agt.indexOf("opera/2")!=-1);var is_opera3=(agt.indexOf("opera 3")!=-1||agt.indexOf("opera/3")!=-1);var is_opera4=(agt.indexOf("opera 4")!=-1||agt.indexOf("opera/4")!=-1);var is_opera5=(agt.indexOf("opera 5")!=-1||agt.indexOf("opera/5")!=-1);var is_opera5up=(is_opera&&!is_opera2&&!is_opera3&&!is_opera4);var is_webtv=(agt.indexOf("webtv")!=-1);var is_TVNavigator=((agt.indexOf("navio")!=-1)||(agt.indexOf("navio_aoltv")!=-1));var is_AOLTV=is_TVNavigator;var is_hotjava=(agt.indexOf("hotjava")!=-1);var is_hotjava3=(is_hotjava&&(is_major==3));var is_hotjava3up=(is_hotjava&&(is_major>=3));var is_js;if(is_nav2||is_ie3){is_js=1}else{if(is_nav3){is_js=1.1}else{if(is_opera5up){is_js=1.3}else{if(is_opera){is_js=1.1}else{if((is_nav4&&(is_minor<=4.05))||is_ie4){is_js=1.2}else{if((is_nav4&&(is_minor>4.05))||is_ie5){is_js=1.3}else{if(is_hotjava3up){is_js=1.4}else{if(is_nav6||is_gecko){is_js=1.5}else{if(is_nav6up){is_js=1.5}else{if(is_ie5up){is_js=1.3}else{is_js=0}}}}}}}}}}var is_win=((agt.indexOf("win")!=-1)||(agt.indexOf("16bit")!=-1));var is_win95=((agt.indexOf("win95")!=-1)||(agt.indexOf("windows 95")!=-1));var is_win16=((agt.indexOf("win16")!=-1)||(agt.indexOf("16bit")!=-1)||(agt.indexOf("windows 3.1")!=-1)||(agt.indexOf("windows 16-bit")!=-1));var is_win31=((agt.indexOf("windows 3.1")!=-1)||(agt.indexOf("win16")!=-1)||(agt.indexOf("windows 16-bit")!=-1));var is_winme=((agt.indexOf("win 9x 4.90")!=-1));var is_win2k=((agt.indexOf("windows nt 5.0")!=-1));var is_win98=((agt.indexOf("win98")!=-1)||(agt.indexOf("windows 98")!=-1));var is_winnt=((agt.indexOf("winnt")!=-1)||(agt.indexOf("windows nt")!=-1));var is_win32=(is_win95||is_winnt||is_win98||((is_major>=4)&&(navigator.platform=="Win32"))||(agt.indexOf("win32")!=-1)||(agt.indexOf("32bit")!=-1));var is_os2=((agt.indexOf("os/2")!=-1)||(navigator.appVersion.indexOf("OS/2")!=-1)||(agt.indexOf("ibm-webexplorer")!=-1));var is_mac=(agt.indexOf("mac")!=-1);var is_safari=(agt.indexOf("safari")!=-1);if(is_mac&&is_ie5up){is_js=1.4}var is_mac68k=(is_mac&&((agt.indexOf("68k")!=-1)||(agt.indexOf("68000")!=-1)));var is_macppc=(is_mac&&((agt.indexOf("ppc")!=-1)||(agt.indexOf("powerpc")!=-1)));var is_sun=(agt.indexOf("sunos")!=-1);var is_sun4=(agt.indexOf("sunos 4")!=-1);var is_sun5=(agt.indexOf("sunos 5")!=-1);var is_suni86=(is_sun&&(agt.indexOf("i86")!=-1));var is_irix=(agt.indexOf("irix")!=-1);var is_irix5=(agt.indexOf("irix 5")!=-1);var is_irix6=((agt.indexOf("irix 6")!=-1)||(agt.indexOf("irix6")!=-1));var is_hpux=(agt.indexOf("hp-ux")!=-1);var is_hpux9=(is_hpux&&(agt.indexOf("09.")!=-1));var is_hpux10=(is_hpux&&(agt.indexOf("10.")!=-1));var is_aix=(agt.indexOf("aix")!=-1);var is_aix1=(agt.indexOf("aix 1")!=-1);var is_aix2=(agt.indexOf("aix 2")!=-1);var is_aix3=(agt.indexOf("aix 3")!=-1);var is_aix4=(agt.indexOf("aix 4")!=-1);var is_linux=(agt.indexOf("inux")!=-1);var is_sco=(agt.indexOf("sco")!=-1)||(agt.indexOf("unix_sv")!=-1);var is_unixware=(agt.indexOf("unix_system_v")!=-1);var is_mpras=(agt.indexOf("ncr")!=-1);var is_reliant=(agt.indexOf("reliantunix")!=-1);var is_dec=((agt.indexOf("dec")!=-1)||(agt.indexOf("osf1")!=-1)||(agt.indexOf("dec_alpha")!=-1)||(agt.indexOf("alphaserver")!=-1)||(agt.indexOf("ultrix")!=-1)||(agt.indexOf("alphastation")!=-1));var is_sinix=(agt.indexOf("sinix")!=-1);var is_freebsd=(agt.indexOf("freebsd")!=-1);var is_bsd=(agt.indexOf("bsd")!=-1);var is_unix=((agt.indexOf("x11")!=-1)||is_sun||is_irix||is_hpux||is_sco||is_unixware||is_mpras||is_reliant||is_dec||is_sinix||is_aix||is_linux||is_bsd||is_freebsd);var is_vms=((agt.indexOf("vax")!=-1)||(agt.indexOf("openvms")!=-1));var geckoVersion;if(is_gecko){geckoVersion=parseInt(agt.substr((agt.indexOf("gecko")+6),8))}var is_nav71up=(geckoVersion>=20030312);var is_firefox=(agt.indexOf("firefox")!=-1);var is_firefox1=(agt.indexOf("firefox/1")!=-1);var is_firefox1up=(geckoVersion>=20041103);var is_firefox2=(agt.indexOf("firefox/2")!=-1);var is_firefox2up=(!is_firefox1&&geckoVersion>=20060821);var is_firefox3=(agt.indexOf("firefox/3")!=-1);var is_firefox3up=(!is_firefox3&&geckoVersion>=20090326);var is_ie7=(is_ie&&(is_major==4)&&(agt.indexOf("msie 7.")!=-1));var is_ie7up=(is_ie&&!is_ie3&&!is_ie4&&!is_ie5&&!is_ie5_5&&!is_ie6);var is_safari=(agt.indexOf("safari")!=-1);var safariVersion;if(is_safari){safariVersion=parseInt(agt.substr((agt.indexOf("safari")+7)))}var is_safari1up=(safariVersion>=85);var is_safari2up=(safariVersion>=412);var NS6=(navigator.vendor==("Netscape6")||navigator.product==("Gecko"));var IE=(document.all)?true:false;var IE4=IE&&!DOM;var IE5=(IE4&&navigator.appVersion.indexOf("5.")!=-1);var DOM=(document.getElementById)?true:false;var currTree=null;var KEY_CODE_TAB="9";var KEY_CODE_ENTER="13";var KEY_CODE_ESCAPE="27";var DISPLAY_TYPE_NONE="none";var DISPLAY_TYPE_INLINE="inline";var DISPLAY_TYPE_BLOCK="block";var DISPLAY_TYPE_INLINE_BLOCK="inline-block";var DISPLAY_TYPE_TABLE_ROW="table-row";var preCancelEditObject=null;var headingAnchorId="";var RIGHTPANECONTENT="rightpanecontent";var TABSVIEW_WRAPPER="tabsview_wrapper";var CONTENT_VIEW="content_view";var RIGHTPANECONTENT_SUBTABS="rightpanecontentsubTabs";var QUICK_VIEW_CONTAINER="QUICK_VIEW_CONTAINER";var ON_LOAD="onLoad";var ON_UNLOAD="onUnLoad";var ON_WINDOW_RESIZE="onWindowResize";var OBJECT_CHANGED="objectChanged";var REFRESH_PAGE="refresh_page";var LEFTPANECONTENT="leftpane";var isDeleteActionInvoked=false;function addEvent(B,C,A){return YAHOO.util.Event.addListener(B,C,A)}function $(A){return YAHOO.util.Dom.get(A)}function addLoadEvent(A){return YAHOO.util.Event.addListener(window,"load",A)}function addResizeEvent(A){return YAHOO.util.Event.addListener(window,"resize",A)}function getEvent(A){evt=(A)?A:((window.event)?window.event:"");return(evt)}function getEventTarget(A){A=getEvent(A);tgt=(A.target)?A.target:A.srcElement;return(tgt)}function getEventX(A){A=getEvent(A);if(A.pageX){return(A.pageX)}else{if(typeof A.clientX!="undefined"){return(A.clientX)}}return 0}function getEventY(A){A=getEvent(A);if(A.pageY){return(A.pageY)}else{if(typeof A.clientY!="undefined"){return(A.clientY)}}return 0}function getEventModifiers(A){A=getEvent(A);var B={shift:false,ctrl:false,alt:false};if(A.modifiers&Event.SHIFT_MASK){B.shift=true}else{if(A.shiftKey&&A.shiftKey==true){B.shift=true}}if(A.modifiers&Event.CTRL_MASK){B.ctrl=true}else{if(A.ctrlKey&&A.ctrlKey==true){B.ctrl=true}}if(A.modifiers&Event.ALT_MASK){B.alt=true}else{if(A.altKey&&A.altKey==true){B.alt=true}}return B}function getEventKeyCode(A){A=getEvent(A);var B=null;if(A.keyCode){B=A.keyCode}else{if(A.which){B=A.which}}return B}function getElementsByClassName(B,G,E){var D=[];if(G==null){G=document}if(E==null){E="*"}var A=G.getElementsByTagName(E);var C=A.length;var F=new RegExp("(^|\\s)"+B+"(\\s|$)");for(i=0,j=0;i<C;i++){if(F.test(A[i].className)){D[j]=A[i];j++}}return(D)}function getChildren(A){return YAHOO.util.Dom.getElementsBy(isValid,"*",A)}function isValid(){return true}function getInsideWindowWidth(){if(window.innerWidth){return window.innerWidth}else{if(document.compatMode&&(document.compatMode.indexOf("CSS1")>=0)){return document.body.parentElement.clientWidth}else{if(document.body&&document.body.clientWidth){return document.body.clientWidth}}}return 0}function getInsideWindowHeight(){if(window.innerHeight){return window.innerHeight}else{if(document.compatMode&&(document.compatMode.indexOf("CSS1")>=0)){return document.body.parentElement.clientHeight}else{if(document.body&&document.body.clientHeight){return document.body.clientHeight}}}return 0}function setClassName(D,A,C){if(D){if(typeof(D)=="object"&&D.length&&D.length>1){for(var B=0;B<D.length;B++){setClassName(D[B],A,C)}}else{if(C&&D.className){D.className=D.className+" "+A}else{D.className=A}}}}function setDisabled(B,C){if(typeof(B)=="object"&&B.length&&B.length>1){for(var A=0;A<B.length;A++){setDisabledName(B[A],C)}}else{B.disabled=bool_disabled}}function setDisplayType(B,A){if(!B||!A){return}B.style.display=A}function toggleBlock(A){if(typeof(A)=="string"){A=$(A)}if(A.style.display==DISPLAY_TYPE_NONE){setDisplayType(A,DISPLAY_TYPE_BLOCK)}else{setDisplayType(A,DISPLAY_TYPE_NONE)}}function registerNS(D){var C=D.split(".");var A=window;for(var B=0;B<C.length;B++){if(typeof A[C[B]]=="undefined"){A[C[B]]=new Object()}A=A[C[B]]}}registerNS("agile.ux.framework");registerNS("AGILE.util");registerNS("AGILE.EventManager");registerNS("AGILE.widget");registerNS("AGILE.grid");registerNS("AGILE.WindowManager");registerNS("AGILE.SessionManager");Array.prototype.sortRowIds=function(){var C=[];var D=[];for(var B=0;B<this.length;B++){C[C.length]=parseInt(this[B].substr(1),10);D[C[C.length-1]]=this[B]}C.sort(function(F,E){return F-E});var A=[];for(var B=0;B<C.length;B++){A[A.length]=D[C[B]]}return A};Array.prototype.removeDuplicates=function(){var B=[];for(var C=0;C<this.length;C++){if(this[C].strim()!=""){B[B.length]=this[C].strim()}}B.sort();var A=[];for(var C=0;C<B.length;C++){if(B[C]==B[C+1]){continue}A[A.length]=B[C]}return A};Array.prototype.removeEntry=function(C){var A=[];for(var B=0;B<this.length;B++){if(this[B]!=C){A[A.length]=this[B]}}return A};Array.prototype.contains=function(B){for(var A=0;A<this.length;A++){if(B==this[A]){return true}if(B.equals){if(B.equals(this[A])){return true}}}return false};Array.prototype.clear=function(){this.length=0};Array.prototype.inArray=function(B){for(var A=0;A<this.length;A++){if(this[A]===B){return true}}return false};String.prototype.vtrim=function(){var A=this;A=A.replace(/^\s*(.*)/,"$1");A=A.replace(/(.*?)\s*$/,"$1");return A};String.prototype.htmlToText=function(){var A=this;if(!A){return null}A=A.replace(/&lt;/gi,"<");A=A.replace(/&gt;/gi,">");A=A.replace(/&amp;/gi,"&");A=A.replace(/&quot;/gi,'"');A=A.replace(/&nbsp;/gi,String.fromCharCode(160,160,160));A=A.replace(/'\\'/gi,"'");A=A.replace(/&#039;/gi,"'");return A};String.prototype.trimspace=function(){var A=this;A=A.replace(/^\s*(.*)/,"$1");A=A.replace(/(.*?)\s*$/,"$1");return A};String.prototype.ellipse=function(A){if(this.length>A){return(this.substr(0,A-3)+"...")}return this};String.prototype.textToHTML=function(){var A=this;A=A.replace(/&/g,"&#38;");A=A.replace(/%/g,"&#37;");A=A.replace(/</g,"&lt;");A=A.replace(/>/g,"&gt;");return A};String.prototype.encodeForHTMLAttribute=function(){return this.replace(/&/g,"&#38;").replace(/\"/g,"&#34;").replace(/\'/g,"&#39;").replace(/</g,"&#60;").replace(/>/g,"&#62;")};String.prototype.htmlWS=function(){var A=this;A=A.replace(/ /gi,"&nbsp;");return A};String.prototype.textWS=function(){var A=this;A=A.replace(/&nbsp;/gi," ");return A};String.prototype.htmlConsecutiveWS=function(F){var B=this;F=(!F?"&nbsp;":F);var C="";var G=B.length-1;for(var H=0;H<B.length;H++){var E=B.charAt(H);if(E=="\n"||E=="\r"||E=="\t"){}else{if(E==" "){if(H+1<G){var A=true;for(var D=H+1;D<B.length;D++){var I=B.charAt(D);if(I==" "){if(A){E=F;A=false}E=E+F;H++}else{break}}}}}C=C+E}return C};String.prototype.trim=function(){var A=this;A=A.replace(/^\s*(.*)/,"$1");A=A.replace(/(.*?)\s*$/,"$1");return A};String.prototype.strim=function(){var A=this;A=A.replace(/^\s*(.*)/,"$1");A=A.replace(/(.*?)\s*$/,"$1");return A};String.prototype.chompChar=function(B){var A=this;if(!B){return A}A=A.strim();return((A.charAt(A.length-1,1)==B)?A.slice(0,-1):A)};function trimObjectNumber(B){var A=B.value;if(A){A=A.replace(/^\s*(.*)/,"$1");A=A.replace(/(.*?)\s*$/,"$1");B.value=A}}function sendAJAXRequest(F,G,B,D,E,C,A){document.body.style.cursor="wait";AGILE.util.preServerRequest();if(typeof(C)=="undefined"){C=false}if(typeof(A)=="undefined"){A="PCMServlet"}if(C){return sendAsyncRequest(F,G,B,D,E,A)}else{return sendSyncRequest(F,G,B,D,E,A)}}function sendAsyncRequest(E,G,I,H,C,F){var B=new Date().getTime();var A=xmlRequest();if(I){A.open("GET",E+"&ctr="+B,true)}else{A.open("POST",F,true)}setRequestHeaders(A);var D={success:false,text:"",thisConn:A,requestURL:E};A.onreadystatechange=function(){if(A.readyState==4){handleResponse(A,D);document.body.style.cursor="default";if(G){G.call(H,D,C)}if(C&&C.gridID&&D&&D.requestURL){if(D.requestURL.indexOf("opcode=updateCellWidth")>-1){loadAssistPlus()}else{if(D.requestURL.indexOf("opcode=saveGridTable")>-1&&C.gridID!="BOM_REDLINE_TABLE"){setTimeout(function(){loadAssistPlus()},300)}else{if(D.requestURL.indexOf("opcode=displayObject")>-1){setTimeout(function(){loadAssistPlus()},300)}}}}}};if(I){A.send(null)}else{A.send(E)}return{thisConn:A}}function sendSyncRequest(E,G,I,H,C,F){var B=new Date().getTime();var A=xmlRequest();if(I){A.open("GET",E+"&ctr="+B,false)}else{A.open("POST",F,false)}setRequestHeaders(A);if(I){A.send(null)}else{A.send(E)}var D={success:false,text:"",thisConn:A,requestURL:E};if(A.readyState==4){handleResponse(A,D);document.body.style.cursor="default";if(G){if(D&&D.requestURL){if(D.requestURL.indexOf("opcode=loadSelectedAffectedItemRow")>-1){setTimeout(function(){loadAssistPlus()},300)}}return G.call(H,D,C)}}return D}function setRequestHeaders(B){B.setRequestHeader("Cache-Control","no-cache");B.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");var A=prepareCSRFToken();if(A){B.setRequestHeader(A.name,A.value)}}function prepareCSRFToken(){if(AGILE&&AGILE.security&&AGILE.security.csrf){var B=AGILE.security.csrf.tokenName;var A=AGILE.security.csrf.tokenValue;if(B&&A){return{name:B,value:A}}}return null}function handleResponse(B,A){var C=B.getResponseHeader("Content-Type");if(C&&C.indexOf("text/xml")!=-1){A.xml=B.responseXML}A.text=B.responseText;if(A.text.indexOf("hcmLoginForm")!=-1){alert("Session has been timed out, please relogin");return}if(A.text.indexOf("Error")!=0){A.success=true}}function resetHeaderWrapperContent(){return;var H=windowSize();var G=2;var E=H[0];var B=H[1];var A=document.getElementById("header_tab_wrapper");var D=document.getElementById("pageViewContent");var K=document.getElementById("rightScroll");if(K){var F=K.offsetTop+28;if(D&&F>getOffsetTop(D)){hideScrollButtons()}}if(A){var I=getOffsetTop(A);if(A.scrollHeight<B-I){A.style.height=A.scrollHeight+"px"}else{A.style.height=(B-I-G)+"px"}var J=0;var C=document.getElementById("leftpane");if(C!=null){J=C.offsetWidth}A.style.width=E-J+"px"}}function submitForm2(J,M){var N="MainForm";var K=getForm(N);var L=K.opcode.value;var F=getValue(J,"opcode",K.opcode.value);K.opcode.value=F;if(F=="displayEditObject"){AGILE.richtext.onDisplayEditObject(K)}if(F=="displayEditObject"&&document.getElementById("ObjectInfoPopupDiv_window")&&document.getElementById("ObjectInfoPopupDiv_window").style.display=="block"){var B=getForm("ActivityObjectForm");if(B&&B.displayMode.value=="1"){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,localMsg.coverPageEdited_QVEditingError);return}}var A=getValue(J,"module",K.module.value);K.module.value=A;writeTableInfo(N,F);if(K.target=="RightPane"){K.popup.value="false"}var I=document.body.clientHeight;var P=document.body.clientWidth;var C=I-250;var H=P-50;var G="&START&tableDivHeight="+C+"&tableDivWidth="+H+"&loadTop=false&END&";if(typeof(M)=="undefined"){M=""}K.addlParam.value=M+filterTableDivParams(K.addlParam.defaultValue)+G;setTokenRequired(K);var O=getFormElems(K);var D=O;if(window.name=="RightPane"&&setCursorToHourglass){document.body.style.cursor="wait"}var E=document.getElementById("pageViewContent");if(E){cachedPageViewHeight=E.style.height}if(cachedPageViewHeight){D+="&pageViewHeight="+cachedPageViewHeight}if("invokeCustomProcessActions"==K.opcode.value){K.opcode.value=L}displayContent({params:D},"",N);document.MainForm.isPageDirty.value="false";if(headingAnchorId.length>0){setTimeout("setCoverPageScrollPosition()",400)}}function submitFormForMultipleWindows(args,xtraArgs){var params="ajaxRequest=true&module=ObjectViewHandler&opcode=isMultipleWindowsForSubmit&objid="+getForm("MainForm").objid.value;var handler=function(response){if(response.success){var responseObject=eval("("+response.text+")");if(responseObject.multipleWindowsFlag=="true"){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,responseObject.errorMessage);var disabledButtons=new Array("MSG_Save","MSG_Btn_Validate","MSG_Validate");for(var i=0;i<disabledButtons.length;i++){if(document.getElementById(disabledButtons[i])!=null){document.getElementById(disabledButtons[i]).className="button disabled";document.getElementById(disabledButtons[i]).onclick=""}}}else{submitForm2(args,xtraArgs)}}else{submitForm2(args,xtraArgs)}};sendAJAXRequest(params,handler,false)}function setCoverPageScrollPosition(){var E=headingAnchorId.substring(3);var A=Dom.get(E);if(A){var D=document.getElementById("pageViewContent");var B=document.getElementById("MainPane");var C=jQuery(B).height()-jQuery(D).height();D.scrollTop=Dom.getY(A)-C}}function setHeadingLinkName(A){headingAnchorId=A.id;setPageViewContent()}function cancelEditObject(A){if(preCancelEditObject){preCancelEditObject()}if(checkReqFiledOnChange()){return}tableRowWarningMap=[];submitForm2({opcode:"cancelEditObject"});document.MainForm.isPageDirty.value="false"}function getFormElems(C){var A="";if(C!=null){for(var B=0;B<C.elements.length;B++){var D=C.elements[B];if(D.name){if(D.type=="radio"){if(D.checked){A+=D.name+"="+encodeURIComponent(D.value)+"&"}else{continue}}A+=D.name+"="+encodeURIComponent(D.value)+"&"}}}return A}function getValue(D,A,B){if(typeof(D)=="undefined"){return B}var C=D[A];return typeof(C)!="undefined"&&C!=""?C:B}function emphasisNode(A,D,B,C){setEmphasisOnTreeNode("treeRowKey",D,A,B,C)}function setEmphasisOnTreeNode(property,value,treeContainerId,action,onload){if(YAHOO.widget.TreeView.getTree(treeContainerId)!=null){if(typeof(property)=="undefined"||typeof(value)=="undefined"){return}if(action=="select"){var thisNode=YAHOO.widget.TreeView.getTree(treeContainerId).getNodesByProperty(property,value);if(thisNode.length>1){return}if(onload){YAHOO.widget.TreeView.getTree(treeContainerId).setFocus(thisNode[0]);YAHOO.widget.TreeView.getTree(treeContainerId).handleNodeSelection(thisNode[0])}thisNode[0].highlightNode(thisNode[0].labelElId);var href=document.getElementById(thisNode[0].labelElId).href;href=href.substring(href.indexOf(":")+1);eval(href)}else{if(action=="expand"){var thisNode=YAHOO.widget.TreeView.getTree(treeContainerId).getNodesByProperty(property,value);if(!thisNode||thisNode.length>1){return}thisNode[0].expand()}}}}AGILE.grid.globalSelect=false;AGILE.events=[];AGILE.EventManager.addEvent=function(A,B,E,F){var D=AGILE.events[A];if(D==null){D=new Hashtable()}var C=D.get(B);if(C==null){C=[]}C[C.length]={callback:E,args:F};D.put(B,C);AGILE.events[A]=D};AGILE.EventManager.fireEvent=function(B,C,D,F){if(!AGILE.events[B]){return}var A=AGILE.events[B].get(C);if(!A){return}for(var E=0;E<A.length;E++){A[E].callback.call(this,D,A[E].args)}};AGILE.EventManager.clearEvents=function(A,C){var B=AGILE.events[A];if(B&&C){B.remove(C)}else{if(B){AGILE.events[A]=new Hashtable()}}};AGILE.util.ActionStatusTracker=function(E,C,B){var D=document.MainForm;if(typeof(C)!="undefined"){D=getForm(C)}this._initialModule=getValue(E,"module",D.module.value);this._initialOpcode=getValue(E,"opcode");this._objid=getValue(E,"objid",D.objid.value);this._classid=getValue(E,"classid",D.classid.value);this._tabid=getValue(E,"tabid",D.tabid.value);this._xtraArgs=B;this._statusTrackerOpcode=getValue(E,"statusTrackerOpcode",this._initialOpcode);this._statusTrackerModule=getValue(E,"statusTrackerModule",this._initialModule);this._callback=getValue(E,"callback");var A=[];A[A.length]="module="+this._initialModule;A[A.length]="opcode="+this._initialOpcode;A[A.length]="objid="+this._objid;A[A.length]="classid="+this._classid;A[A.length]="tabid="+this._tabid;A[A.length]="forwardToPage=false";this._defaultParams=A.join("&")};AGILE.util.ActionStatusTracker.prototype={ACTION_COMPLETE:1,_trackStatusParams:"",_callBackArgs:"",_elem:"",setCallBackArgs:function(A){this._callBackArgs=A},initialize:function(){var A=[];A[A.length]="module="+this._statusTrackerModule;A[A.length]="opcode="+this._statusTrackerOpcode;A[A.length]="objid="+this._objid;A[A.length]="classid="+this._classid;A[A.length]="tabid="+this._tabid;this._trackStatusParams=A.join("&")},invoke:function(A){this._elem=A;if(this._trackStatusParams.length==0){this.initialize()}sendAJAXRequest("PCMServlet?req=req&ajaxRequest=true&"+this._defaultParams+"&"+this._xtraArgs,this.trackStatus,false,this)},trackStatus:function(C,D){var F=C.thisConn.getResponseHeader("ACTION_STATUS");if(F&&F==this.ACTION_COMPLETE){AGILE.util.stopAnimation(this._elem);if(AGILE.util.Prompts[0]){AGILE.util.Prompts[0].hidePrompt()}this._elem=null;var A=C.thisConn.getResponseHeader("BackGroundProcessHasError");var E=C.thisConn.getResponseHeader("InvokeCallBack");if(A!=null&&A.length>0){AGILE.util.DMS.setMessage(1,C.text);if(E!=null&&E.length>0){this._callback.call(this,C,this._callBackArgs)}return}if(this._callback){this._callback.call(this,C,this._callBackArgs)}return}var B=this;setTimeout(function(){sendAJAXRequest("PCMServlet?req=req&ajaxRequest=true&"+B._trackStatusParams+"&"+B._xtraArgs,B.trackStatus,false,B)},2000)},setDefaultParams:function(A){this._defaultParams=A},setTrackStatusParams:function(A){this._trackStatusParams=A},setDefaultParams:function(A){this._defaultParams=A},setTrackStatusParams:function(A){this._trackStatusParams=A},setCallback:function(A){this._callback=A}};AGILE.util.animate=function(A){var B=A;jQuery(B).prepend('<div class="ux_palette_mask_new"></div>')};AGILE.util.stopAnimation=function(){jQuery(".ux_palette_mask_new").remove()};var infoPopup_timer;var cancelQuickViewTimeoutTimer;function cancelQuickViewTimer(A){cancelQuickViewTimeoutTimer=setTimeout(cancelQuickViewLink,1000)}function getAllGrids(){return getAvailableGridDivs()}function getAvailableGridDivs(){if(typeof(Grids)=="undefined"||!Grids||Grids.length==0){return[]}var A=[];var C=[];for(var B=0;B<Grids.length;B++){if(!Grids[B]){continue}out(" Grids["+B+"] => "+Grids[B].id);var D=document.getElementById("treegrid_"+Grids[B].id);if(D&&D.getAttribute("considerForResize")=="true"){if(!C[Grids[B].id]){A[A.length]=D}C[Grids[B].id]=true}}return setYPosGrid(A)}function setYPosGrid(A){if(A.length<=1){return A}var D=getOffsetTop(A[0]);var C=getOffsetTop(A[1]);var B=[];if(D>C){B[B.length]=A[1];B[B.length]=A[0]}else{B[B.length]=A[0];B[B.length]=A[1]}return B}function getFocussedGridId(B){if(B.length==1){return B[0].id.substring(B[0].id.indexOf("_")+1)}for(var C=0;C<B.length;C++){var D=B[C].id.substring(B[C].id.indexOf("_")+1);if(Grids[D].FRow){return D}}var A=B[0];return A.id.substring(A.id.indexOf("_")+1)}function checkWorkflowTab(){return(Grids.length==1&&Grids[0].id=="CHANGETABLE_SIGNOFF_HISTORY")}function checkSubtabs(){for(var A=0;A<Grids.length;A++){if(!Grids[A]){continue}if(Grids[A].id=="ACTIVITY_DISCUSSIONS"){return true}if(Grids[A].id=="USERGROUPTABLE_DISCUSSION"){return true}if((Grids[A].id=="CHANGETABLE_AFFECTEDITEMS"||Grids[A].id=="CHANGETABLE_AFFECTEDFILES")&&(Grids[A]["classid"]!=7000&&Grids[A]["classid"]!=8000&&Grids[A]["classid"]!=11000)){return true}}return false}function ResizeGrid(){out(" Common.js # ResizeGrid "+ResizeGrid.caller.name);var M=getAvailableGridDivs();if(M.length==0){return}if(checkSubtabs()){ResizeGridForSubTabs(M);return}if(checkWorkflowTab()&&typeof(resizeWorkflowDiagram)!="undefined"){resizeWorkflowDiagram()}var B=20;var G=windowSize();var D=M[0];var A=[getOffsetLeft(D),getOffsetTop(D)];var F=G[1]-A[1];if(M.length>1){for(var L=0;L<M.length;L++){var I=M[L].id.substring(M[L].id.indexOf("_")+1);if(!Grids[I]){return}if(L>0){if(document.getElementById("view_controls_"+Grids[I].TableId)){F=F-document.getElementById("view_controls_"+Grids[I].TableId).offsetHeight-20}if(document.getElementById("table_actions_"+Grids[I].TableId)){F=F-document.getElementById("table_actions_"+Grids[I].TableId).offsetHeight}}}var C=F/M.length;for(var L=0;L<M.length;L++){var I=M[L].id.substring(M[L].id.indexOf("_")+1);if(!Grids[I]){return}var J=Grids[I]["Selecting"];var B=(typeof(J)=="undefined"||J)?20:0;var H=Grids[I]["Size"];out(I+"	size "+Grids[I]["Size"]);if(L==0){H=Grids[I]["Size"]?Grids[I]["Size"]:1;var E=(20*H+60);if(E>=C){M[L].style.height=(C-B)+"px"}else{M[L].style.height=E+"px";C=C+(C-E-B)}}else{M[L].style.height=(C-B)+"px"}}}else{var I=D.id.substring(D.id.indexOf("_")+1);var J=true;if(Grids[I]){J=Grids[I]["Selecting"]}var K=(typeof(J)=="undefined"||J)?B:0;if(document.getElementById("wrapper_action_dialog_footer")){K=K+document.getElementById("wrapper_action_dialog_footer").offsetHeight+3}D.style.height=(F-K)+"px"}PostResizeGrid()}PostResizeGrid=function(){};function ResizeGridForSubTabs(K){out("ResizeGridForSubTabs...");var B=20;var E=20*7+16;var H=windowSize();var F=K[0];var A=[getOffsetLeft(F),getOffsetTop(F)];var G=H[1]-A[1];var I=F.id.substring(F.id.indexOf("_")+1);var C=Grids[I]["FullTable"]=="1"?G:G/3;var J=B;F.style.height=(C-J)+"px";if(F&&F.onresize){var D=F.onresize;if(D){D()}}if(K.length>1){A=[getOffsetLeft(K[1]),getOffsetTop(K[1])];G=H[1]-A[1];var J=B;K[1].style.height=(G-J)+"px";if(K[1]&&K[1].onresize){var D=K[1].onresize;if(D){D()}}}PostResizeGrid()}function showFullTableDisplay(E){var D=document.MainForm;D.fulltabledisplay.value="true";D.fullgridtableid.value=E;var C="&addToTrail=false";var A="";if(Grids[E]){A=Grids[E]["TABLE_TITLE_"+E];if(typeof(A)!="undefined"){C=C+"&TABLE_TITLE_"+E+"="+A}var B=(typeof(Grids[E]["NAV_TO_KEY"])!="undefined"?Grids[E]["NAV_TO_KEY"]:"");if(D.NAV_TO_KEY){D.NAV_TO_KEY.value=B}else{C=C+"&NAV_TO_KEY="+B}if(!D.SELECTED_PARENT_ROWID&&typeof(Grids[E]["SelectedParentId"])!="undefined"){C=C+"&SELECTED_PARENT_ROWID="+Grids[E]["SelectedParentId"]}AGILE.util.getSelectedRowsByTableId(Grids[E]["TableId"])}else{if(E=="ITEMTABLE_TITLEBLOCK_RED"){if(!D.NAV_TO_KEY){C=C+"&NAV_TO_KEY="+D.NAV_TO_KEY.value}C=C+"&SELECTED_PARENT_ROWID="+D.SELECTED_PARENT_ROWID.value}}C=C+"&RETAIN_SELECTIONS=true";displayObject(D.module.value,D.classid.value,D.objid.value,D.tabid.value,"","",C,"",RIGHTPANECONTENT)}function hideFullTableDisplay(F){var E=document.MainForm;E.fulltabledisplay.value="false";var C="&addToTrail=false";if(Grids[F]){C=C+"&NAV_TO_KEY=";var B=(typeof(Grids[F]["NAV_TO_KEY"])!="undefined"?Grids[F]["NAV_TO_KEY"]:"");if(E.NAV_TO_KEY){E.NAV_TO_KEY.value=B}else{C=C+"&NAV_TO_KEY="+B}var A=Grids[F]["TABLE_TITLE_"+F];if(typeof(A)!="undefined"){C=C+"&TABLE_TITLE_"+F+"="+A}var D=AGILE.grid.rowSelections[F].getLastSelectedRow();if(D){C=C+"&SELECTED_PARENT_ROWID="+D}else{if(!E.SELECTED_PARENT_ROWID&&typeof(Grids[F]["SelectedParentId"])!="undefined"){C=C+"&SELECTED_PARENT_ROWID="+Grids[F]["SelectedParentId"]}}AGILE.util.getSelectedRowsByTableId(Grids[F]["TableId"])}else{if(F=="ITEMTABLE_TITLEBLOCK_RED"){C=C+"&NAV_TO_KEY="+E.NAV_TO_KEY.value;C=C+"&SELECTED_PARENT_ROWID="+E.SELECTED_PARENT_ROWID.value}}C=C+"&RETAIN_SELECTIONS=true";displayObject(E.module.value,E.classid.value,E.objid.value,E.tabid.value,"","",C,"",RIGHTPANECONTENT);if(E.NAV_TO_KEY){E.NAV_TO_KEY.value=""}}function getOffsetLeft(B){var A=B.offsetLeft;while((B=B.offsetParent)!=null){A+=B.offsetLeft}return A}function getOffsetTop(A){var B=A.offsetTop;while((A=A.offsetParent)!=null){B+=A.offsetTop}return B}function getScrollXY(){var B=0,A=0;if(typeof(window.pageYOffset)=="number"){A=window.pageYOffset;B=window.pageXOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){A=document.body.scrollTop;B=document.body.scrollLeft}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){A=document.documentElement.scrollTop;B=document.documentElement.scrollLeft}}}return[B,A]}var mulResolveItems=null;AGILE.grid.HandleActionDialogForMultipleWarnings=function(H,I){if(mulResolveItems==null){mulResolveItems=new Array()}for(var E=0;E<H.length;E++){mulResolveItems[mulResolveItems.length]=H[E]}if(AGILE.EW.EWView.isWarningPanelVisible()){return}else{H=mulResolveItems}var D="actionDialogWarning";var C=[];var F=[];var B=[];var G=getForm("MainForm");var A="";for(var E=0;E<H.length;E++){C[C.length]=H[E].clientRowId;F[F.length]=H[E].appliedWarnCode;B[B.length]=H[E].entryValue;A=A+H[E].clientRowId+"="+H[E].appliedWarnCode+";"}A=A+";"+I.warningString;if(B.length==0){return}G.pgWarnCode.value="";G.pgWarnID.value="";G.warningString.value="";if(I.pgWarnCode){G.pgWarnCode.value=F.join(";")+";"+I.pgWarnCode;G.pgWarnID.value=C.join(";")+";"+I.pgWarnID;G.warningString.value=A}else{G.pgWarnCode.value=F.join(";");G.pgWarnID.value=C.join(";");G.warningString.value=A}mulResolveItems=null;submitForm("MainForm",G.module.value,G.opcode.value,"_self")};AGILE.grid.HandleActionDialogWarning=function(J,K){var E="actionDialogWarning";var D=[];var G=[];var B=[];var I=getForm("MainForm");var A="";var C=false;for(var F=0;F<J.length;F++){if(J[F].appliedWarnCode==AGILE.EW.WARN_CANCELLED){C=true}D[D.length]=J[F].clientRowId;G[G.length]=J[F].appliedWarnCode;B[B.length]=J[F].entryValue;A=A+J[F].clientRowId+"="+J[F].appliedWarnCode+";"}if(C){try{cancelCreate()}catch(H){}I.pgWarnCode.value="";I.pgWarnID.value="";I.warningString.value="";return}A=A+";"+K.warningString;if(B.length==0){return}if(K.pgWarnCode){I.pgWarnCode.value=G.join(";")+";"+K.pgWarnCode;I.pgWarnID.value=D.join(";")+";"+K.pgWarnID;I.warningString.value=A}else{I.pgWarnCode.value=G.join(";");I.pgWarnID.value=D.join(";");I.warningString.value=A}submitForm("MainForm",I.module.value,I.opcode.value,"_self")};AGILE.grid.HandleCoverPageEditWarning=function(H,I){var D=[];var F=[];var B=[];var G=getForm("MainForm");var A="";var C=false;for(var E=0;E<H.length;E++){if(H[E].appliedWarnCode==AGILE.EW.WARN_CANCELLED){C=true}D[D.length]=H[E].clientRowId;F[F.length]=H[E].appliedWarnCode;B[B.length]=H[E].entryValue;A=A+H[E].clientRowId+"="+H[E].appliedWarnCode+";"}if(C){cancelUpdate();checkWarnings=function(){};G.pgWarnCode.value="";G.pgWarnID.value="";G.warningString.value="";return}A=A+";"+I.warningString;if(B.length==0){return}if(I.pgWarnCode){G.pgWarnCode.value=F.join(";")+";"+I.pgWarnCode;G.pgWarnID.value=D.join(";")+";"+I.pgWarnID;G.warningString.value=A}else{G.pgWarnCode.value=F.join(";");G.pgWarnID.value=D.join(";");G.warningString.value=A}G.isPageDirty.value=I.isPageDirty;checkWarnings=function(){};postHandleCoverPageEditWarning(I)};function postHandleCoverPageEditWarning(A){submitForm2({module:A.module,opcode:A.opcode})}AGILE.grid.HandleRelationshipSaveRuleActionWarning=function(K,L){var E="actionDialogWarning";var D=[];var H=[];var B=[];var J=getForm("MainForm");var A="";var C=false;for(var G=0;G<K.length;G++){if(K[G].appliedWarnCode==AGILE.EW.WARN_CANCELLED){C=true}D[D.length]=K[G].entryValue;H[H.length]=K[G].appliedWarnCode}if(C){try{cancelRuleDialog()}catch(I){}return}if(D.length==0){return}var F="&pgWarnCode="+H.join(";")+"&pgWarnID="+D.join(";");saveRule(F)};AGILE.grid.HandleRelationshipSaveRuleActionWarningForContent=function(L,M){var F="actionDialogWarning";var E=[];var I=[];var C=[];var K=getForm("MainForm");var A="";var D=false;var B="";if(M&&M.GRID_CTX_NAME){B=M.GRID_CTX_NAME}for(var H=0;H<L.length;H++){if(L[H].appliedWarnCode==AGILE.EW.WARN_CANCELLED){D=true}E[E.length]=L[H].entryValue;I[I.length]=L[H].appliedWarnCode}if(D){try{cancelRuleDialogForContent(B)}catch(J){}return}if(E.length==0){return}var G="&pgWarnCode="+I.join(";")+"&pgWarnID="+E.join(";");saveRuleForContent(B,G)};AGILE.util.Prompts=[];AGILE.util.BasePrompt=function(A){this.initialize(A)};AGILE.util.BasePrompt.prototype={_bgmask:null,_prompt:null,_title:null,_message:null,_content:null,_actions:null,_initialFocus:null,_promptId:null,_hidePromptCallBack:null,_id:"",initialize:function(E){this._id=(E)?E:"";var A=document.getElementsByTagName("body")[0];var D=A.childNodes[0];if(document.getElementById(this._id+"bgmask")==null){var C=document.createElement("DIV");C.id=this._id+"bgmask";C.className="prompt_mask";if(D){D.parentNode.insertBefore(C,D)}else{A.appendChild(C)}}this._bgmask=document.getElementById(this._id+"bgmask");this._bgmask.style.display="none";if(document.getElementById(this._id+"prompt_shadow")==null){var B=document.getElementsByTagName("body");var C=document.createElement("DIV");C.id=this._id+"prompt_shadow";C.className="prompt_shadow";if(D){D.parentNode.insertBefore(C,D)}else{A.appendChild(C)}}this._prompt=document.getElementById(this._id+"prompt_shadow");this._prompt.style.display="none";if(this._id.length>0){AGILE.util.Prompts[1]=this}else{AGILE.util.Prompts[0]=this}},setZIndex:function(A){YAHOO.util.Dom.setStyle(this._id+"bgmask","z-index",A)},setShadowZIndex:function(A){YAHOO.util.Dom.setStyle(this._prompt,"z-index",A)},refreshContent:function(){this._prompt.innerHTML=this.getHTMLContent()},getIntialFocusId:function(){return this._initialFocus?this._initialFocus:"close"},setInitialFocusId:function(A){this._initialFocus=A},setPromptId:function(A){this._promptId=A},getPromptId:function(){return this._promptId},getPromptElement:function(){return this._prompt},showPrompt:function(){this.refreshContent();this._bgmask.style.display="";this._prompt.style.display="";var C=windowSize();var A=C[0];var D=C[1];this._prompt.style.left=(A-this._prompt.offsetWidth)/2+"px";this._prompt.style.top=(D-this._prompt.offsetHeight)/2+"px";buttonFocus(this.getIntialFocusId());var B=document.getElementById(this.getIntialFocusId());if(B){B.focus()}},hidePrompt:function(){this._prompt.style.display="none";this._bgmask.style.display="none";if(this._id.length>0){AGILE.util.Prompts[1]=null}else{AGILE.util.Prompts[0]=null}if(this._hidePromptCallBack!=null){this._hidePromptCallBack.call(this)}},setHidePromptCallBack:function(A){this._hidePromptCallBack=A},setMessage:function(A){this._message=A},setTitle:function(A){this._title=A},setContent:function(A){this._content=A},setActions:function(A){this._actions=A},getHTMLContent:function(){var A=[];A[A.length]='<div class="prompt"><fieldset>';if(this._title!=null){A[A.length]="<h4>"+this._title+"</h4>"}if(this.getContent()!=null){A[A.length]=this.getContent()}else{A[A.length]='<p id="popmsg">';A[A.length]=this._message;A[A.length]="<p>"}A[A.length]='<div class="prompt_footer">';if(this.getActions()!=null){A[A.length]=this.getActions()}else{A[A.length]='<a id="close" onblur="buttonBlur(this.id)" onfocus="buttonFocus(this.id)" class="button" ';A[A.length]='href="#" onclick="'+this.getPromptStr()+'.hidePrompt();">';A[A.length]='<span id="closespan">'+localMsg.Close+"</span></a>"}A[A.length]="</div>";A[A.length]="</fieldset></div>";return A.join("")},getContent:function(){return this._content},getActions:function(){return this._actions},getPromptStr:function(){return"AGILE.util.Prompts[0]"},getPrompt:function(){return AGILE.util.Prompts[0]}};(function(){AGILE.util.SimpleShuttleControlManager=function(config){this._shuttleControl=null;this._dataSet=null;this._isTreeView=config.isTreeView?config.isTreeView:false;this._uniqueId=config.id?config.id:"FormatShuttle";this._hideLockButton=config.hideLockButton?config.hideLockButton:false;this._isTreeView=config.isTreeView?config.isTreeView:false;this._bindEl=Dom.get(config.bindEl);this._availableListTitle=config.availableListTitle?config.availableListTitle:null;this._selectedListTitle=config.selectedListTitle?config.selectedListTitle:null;if(!config.dataNotLoaded||(config.dataNotLoaded=="true")){init.call(this,config)}};AGILE.util.SimpleShuttleControlManager.prototype={setControlsHeight:function(height){if(this._shuttleControl){this._shuttleControl.setControlsHeight(height)}},setInitalFocus:function(){if(this._shuttleControl){this._shuttleControl.setInitalFocus()}},getPersonalizedFormat:function(){if(this._shuttleControl){return(this._shuttleControl.getFormatedColumns())}return""},getFormatedColumnsAsJSONFormat:function(){if(this._shuttleControl){return(this._shuttleControl.getFormatedColumnsAsJSON())}return""},populateShuttleControl:function(dataSet){buildShuttleControl.call(this,dataSet)},setFormatAttrSelectList:function(formCtrlId){var format=this._shuttleControl.getFormatedColumnsAsJSON();var formatSelectedList=format.formatcolumns.formattedattrs.split(",");var formatMasterList=this._dataSet.format.FormatAttributes;var submitBox=document.getElementById(formCtrlId);submitBox.options.length=formatSelectedList.length;var i=0;for(var j=0;j<formatSelectedList.length;j++){if(formatSelectedList[j]!=""){submitBox.options[i].value=formatSelectedList[j];submitBox.options[i].selected=true;i++}}submitBox.options.length=i}};var init=function(config){var uri=[];uri[uri.length]="PCMServlet?";uri[uri.length]="&ajaxRequest=true";uri[uri.length]="&module="+config.module;uri[uri.length]="&opcode="+config.opcode;uri[uri.length]="&classid="+config.classId;uri[uri.length]="&objid="+config.objid;uri[uri.length]="&wizardId="+config.wizardId;var config={methodType:"GET",contentType:"",postDoc:null};var self=this;requestBus.call(this,uri.join(""),function(result){buildShuttleControl.call(self,result)},config)};var buildShuttleControl=function(result){try{result=(result?eval("("+result+")"):{})}catch(e){}var format={FormatAttrs:result.display.defaultFormatAttrs};var dataSet={format:{FormatAttributes:result.format,FormatCriteria:[format]}};this._dataSet=dataSet;this._shuttleControl=new AGILE.widget.ShuttleControl({id:this._uniqueId,dataSet:dataSet.format.FormatAttributes,isTreeView:this._isTreeView,disableLock:true,availableListTitle:this._availableListTitle,selectedListTitle:this._selectedListTitle,nextTabEl:"filter-palette-apply-button",lastTabEl:"filter-palette-close-button"});this._bindEl.appendChild(this._shuttleControl.getContentEl().content);this._shuttleControl._registerEventListeners();this._shuttleControl.initControls();this._shuttleControl.setControlsHeight("115");if(this._hideLockButton){this._shuttleControl.hideLockButton()}this._shuttleControl.loadDefaultValues(dataSet.format.FormatCriteria)};var requestBus=function(uri,callBack,config){var manager=new AGILE.util.RequestManager(callBack);var methodType=config.methodType;var doc=config.postDoc;var contentType=config.contentType;manager.sendRequest(methodType,uri,doc,contentType)}})();(function(){AGILE.util.SimpleSortPropertiesManager=function(config){this._sortContent=null;this._hasGroupBy=config.hasGroupBy?config.hasGroupBy:false;this._uniqueId=config.id?config.id:"SortProperties";this._bindEl=Dom.get(config.bindEl);if(!config.dataNotLoaded||(config.dataNotLoaded=="true")){init.call(this,config)}};AGILE.util.SimpleSortPropertiesManager.prototype={setControlsHeight:function(height){},setInitalFocus:function(){if(this._sortContent){this._sortContent.setInitalFocus()}},getPersonalizedSort:function(){if(this._sortContent){return(this._sortContent.getPersonalizedSort())}return""},populateSortControl:function(dataSet){buildSortControl.call(this,dataSet)},setSortValues:function(){var sort=this._sortContent.getPersonalizedSortAsJSON();var sortMasterList=this._sortContent._dataSet.SortAttributes;var sortAttrs=[];var sortOrder=[];var sortGroup=[];for(var j=0;j<sort.sortCriteria.length;j++){var hasInSortAttrs=false;for(var k=0;k<sortAttrs.length;k++){if(sort.sortCriteria[j].attribute==sortAttrs[k]){hasInSortAttrs=true;break}}if(hasInSortAttrs){continue}for(var index=0;index<sortMasterList.length;index++){if(sortMasterList[index].attrId==sort.sortCriteria[j].attribute){sortAttrs.push(sort.sortCriteria[j].attribute);sortOrder.push(sort.sortCriteria[j].order);sortGroup.push(sort.sortCriteria[j].group);break}}}var kk=1;for(var i=0;i<sortAttrs.length;i++){Dom.get("ADV_SEARCH_SORTBY_ATTR"+kk).value=sortAttrs[i];Dom.get("ADV_SEARCH_ORDERBY_ATTR"+kk).value=sortOrder[i];Dom.get("ADV_SEARCH_GROUPBY_ATTR"+kk).value=sortGroup[i];kk++}}};var init=function(config){var uri=[];uri[uri.length]="PCMServlet?";uri[uri.length]="&ajaxRequest=true";uri[uri.length]="&module="+config.module;uri[uri.length]="&opcode="+config.opcode;uri[uri.length]="&classid="+config.classId;uri[uri.length]="&objid="+config.objid;uri[uri.length]="&wizardId="+config.wizardId;var config={methodType:"GET",contentType:"",postDoc:null};var self=this;requestBus.call(this,uri.join(""),function(result){buildSortControl.call(self,result)},config)};var buildSortControl=function(result){result=(result?eval("("+result+")"):{});var dataSet={SortAttributes:result.sort,SortCriteria:result.display.sort};this._sortContent=new AGILE.widget.SortContent({key:this._uniqueId,hasGroupBy:this._hasGroupBy,dataSet:dataSet});this._bindEl.appendChild(this._sortContent.getContentEl())};var requestBus=function(uri,callBack,config){var manager=new AGILE.util.RequestManager(callBack);var methodType=config.methodType;var doc=config.postDoc;var contentType=config.contentType;manager.sendRequest(methodType,uri,doc,contentType)}})();function showProcessingIndicator(D,C){var B=[];B[B.length]='<p class="table_loading_indicator" id="p1">';B[B.length]='<img border="0" src='+processingImage+" />";B[B.length]="<br/>"+C+"</p>";var A=new AGILE.util.BasePrompt();A.setTitle(D);A.setContent(B.join(""));A.setActions("");A.showPrompt();return true}function hideProcessingIndicator(){if(AGILE.util.Prompts[0]){AGILE.util.Prompts[0].hidePrompt()}}function enableElement(elemName){var el=document.getElementById(elemName);var classes=el.className;if(classes.indexOf("disabled")>0){classes=classes.replace(/disabled/,"");eval("el.className = classes")}eval("el.disabled = false")}function disableElement(elemName){var el=document.getElementById(elemName);var classes=el.className;if(classes.indexOf("disabled")==-1){classes+=" disabled";eval("el.className = classes")}eval("el.disabled = true")}window.validWinUnload=true;window.loggedOut=false;var Grids;AGILE.util.onKeyDown=function(E){var H=YAHOO.util.Event.getEvent(E);var I=YAHOO.util.Event.getCharCode(H);var B=YAHOO.util.Event.getTarget(H,true);if(I==116||((H.ctrlKey||H.metaKey)&&I==82)){window.validWinUnload=false}copyRowsFromLeftPane(H);if(!Grids||!Grids[0]){return}switch(I){case 46:var G=B.nodeName.toLowerCase();if(G=="input"||G=="textarea"){return}var J=getAvailableGridDivs();var F=getFocussedGridId(J);if(Grids[F]["TableId"]){var D=Dom.get("MSG_Remove_"+Grids[F]["TableId"]);if(D&&Dom.hasClass(D,"disabled")){AGILE.util.DMS.showInfoMessage(localMsg.Table_ReadOnly);return}}var C=document.getElementById("MSG_Remove_"+Grids[F]["TableId"]);if(C){isDeleteActionInvoked=true;var A=C.onclick;if(A){A()}}YAHOO.util.Event.stopEvent(H);break;case 73:if(H.ctrlKey){var J=getAvailableGridDivs();var F=getFocussedGridId(J);var C=document.getElementById("MSG_Add_"+Grids[F]["TableId"]);if(C){var A=C.onclick;if(A){A()}}YAHOO.util.Event.stopEvent(H)}break;case 83:if(H.ctrlKey){YAHOO.util.Event.stopEvent(H)}break;default:}};function copyRowsFromLeftPane(E){var G=YAHOO.util.Event.getEvent(E);var H=YAHOO.util.Event.getCharCode(G);if(currTree!=null&&H==67&&(G.ctrlKey||G.metaKey)){var A=currTree.getSelectedNodeList();var B=[];B[B.length]="<Rows>";for(var D=0;D<A.length;D++){B[B.length]="<Row";B[B.length]=' objectId="'+A[D].nodeObj.data.objectId+'"';B[B.length]=' classId="'+A[D].nodeObj.data.classId+'"';B[B.length]=" />"}B[B.length]="</Rows>";var I=B.join("");var C=[];var F=getForm("MainForm");C[C.length]="ajaxRequest=true&module="+F.module.value;C[C.length]="&opcode=copyRowsFromLeftPane";C[C.length]="&classid="+F.classid.value;C[C.length]="&subclsid="+F.subclsid.value;C[C.length]="&objid="+F.objid.value;C[C.length]="&copiedNodes="+escape(I);sendAJAXRequest(C.join(""),"",false,this,{},true)}}AGILE.util.docMouseup=function(E){var D=Dom.get("recentlyVisitedTree");var F=Dom.get("bookmarkTree");var C=Dom.get("ctxNavTree");var A=YAHOO.util.Event.getEvent(E);var B=YAHOO.util.Event.getTarget(A,true);if(Dom.isAncestor(D,B)){currTree=YAHOO.widget.TreeView.getTree(D.id)}else{if(Dom.isAncestor(F,B)){currTree=YAHOO.widget.TreeView.getTree(F.id)}else{if(Dom.isAncestor(C,B)){currTree=YAHOO.widget.TreeView.getTree(C.id)}else{if(currTree){currTree.putFocusOnTree()}}}}};AGILE.util.docMousedown=function(E){var D=Dom.get("recentlyVisitedTree");var F=Dom.get("bookmarkTree");var C=Dom.get("ctxNavTree");var A=YAHOO.util.Event.getEvent(E);var B=YAHOO.util.Event.getTarget(A,true);if(Dom.isAncestor(D,B)){YAHOO.widget.TreeView.getTree(F.id).unSelectAll();if(YAHOO.widget.TreeView.getTree(C.id)){YAHOO.widget.TreeView.getTree(C.id).unSelectAll()}}else{if(Dom.isAncestor(F,B)){YAHOO.widget.TreeView.getTree(D.id).unSelectAll();if(YAHOO.widget.TreeView.getTree(C.id)){YAHOO.widget.TreeView.getTree(C.id).unSelectAll()}}else{if(Dom.isAncestor(C,B)){YAHOO.widget.TreeView.getTree(F.id).unSelectAll();YAHOO.widget.TreeView.getTree(D.id).unSelectAll()}else{if(B.id=="folderBody"||B.id=="ctxNavBody"){return}currTree=null;YAHOO.widget.TreeView.getTree(F.id).unSelectAll();YAHOO.widget.TreeView.getTree(D.id).unSelectAll();if(YAHOO.widget.TreeView.getTree(C.id)){YAHOO.widget.TreeView.getTree(C.id).unSelectAll()}}}}};AGILE.util.isValidWindowUnload=function(){return window.validWinUnload};AGILE.WindowManager.childWindows=[];AGILE.SessionManager=function(A){this._PLMTimeout=A.PLMTimeout*60*1000;this._WebAppTimeout=A.WebAppTimeout*60*1000;this._disablePrompt=A.disablePrompt;this.initialize()};AGILE.SessionManager.prototype={_callbacks:[],_notifyPriorToTimeout:60*1000,_timeLeftToNotify:0,_childWindows:[],_log:function(A){},_hidePrompt:function(){if(AGILE.util.Prompts[0]){var A=AGILE.util.Prompts[0].getPromptId();if(A!=null&&(A=="NotifyPrompt"||A=="LogoutPrompt")){AGILE.util.Prompts[0].hidePrompt()}}},addChildWindow:function(A){this._childWindows[this._childWindows.length]=A},removeChildWindow:function(B){if(typeof(this._childWindows)!="undefined"&&typeof(B)!="undefined"){for(var A=0;A<this._childWindows.length;A++){if(this._childWindows[A]===B){this._childWindows[A]=null;break}}}},initialize:function(){this._log("initializing");this._clearTimeouts();this._timeLeftToNotify=this._PLMTimeout-this._notifyPriorToTimeout;this.initializeTimers()},initializeTimers:function(){if(this._timeLeftToNotify>this._WebAppTimeout){this._callbacks[1]=setTimeout("SessionManager.keepAlive()",this._WebAppTimeout-this._notifyPriorToTimeout)}else{if(this._timeLeftToNotify==this._WebAppTimeout){this._callbacks[1]=setTimeout("SessionManager.keepAlive()",this._WebAppTimeout-this._notifyPriorToTimeout);this._callbacks[0]=setTimeout("SessionManager.notify()",this._timeLeftToNotify)}else{this._log("registering notify timeout..");this._callbacks[0]=setTimeout("SessionManager.notify()",this._timeLeftToNotify)}}},reset:function(){this._log("reset");this.initialize();this._hidePrompt()},_clearTimeouts:function(){for(var A=0;A<this._callbacks.length;A++){if(this._callbacks[A]){clearTimeout(this._callbacks[A])}}},_showNotifyPrompt:function(C){this._log("idleTime = "+C.thisConn.getResponseHeader("idleTime"));var B=C.thisConn.getResponseHeader("idleTime");B=(B==-1)?B:B*60*1000;if(B==-1||B>=(this._PLMTimeout-this._notifyPriorToTimeout)){var A=new AGILE.util.BasePrompt();A.setPromptId("NotifyPrompt");A.setTitle(localMsg.Session_Timeout_Alert);A.setContent("<br/> <p class='promptContent'> "+localMsg.Session_Timeout_Message+"</p><br/>");var E=[];E[E.length]="<a href='#' id='prompt_save' onblur='buttonBlur(this.id)' onfocus='buttonFocus(this.id)' class='button'> <span id='prompt_savespan' class='nodrag'><em class='save_dialog nodrag'>&nbsp;</em>"+localMsg.ok+"</span> </a>";E[E.length]="<a id='prompt_close' class='button' onclick='javascript:AGILE.util.Prompts[0].hidePrompt();' onblur='buttonBlur(this.id)' onfocus='buttonFocus(this.id)' id='close' href='#'><span class='' id='prompt_closespan'><em class='cancel'>&nbsp;</em>"+localMsg.Close+"</span></a>";A.setActions(E.join(""));A.setInitialFocusId("prompt_save");A.showPrompt();YAHOO.util.Event.addListener(document.getElementById("prompt_save"),"click",SessionManager.renew);this._callbacks[2]=setTimeout("SessionManager.timedOut()",(this._notifyPriorToTimeout-(10*1000)))}else{var D=this._PLMTimeout-B-this._notifyPriorToTimeout;setTimeout("SessionManager.notify()",D)}},renew:function(){var A="ajaxRequest=true&module=ObjectViewHandler&opcode=keepAlive";sendAJAXRequest(A,null,false,null,{});if(AGILE.util.Prompts[0]){AGILE.util.Prompts[0].hidePrompt()}},isBackgroundTaskRunning:function(){for(var A=0;A<this._childWindows.length;A++){var B=this._childWindows[A];if(B&&!B.closed){return true}}return false},notify:function(){if(this.isBackgroundTaskRunning()){this.keepAlive();return}if(AGILE.util.fileUploadManager.hasActiveFilesbeingUploaded()>0){this.keepAlive();out("there is some files still being uploaded");return}if(hasActiveFileReplicationOrBeingZipped()){this.keepAlive();out("there is some files still being replicated or zipped in File server");return}if(!this._disablePrompt){var A="ajaxRequest=true&module=ObjectViewHandler&opcode=getSessionIdleTime";sendSyncRequest(A,this._showNotifyPrompt,false,this,{},"PCMServlet")}},_showLogoutPrompt:function(){window.loggedOut=true;var A=new AGILE.util.BasePrompt();A.setPromptId("LogoutPrompt");A.setTitle(localMsg.Session_Timed_Out);A.setContent("<br/><p class='promptContent'> "+localMsg.Session_Timed_Out_Message+"</p><br/>");var B="<a href='#' id='prompt_save' onblur='buttonBlur(this.id)' onfocus='buttonFocus(this.id)' class='button'> <span id='prompt_savespan' class='nodrag'><em class='save_dialog nodrag'>&nbsp;</em>"+localMsg.ok+"</span> </a>";A.setActions(B);A.setInitialFocusId("prompt_save");A.showPrompt();YAHOO.util.Event.addListener(document.getElementById("prompt_save"),"click",SessionManager.showLoginPage)},timedOut:function(){this.invalidate();if(!this._disablePrompt){AGILE.WindowManager.closeChildWindows();this._showLogoutPrompt()}},showLoginPage:function(){AGILE.util.Prompts[0].hidePrompt();window.loggedOut=true;var frmName="";for(var i=0;i<document.forms.length;i++){if((document.forms[i].name.indexOf("MainForm")!=-1)||(document.forms[i].name.indexOf("Search")!=-1)){frmName=document.forms[i].name;break}}submitForm(frmName,eval("document."+frmName+".module").value,eval("document."+frmName+".opcode").value,"_self")},keepAlive:function(){var A="ajaxRequest=true&module=ObjectViewHandler&opcode=keepAlive";sendSyncRequest(A,null,false,null,{},"PCMServlet");if(this._timeLeftToNotify>this._WebAppTimeout){this._timeLeftToNotify=this._timeLeftToNotify-this._WebAppTimeout+this._notifyPriorToTimeout}this.initializeTimers();this._log("keep Alive..")},invalidate:function(){if(!this._disablePrompt){this._log("invalidating session..");if(window.loggedOut){return}}this._clearTimeouts();var A="ajaxRequest=true&module=LoginHandler&opcode=logout";sendSyncRequest(A,null,false,null,{},"PCMServlet")}};AGILE.WindowManager.dereference=function(A){var B=AGILE.WindowManager.childWindows[A];AGILE.WindowManager.childWindows[A]=null};AGILE.WindowManager.closeChildWindows=function(){var B=AGILE.WindowManager.getChildWindows();for(var A=0;A<B.length;A++){B[A].AGILE.WindowManager.closeChildWindows();B[A].close()}};AGILE.WindowManager.getChildWindows=function(){var A=[];for(var B=0;B<AGILE.WindowManager.childWindows.length;B++){var C=AGILE.WindowManager.childWindows[B];if(C&&!C.closed){A[A.length]=C}}return A};AGILE.util.preServerRequest=function(){if(window.name=="MainWindow"){out("Session Timeout Initialized");SessionManager.reset()}else{if(window.opener&&window.opener.AGILE){window.opener.AGILE.util.preServerRequest()}}};AGILE.util.addBackgroundTaskWindow=function(A){if(window.name=="MainWindow"){SessionManager.addChildWindow(A)}else{if(window.opener&&window.opener.AGILE){window.opener.AGILE.util.addBackgroundTaskWindow(A)}}};AGILE.util.removeBackgroundTaskWindow=function(A){if(window.name=="MainWindow"){SessionManager.removeChildWindow(A)}else{if(window.opener&&window.opener.AGILE){window.opener.AGILE.util.removeBackgroundTaskWindow(A)}}};function enableElement(elemName){var el=document.getElementById(elemName);var classes=el.className;if(classes.indexOf("disabled")>0){classes=classes.replace(/disabled/,"");eval("el.className = classes")}eval("el.disabled = false")}function disableElement(elemName){var el=document.getElementById(elemName);var classes=el.className;if(classes.indexOf("disabled")==-1){classes+=" disabled";eval("el.className = classes")}eval("el.disabled = true")}AGILE.util.PrintReport=function(){A();function A(){var D=[];var C=new AGILE.util.BasePrompt();C.setTitle(localMsg.OptionalPrintHeader);D[D.length]="<dl class='side_by_side_mixed prompt_options report_print_header'>";D[D.length]="<dt>"+localMsg.HeaderText+":</dt>";D[D.length]="<dd>";D[D.length]="<input id='printHeader' class='long_width' type='text' name='printHeader' value='' >";D[D.length]="</dd></dl>";C.setContent(D.join(""));var E=[];E[E.length]="<a href='#' id='prompt_print' onblur='buttonBlur(this.id)' onfocus='buttonFocus(this.id)' class='button'> <span id='prompt_printspan' class='nodrag'><em class='save_dialog nodrag'>&nbsp;</em>"+localMsg.print+"</span> </a>";E[E.length]="<a id='prompt_close' class='button' onclick='javascript:AGILE.util.Prompts[0].hidePrompt();' onblur='buttonBlur(this.id)' onfocus='buttonFocus(this.id)' id='close' href='#'><span class='nodrag' id='prompt_closespan'><em class='cancel nodrag'>&nbsp;</em>"+localMsg.cancel+"</span></a>";C.setActions(E.join(""));C.setInitialFocusId("prompt_print");C.showPrompt();YAHOO.util.Event.addListener(document.getElementById("prompt_print"),"click",B);return true}function B(){var C=document.getElementById("printHeader").value;parent.controlPane.printReport(C);javascript:AGILE.util.Prompts[0].hidePrompt()}};AGILE.util.ExportReport=function(){B();function B(){var E=[];var D=new AGILE.util.BasePrompt();D.setTitle(localMsg.Select_ReportExport_Format);E[E.length]="<dl class='side_by_side_mixed selector_list prompt_options'>";E[E.length]="<dt></dt>";E[E.length]="<dd>";E[E.length]="<input id='reportExportType_1' class='form_selectors' type='radio' name='reportExportType' value='0' checked='checked'>";E[E.length]="<label for='reportExportType_1'>"+localMsg.Export_File_Type_CSV+"</label>";E[E.length]="</dd>";E[E.length]="<dt></dt>";E[E.length]="<dd>";E[E.length]="<input id='reportExportType_2' class='form_selectors' type='radio' name='reportExportType' value='3' >";E[E.length]="<label for='reportExportType_2'>"+localMsg.Export_File_Type_XLS+"</label>";E[E.length]="</dd>";E[E.length]="<dt></dt>";E[E.length]="<dd>";E[E.length]="<input id='reportExportType_4' class='form_selectors' type='radio' name='reportExportType' value='1' >";E[E.length]="<label for='reportExportType_4'>"+localMsg.Export_File_Type_HTML+"</label>";E[E.length]="</dd></dl>";D.setContent(E.join(""));var F=[];F[F.length]="<a href='#' id='prompt_ok' onblur='buttonBlur(this.id)' onfocus='buttonFocus(this.id)' class='button'> <span id='prompt_okspan' class='nodrag'><em class='save_dialog nodrag'>&nbsp;</em>"+localMsg.ok+"</span> </a>";F[F.length]="<a id='prompt_close' class='button' onclick='javascript:AGILE.util.Prompts[0].hidePrompt();' onblur='buttonBlur(this.id)' onfocus='buttonFocus(this.id)' id='close' href='#'><span class='nodrag' id='prompt_closespan'><em class='cancel nodrag'>&nbsp;</em>"+localMsg.Close+"</span></a>";D.setActions(F.join(""));D.setInitialFocusId("prompt_ok");D.showPrompt();YAHOO.util.Event.addListener(document.getElementById("prompt_ok"),"click",C);return true}function C(){var D=document.getElementsByName("reportExportType");var F=0;for(var E=0;E<D.length;E++){if(D[E].checked){F=D[E].value}}parent.controlPane.exportData(F);javascript:AGILE.util.Prompts[0].hidePrompt()}function A(D){parent.contentPane.document.forms[0].reportExportType[D].click()}};AGILE.grid.exportTable=function(B){var A="&GRID_CTX_NAME="+B.gridID;openDialogWindow("","ExportTableHandler","exportTableData","popupWindow",300,300,"true","no",A)};AGILE.util.ResizeBrowserManager={callback:{fn:function(){},scope:this},resizeTimeout:undefined,resizeInProgress:false,register:function(A,B){this.callback=B;YAHOO.util.Event.addListener(A,"resize",function(){AGILE.util.ResizeBrowserManager.resize()})},resize:function(){var A=is_ie;if(A&&this.resizeInProgress==false){if(this.resizeTimeout!=undefined){clearTimeout(AGILE.util.ResizeBrowserManager.resizeTimeout)}this.resizeTimeout=setTimeout("AGILE.util.ResizeBrowserManager.resetSize();",500)}else{if(!A){this.resetSize()}else{}}},complete:function(){clearTimeout(this.resizeTimeout);this.resizeInProgress=false;this.callback.fn.call(this.callback.scope)},resetSize:function(){var A=is_ie;if(A){clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout("AGILE.util.ResizeBrowserManager.complete();",1000);this.resizeInProgress=true}else{this.complete()}},removeEvent:function(A){YAHOO.util.Event.removeListener(A,"resize",AGILE.util.ResizeBrowserManager.resize)}};AGILE.util.Export=function(B){var A=get2ndForm("MainForm");submitForm(A.name,A.module,B.opcode,"AttachmentFrame",B.xtraArgs)};AGILE.util.ExportSearch=function(B){var A=get2ndForm(SearchFormName);submitForm(A.name,A.module,B.opcode,"AttachmentFrame",B.xtraArgs)};function showOnlineHelp(A){openModalDialog(A+document.MainForm.helpID.value,620,580,"Help","yes")}AGILE.util.clearTextSelection=function(){try{if(document.selection){document.selection.empty()}else{window.getSelection().collapseToStart()}}catch(A){}};AGILE.util.toXML=function(B){var A=null;if(window.DOMParser){A=new DOMParser().parseFromString(B,"text/xml")}else{if(window.ActiveXObject){A=new ActiveXObject("Microsoft.XMLDOM");A.async="false";A.loadXML(B)}}if(A==null){return null}return A};AGILE.util.stringifyXML=function(B){if(!B){return null}var A=B.xml;if(typeof A==="string"){return A}if(window.XMLSerializer){return new XMLSerializer().serializeToString(B)}return""+B};globalProgressIndicatorOn=function(){jQuery("#progress_indicator_global").css("visibility","visible")};globalProgressIndicatorOff=function(){var A=false;for(var B in AGILE.object.RequestManager.processingRequests){if(AGILE.object.RequestManager.processingRequests.hasOwnProperty(B)){var C=AGILE.object.RequestManager.processingRequests[B];if(C!=null&&C.readyState!=4){A=true}}}if(!A){jQuery("#progress_indicator_global").css("visibility","hidden")}};function escapeHTMLChars(D){var B=new Array(D.length);for(var C=0;C<D.length;C++){var E=D.charCodeAt(C);if(E==38||E==60||E==62||E==39||E==34){B[C]="&#"+E+";"}else{B[C]=D.charAt(C)}}return B.join("")}String.format=function(B){if(arguments.length==0){return null}var A=Array.prototype.slice.call(arguments,1);return B.replace(/\{(\d+)\}/g,function(C,D){return A[D]})};function descapeDelimiters(A){if(A==null||A.length<=0){return A}var C=0;var E=0;var F="";if(A.indexOf("%u00")>-1){while((C=A.indexOf("%u",E))!=-1){var B=A.substring(C+2,C+6);var D=parseInt(B,16);if(isNaN(D)==false){D=String.fromCharCode(D);if(C>0){F+=A.substring(E,C)}F+=D;E=C+6}else{if(C>0){F+=A.substring(E,C)}F+="%u";E=C+2}}}if(E<A.length){F+=A.substring(E,A.length)}return F}function escapeDelimiters(D){if(D==null||D==""){return D}var B=0;var C;var A="";for(B=0;B<D.length;B++){C=D.charAt(B);if(C=="&"){A+="%u0026"}else{if(C=="="){A+="%u003D"}else{A+=C}}}return A}function log(B){for(var A in B){if(B.hasOwnProperty(A)){out(A+"		"+B[A])}}}function out(C){var B=readCookie("jsDebug");if(B=="1"){try{if(is_ie||is_mac){debug(C)}else{console.log(C)}}catch(A){}}}function launchRMWInSameWindow(D){if(isMainPageDirty()){return}var E,C,A;if(document.MainForm.objectname!=undefined){E=document.MainForm.objectname.value}if(document.MainForm.classid!=undefined){C=document.MainForm.classid.value}if(document.MainForm.objid!=undefined){A=document.MainForm.objid.value}var B="";if(E!=undefined&&E.length>0&&C!=undefined&&C.length>0){B="?dir=atop&obj_nm="+E+"&class_id="+C+"&objId="+A+"&opcode=vw_obj"}else{B="?dir=atop&opcode=login"}window.location.href=D+B}var externalAppWindow=null;function displayExternalObject(A){if(A){if(A.app&&A.app=="rmw"){displayRMWObject(A)}else{if(A.appURL){var B=A.appURL;if(A.queryString){if(B.indexOf("?")==-1){B=B+"?"+A.queryString}else{if(A.queryString.charAt(0)=="&"){B=B+A.queryString}else{B=B+"&"+A.queryString}}}externalAppWindow=window.open(B,"ExternalAppWindow","directories=no,location=no,menubar=no,resizable=yes,status=yes,titlebar=yes,toolbar=no",false);externalAppWindow.focus()}}}}function displayRMWObject(A){if(A){if(A.objectid){displayRMWObjectById(A.objectid)}else{if(A.catTablename&&A.objectname){displayRMWObjectByName(A.catTablename,A.objectname)}}}}function displayRMWObjectById(A){var B=[];B.push("rmwObjectId="+A);launchRMW("default/Pharma.jsp",B)}function displayRMWObjectByName(B,A){var C=[];C.push("rmwCatTableName="+B);C.push("rmwObjectName="+A);launchRMW("default/Pharma.jsp",C)}var rmwWindow=null;function launchRMW(A){if(opener&&!opener.closed&&opener.name!="LoginWindow"){opener.window.focus();return}else{if(rmwWindow&&!rmwWindow.closed){rmwWindow.focus();return}else{rmwWindow=window.open(A,"RMWWindow","directories=no,location=no,menubar=no,resizable=yes,status=yes,titlebar=yes,toolbar=no",false);rmwWindow.focus()}}}function launchRMW(C,D){if(isMainPageDirty()){return}var A=null;if(window.parent&&window.parent.opener){A=window.parent.opener}else{A=opener}var B="";if(D&&D.length>0){B="?opcode=vw_obj&"+D.join("&")}else{if(A&&!A.closed&&A.name!="LoginWindow"){A.window.focus();return}else{if(rmwWindow&&!rmwWindow.closed){rmwWindow.focus();return}}}C=C+B;rmwWindow=window.open(C,"RMWWindow","directories=no,location=no,menubar=no,resizable=yes,status=yes,titlebar=yes,toolbar=no",false);rmwWindow.focus()}function closeRMWWindow(){var A=null;if(window.parent&&window.parent.opener){A=window.parent.opener}else{A=opener}if(A&&!A.closed&&A.name!="LoginWindow"){A.window.close();return}else{if(rmwWindow&&!rmwWindow.closed){rmwWindow.close();return}}}var _userFileRepZipCount=0;var _userPreferIFSDomain;function setUserPreferIFSDomain(A){_userPreferIFSDomain=A}function replicate_zipFileStart(){out("replicate or zip file started");_userFileRepZipCount=_userFileRepZipCount+1}function replicate_zipFileDone(){out("replicate or zip file done");_userFileRepZipCount=_userFileRepZipCount-1;if(_userFileRepZipCount<0){_userFileRepZipCount=0}}function replicate_zipFileFailed(){out("replicate or zip file failed");_userFileRepZipCount=_userFileRepZipCount-1;if(_userFileRepZipCount<0){_userFileRepZipCount=0}}function hasActiveFileReplicationOrBeingZipped(){if(_userFileRepZipCount>0){out("Has file being replicated or zipped");return true}else{out("Has no file being replicated or zipped");return false}}function listenerForFileServerMessage(A){if(A.origin!==_userPreferIFSDomain){out("receive invalide message from "+A.origin);return}out("received message from File Server: "+A.data);var B=A.data;if(B.indexOf("FileReplicationZipStarted")==0){replicate_zipFileStart()}else{if(B.indexOf("FileReplicationZipDone")==0){replicate_zipFileDone()}else{if(B.indexOf("FileReplicationZipFailed")==0){replicate_zipFileFailed()}}}}var browser=navigator.appName;var browserVer=parseInt(navigator.appVersion);var warnToSave=true;var setCursorToHourglass=true;if((browser=="Netscape"&&browserVer>=3)||(browser=="Microsoft Internet Explorer"&&browserVer>=4)){browserDoesImages=true;browserCanFocus=true}else{browserDoesImages=false;browserCanFocus=false}function appendContextPath(C){var A=C;var B=C;return B}var intDebugMessageCount=0;function debug(A){var B="height=400,width=400,top=220,left=200,resizable,scrollbars";if(!parent.objDebugWin||parent.objDebugWin.closed){parent.objDebugWin=window.open("","",B);parent.objDebugWin.document.write("<html><head><title>Debug Message Window</title></head>");intDebugMessageCount=0}if(intDebugMessageCount==0){parent.objDebugWin.document.write("<body><b> ----------- Debug Messages from "+window.name+"</b> ----------- <p>")}intDebugMessageCount++;parent.objDebugWin.document.write(intDebugMessageCount+": "+A+"<hr>");parent.objDebugWin.scroll(0,999999999)}function getUniquePopupWindowName(){return("PopUP_"+(new Date()).getTime().toString())}function getFormFromFrame(formName,frameName){if(formName==null||formName.length==0){return eval("top.frames."+frameName+".document.forms[0]")}return eval("top.frames."+frameName+".document."+formName)}var linkHasBeenClicked=false;function formJustChanged(formName){eval("document.formName.formChanged").value=1}function formHasChanged(A){var B=getForm(A);if(B.formChanged.value==1){return true}else{return false}}function getForm(formName){if(formName==null||formName.length==0){for(i=0;i<document.forms.length;i++){if(document.forms[i].name!="spiffyCal"){return document.forms[i]}}}return eval("document."+formName)}function get2ndForm(formName){var form1=getForm(formName);var formName2=form1.name+"_2__";return eval("document."+formName2)}function getFormFromFrame(formName,frameName){if(formName==null||formName.length==0){frms=eval("top.frames."+frameName+".document.forms");for(i=0;i<frms.length;i++){if(frms[i].name!="spiffyCal"){return frms[i]}}}return eval("top.frames."+frameName+".document."+formName)}function openSmallWin(A,C,B){A=A+getFormElementValues(B,A);A+="&popup=true";openModalDialog(A,"500","400",C)}function openTinyWin(A,C,B){A=A+getFormElementValues(B,A);A+="&popup=true";openModalDialog(A,"350","250",C)}function openMedWin(A,D,B,C){if(C==null){C=0}A=A+getFormElementValues(B,A);A+="&popup=true";openModalDialog(A,"900","600",D,C)}function openLargeWin(A,C,B){A=A+getFormElementValues(B,A);A+="&popup=true";openModalDialog(A,"900","750",C)}function openXSizeWin(B,F,C,D,A,E){if(E==null){E=0}B=B+getFormElementValues(C,B);B+="&popup=true";openModalDialog(B,D,A,F,E)}function getFormElementValues(C,B){var D=getForm(C);var A="";if(B!=null&&B.indexOf("?")==-1){A=A+"?"}else{A+="&"}A+="classid=";A+=D.classid.value;A+="&objid=";A+=D.objid.value;var E=D.subclsid;if(E!=null){A+="&subclsid=";A+=D.subclsid.value}return A}function openWin(A,B){openModalDialog(A,"900","750",B,"true")}function appendParentObjectId(locationUrl){var formName=getForm("").name;var objectIdObj=eval("document."+formName+".objectId");var classIdObj=eval("document."+formName+".classId");var parentObjectId=0;var parentClassId=0;if(objectIdObj){parentObjectId=objectIdObj.value}if(classIdObj){parentClassId=classIdObj.value}locationUrl=locationUrl+"&parentObjectId="+parentObjectId;locationUrl=locationUrl+"&parentClassId="+parentClassId;return locationUrl}function openDialogWindowFrom2ndForm(J,C,E,G,K,A,B,F,I){var H=get2ndForm(J);var D=H.name;openDialogWindow(D,C,E,G,K,A,"true",F,I)}var popupActionInvoked=false;function openDialogWindow(H,C,D,F,I,A,B,E,G){if(F=="_New"){F="popUpWindow"+Math.round(Math.random()*100)}if(E==null||E==""){E="yes"}if(D!="viewHistoricalReport"){openModalDialog("",A,I,F,E)}fName=H;mod=C;op=D;wName=F;isPop=B;xArgs=G;doSubmitFormLater(fName,mod,op,wName,isPop,xArgs)}function openDialogWindowWithTimeout(H,C,D,F,I,A,B,E,G){if(F=="_New"){F="popUpWindow"+Math.round(Math.random()*100)}if(E==null||E==""){E="yes"}openModalDialog("",A,I,F,E);fName=H;mod=C;op=D;wName=F;isPop=B;xArgs=G;setTimeout("doSubmitFormLater(fName, mod, op, wName, isPop, xArgs)",500)}function doSubmitFormLater(K,B,F,G,A,J){var I=getForm(K);var C=I.module.value;var E=I.opcode.value;var D=I.popup.value;var H=I.addlParam.value;I.popup.value=A;submitForm(K,B,F,G,J);I.module.value=C;I.opcode.value=E;I.popup.value=D;I.addlParam.value=H;I.target=window.name}function submitFormNoWarn(C,B,G,F,A,D,E){warnToSave=false;submitForm(C,B,G,F,A,D,E)}function submitForm(C,B,F,E,A){var D=getForm(C);if(C==null||C.length<=0){C=D.name}writeTableInfo(C,F);if(B!=null&&B.length>0){D.module.value=B}else{D.module.value=D.module.defaultValue}if(F!=null&&F.length>0){D.opcode.value=F}else{D.opcode.value=D.opcode.defaultValue}if(E!=null&&E.length>0){D.target=E}if(E=="RightPane"){if(D.popup!=null){D.popup.value="false"}}if(D.addlParam!=null){if(A!=null&&A.length>0){D.addlParam.value=A}else{D.addlParam.value=D.addlParam.defaultValue}}setTokenRequired(D);if(window.name=="RightPane"&&setCursorToHourglass){document.body.style.cursor="wait"}D.submit()}function autoSelectSingleRow(A,B,C){}function writeTableInfo(B,F){var E=getForm(B);if(E.registeredTables!=null){var C=E.registeredTables.value;if(C!=null&&C.length>0){var D=C.split(",");var A=0;for(A=0;A<D.length;A++){if(shouldPersistSelections(B,D[A])){autoSelectSingleRow(B,D[A],F);setTableInfo(B,D[A])}setGridSelectionsInfo(B,D[A])}}}}function setGridSelectionsInfo(A,B){}function shouldPersistSelections(formName,tableId){var result="false";if(eval("document."+formName+".persistSelections_"+tableId)){result=eval("document."+formName+".persistSelections_"+tableId).value}return(result=="true")}function setTokenRequired(frm){if(frm.target!=null&&frm.target.length>0){if(frm.target=="RightPane"){var isTokenRequired=eval(frm.isTokenRequired);if(isTokenRequired!=null){isTokenRequired.value="true"}}}}function resetTokenRequired(frm){var isTokenRequired=eval(frm.isTokenRequired);if(isTokenRequired!=null){isTokenRequired.value="false"}}function confirmBeforeSubmitForm(C,B,E,D,A,F){if(F==null){F="Are you sure you want to continue ?"}if(confirm(F)){submitForm(C,B,E,D,A)}return}function IsFormDirty(E){var H=E.elements.length;for(var D=0;D<H;D++){var C=E.elements[D];if("text"==C.type||"TEXTAREA"==C.tagName){if(C.value!=C.defaultValue){return true}}else{if("checkbox"==C.type||"radio"==C.type){if(C.checked!=C.defaultChecked){return true}}else{if("SELECT"==C.tagName){var B=C.options;var G=B.length;for(var A=0;A<G;A++){var F=B[A];if(F.selected!=F.defaultSelected){return true}}}}}}return false}var Nav=((navigator.appName=="Netscape"));var dialogWin=new Object();function openModalDialog(C,E,O,J,G,D,B,F,A,L,N,K){if(popupActionInvoked){return}popupActionInvoked=true;dialogWin=new Object();dialogWin.returnedValue="";dialogWin.url=C;dialogWin.width=E;dialogWin.height=O;var I=false;if(typeof(B)!="undefined"&&B!=null){I=B}if(G==null||!G){dialogWin.scrollbars=0}else{if(G=="true"){dialogWin.scrollbars="yes"}else{dialogWin.scrollbars=G}}if(D==null||D){dialogWin.resizable="yes"}else{if(!D||D=="false"){dialogWin.resizable="no"}else{dialogWin.resizable=D}}if(F==null||!F){dialogWin.status="no"}else{if(F=="true"){dialogWin.status="yes"}else{dialogWin.status=F}}if(N==null||!N){dialogWin.toolbar="no"}else{if(N=="true"){dialogWin.toolbar="yes"}else{dialogWin.toolbar=N}}if(K==null||!K){dialogWin.menubar="no"}else{if(K=="true"){dialogWin.menubar="yes"}else{dialogWin.menubar=K}}dialogWin.name=J;if(J==""||!J){dialogWin.name=(new Date()).getSeconds().toString()}if(Nav){dialogWin.left=window.screenX+((window.outerWidth-dialogWin.width)/2);dialogWin.top=window.screenY+((window.outerHeight-dialogWin.height)/2);var H="screenX="+dialogWin.left+",screenY="+dialogWin.top;H+=",width="+dialogWin.width+",height="+dialogWin.height+",resizable="+dialogWin.resizable+",scrollbars="+dialogWin.scrollbars+",status="+dialogWin.status+",toolbar="+dialogWin.toolbar+",menubar="+dialogWin.menubar}else{dialogWin.left=(screen.width-dialogWin.width)/2;dialogWin.top=(screen.height-dialogWin.height)/2;var H="left="+dialogWin.left+",top="+dialogWin.top;H+=",width="+dialogWin.width+",height="+dialogWin.height+",resizable="+dialogWin.resizable+",scrollbars="+dialogWin.scrollbars+",status="+dialogWin.status+",toolbar="+dialogWin.toolbar+",menubar="+dialogWin.menubar}if(dialogWin.url==null||dialogWin.url==""){var M=getForm("");var P="";if(M){if(M.objid&&M.classid&&M.tabid){P="?objid="+M.objid.value+"&classid="+M.classid.value+"&tabid="+M.tabid.value}}}dialogWin.win=window.open(dialogWin.url,dialogWin.name,H);if((!C||C==null||C.length==0)&&(L==null||typeof(B)=="undefined")){setPopupLoadingMessage()}AGILE.WindowManager.childWindows[dialogWin.name]=dialogWin.win;AGILE.WindowManager.childWindows[AGILE.WindowManager.childWindows.length]=dialogWin.win;if((A!=null)&&(A=="yes")){AGILE.util.addBackgroundTaskWindow(dialogWin.win)}if(typeof is_sun=="undefined"){is_sun=(navigator.userAgent.toLowerCase().indexOf("sunos")!=-1)}if(is_sun&&dialogWin.win&&!I){dialogWin.win.resizeTo(dialogWin.width,dialogWin.height);dialogWin.win.moveTo(dialogWin.left,dialogWin.top)}dialogWin.win.focus();popupActionInvoked=false;AGILE.util.preServerRequest()}function setPopupLoadingMessage(){try{var A="<div style='float: left; width: auto; margin: 30% 0% 0% 40%; valign: middle; text-align: center;'>";A+="<span style='font-family: Arial; color: #333; font-size: 16px; float: left; width: auto;'>&nbsp;"+localMsg.Popup_Loading+"&hellip;</span></div>";dialogWin.win.document.body.innerHTML=A}catch(B){}}var doRightPaneOnUnloadActions;function closeDialog(){if(dialogWin.win&&!dialogWin.win.closed){if(typeof(dialogWin.win.document)!="undefined"&&dialogWin.win.document!=null&&typeof(dialogWin.win.document.body)!="undefined"&&dialogWin.win.document.body!=null){dialogWin.win.document.body.onUnload=""}dialogWin.win.close();dialogWin.win=null}if(doRightPaneOnUnloadActions!=null){doRightPaneOnUnloadActions()}}function deadend(){if(dialogWin.win&&!dialogWin.win.closed){dialogWin.win.focus();return false}}function blockEvents(){var C=(typeof(document.forms[0].externalRun)!="undefined"&&document.forms[0].externalRun!=null&&document.forms[0].externalRun.value=="true");if(C){top.frames.RightPane.document.body.onfocus=top.frames.RightPane.checkModal}else{for(var A=0;A<top.frames.length;A++){try{if(top.frames[A].document.body){if(top.frames.RightPane){top.frames[A].document.body.onfocus=top.frames.RightPane.checkModal}}}catch(B){}}}if(C){top.frames.RightPane.document.body.onunload=closeDialog}else{window.document.body.onunload=closeDialog}if(window.opener){window.document.body.onfocus=checkModal}}function checkModal(){setTimeout("finishChecking()",50);return true}function finishChecking(){if(dialogWin.win&&!dialogWin.win.closed){dialogWin.win.focus();if(typeof(dialogWin.win.dialogWin)!="undefined"){if(dialogWin.win.dialogWin.win&&!dialogWin.win.dialogWin.win.closed){dialogWin.win.dialogWin.win.focus()}}}else{if(dialogWin.win&&dialogWin.win.closed){var B=getForm("");var D=(document.forms[0].externalRun!=null&&document.forms[0].externalRun.value=="true");if(D){top.frames.RightPane.document.body.onfocus=""}else{for(var A=0;A<top.frames.length;A++){try{top.frames[A].document.body.onfocus=""}catch(C){}}}dialogWin.win=null}}}function unblockEvents(){dialogWin.win=null}var width;var height;function showSpan(C,E,D){var B=document.getElementById(E);var A=B.innerHTML;B=document.getElementById(C);B.style.display="none";B=document.getElementById(D);B.title="";if(A){B.innerHTML=B.innerHTML+A}if(is_ie){adjustTabScroller()}}function adjustTabScroller(){if(is_ie){adjustTabsWidth()}}function writeText(B,F,E){var C=F;var D=F.substr(0,E);var I=F.substr(E);var J=F.substr(0,E+6).lastIndexOf("&#039;");var K="";var G="";var H="";var A="";if(C.indexOf("<BR>")!=-1){C=C.replace(/\<BR\>/gi,"\n")}K=C.replace(/&#039;/gi,"'");G=K.replace(/&quot;/gi,'"');H=G.replace(/&lt;/gi,"<");A=H.replace(/&gt;/gi,">");if(A.length>E){D=A.substr(0,E);I=A.substr(E);D=D.replace(/'/gi,"&#039;");I=I.replace(/'/gi,"&#039;");D=D.replace(/\"/gi,"&quot;");I=I.replace(/\"/gi,"&quot;");D=D.replace(/\</gi,"&lt;");I=I.replace(/\</gi,"&lt;");D=D.replace(/\>/gi,"&gt;");I=I.replace(/\>/gi,"&gt;");document.write("<span id='visible"+B+"' title='"+D+"'>"+D+"</span>");document.write("<a href='javascript:showSpan(\"link"+B+'","hidden'+B+'","visible'+B+"\");' id='link"+B+"' class='objLinks' title='"+C+"'>...</a>");document.write("<span id='hidden"+B+"' style='display:none;'>"+I+"</span>")}else{document.write(F)}}var width;var height;var arrSelectWidthAdjust=new Array();var idxSelectWidthAdjust=0;var arrDualSelectWidthAdjust=new Array();var idxDualSelectWidthAdjust=0;function objSelectWidthAdjust(A,B,C){this.selectElem=A;this.minWidth=B;this.maxWidth=C}function adjustSelectElementWidths(){for(var A=0;A<arrSelectWidthAdjust.length;A++){if(arrSelectWidthAdjust[A].selectElem.offsetWidth<arrSelectWidthAdjust[A].minWidth){arrSelectWidthAdjust[A].selectElem.style.width=arrSelectWidthAdjust[A].minWidth}if(arrSelectWidthAdjust[A].selectElem.offsetWidth>arrSelectWidthAdjust[A].maxWidth){arrSelectWidthAdjust[A].selectElem.style.width=arrSelectWidthAdjust[A].maxWidth}}}function registerSelectElement(formName,selectElementName,minWidth,maxWidth){var selectElement=eval("document."+formName+"."+selectElementName);if(selectElement!=null){arrSelectWidthAdjust[idxSelectWidthAdjust++]=new objSelectWidthAdjust(selectElement,minWidth,maxWidth)}}function registerDualSelectElement(formName,FromElementName,ToElementName,minWidth,maxWidth){var fromElement=eval("document."+formName+"."+FromElementName);var toElement=eval("document."+formName+"."+ToElementName);if(FromElementName!=null&&ToElementName!=null){arrDualSelectWidthAdjust[idxDualSelectWidthAdjust++]=new objDualSelectWidthAdjust(fromElement,toElement,minWidth,maxWidth)}}function objDualSelectWidthAdjust(D,A,B,C){this.fromSelectElem=D;this.toSelectElem=A;this.minWidth=B;this.maxWidth=C}function adjustDualSelectElementWidths(){var C="";var A="";var D="200";for(var B=0;B<arrDualSelectWidthAdjust.length;B++){if((arrDualSelectWidthAdjust[B].fromSelectElem.offsetWidth<arrDualSelectWidthAdjust[B].minWidth)&&(arrDualSelectWidthAdjust[B].toSelectElem.offsetWidth<arrDualSelectWidthAdjust[B].minWidth)){arrDualSelectWidthAdjust[B].fromSelectElem.style.width=arrDualSelectWidthAdjust[B].minWidth;arrDualSelectWidthAdjust[B].toSelectElem.style.width=arrDualSelectWidthAdjust[B].minWidth}else{if((arrDualSelectWidthAdjust[B].fromSelectElem.offsetWidth>arrDualSelectWidthAdjust[B].maxWidth)||(arrDualSelectWidthAdjust[B].toSelectElem.offsetWidth>arrDualSelectWidthAdjust[B].maxWidth)){arrDualSelectWidthAdjust[B].fromSelectElem.style.width=arrDualSelectWidthAdjust[B].maxWidth;arrDualSelectWidthAdjust[B].toSelectElem.style.width=arrDualSelectWidthAdjust[B].maxWidth}else{C=arrDualSelectWidthAdjust[B].fromSelectElem.offsetWidth;A=arrDualSelectWidthAdjust[B].toSelectElem.offsetWidth;if(C!=A){if(C<A){arrDualSelectWidthAdjust[B].fromSelectElem.style.width=A;arrDualSelectWidthAdjust[B].toSelectElem.style.width=A}else{arrDualSelectWidthAdjust[B].toSelectElem.style.width=C;arrDualSelectWidthAdjust[B].fromSelectElem.style.width=C}}else{arrDualSelectWidthAdjust[B].toSelectElem.style.width=C;arrDualSelectWidthAdjust[B].fromSelectElem.style.width=C}}}if(D!=""||D<arrDualSelectWidthAdjust[B].fromSelectElem.style.width){D=arrDualSelectWidthAdjust[B].fromSelectElem.style.width}}if(arrDualSelectWidthAdjust.length>0){D=parseInt(D.substring(0,3));width=D+D+100;height=windowSize()[1]}}function validateInputString(A){if(A.value.length>700){return}for(i=0;i<A.value.length;i++){if(A.value.charCodeAt(i)==8217){A.value=A.value.substring(0,i)+"'"+A.value.substring(i+1)}if(A.value.charCodeAt(i)==8221){A.value=A.value.substring(0,i)+'"'+A.value.substring(i+1)}}}function validateCaseType(B,A){if(A==1){B.value=B.value.toUpperCase()}else{if(A==2){B.value=B.value.toLowerCase()}}B.value=trimStr(B.value)}function trimStr(C){var B=0;var D=C.length-1;for(var A=0;A<C.length;A++){ch=C.charAt(A);if(ch!=" "){B=A;break}}for(var A=C.length-1;A>=0;A--){ch=C.charAt(A);if(ch!=" "){D=A;break}}return C.substring(B,D+1)}function validateMaxlength(C,A,B){}function convertValidateLength(B,A){}function callSetFolder(B,A,C){}function windowSize(){var B=0;var A=0;var C=0;if(typeof(window.innerWidth)=="number"){B=window.innerWidth;A=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){B=document.documentElement.clientWidth;A=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){B=document.body.clientWidth;A=document.body.clientHeight}}}return[B,A]}function getScrollXY(){var C=0;var A=0;var D=document.body.scrollHeight;var B=document.body.offsetHeight;if(D>B){A=document.body.scrollHeight;C=document.body.scrollWidth}else{A=document.body.offsetHeight;C=document.body.offsetWidth}return[C,A]}function resizeToFit(){var C=windowSize();var B=getScrollXY();var G=C[0];var D=C[1];var I=B[0]+60;var H=B[1]+60;var J=screen.availWidth*90/100;var A=screen.availHeight*90/100;if(I>G){if(I>J){G=J}else{G=I}}if(H>D){if(H>A){D=A}else{D=H}}this.resizeTo(G,D);C=windowSize();G=C[0];D=C[1];var F=(screen.availWidth-G)/2;var E=(screen.availHeight-D)/2;this.moveTo(F,E)}function getRefToDivMod(B,C){if(!C){C=document}if(document.layers){if(C.layers[B]){return C.layers[B]}else{for(var A=0,D;!D&&A<C.layers.length;A++){D=getRefToDivNest(B,C.layers[A].document)}return D}}if(document.getElementById){return C.getElementById(B)}if(document.all){return C.all[B]}return C[B]}function getDivXY(C){var B=getRefToDivMod(C);if(!B){return[0,0]}var A=B.clip?B.clip.width:B.offsetWidth;var B=B.clip?B.clip.height:B.offsetHeight;return[A,B]}function resizeWinTo(C){var N=screen.availWidth*90/100;var O=screen.availHeight*90/100;var E=50;var F=50;var D=650-E;var H=250-F;document.getElementById(C).style.width=D;document.getElementById(C).style.height=H;var M=document.getElementById(C).offsetWidth+E;var G=document.getElementById(C).offsetHeight+F;if(M>N){M=N}if(G>O){G=O}var A=((navigator.appName=="Netscape"));var L,K;var B,P;if(A){L=window.screenX+((window.outerWidth-M)/2);K=window.screenY+((window.outerHeight-G)/2);B=window.outerWidth;P=window.outerHeight}else{L=(screen.width-M)/2;K=(screen.height-G)/2;B=document.body.offsetWidth+E;P=document.body.offsetHeight+F}if(M<=B&&G<=P){return}window.resizeTo(M,G);var J=(screen.availWidth-M)/2;var I=(screen.availHeight-G)/2;this.moveTo(J,I)}function doOnLoadResizeWindow(B,I){B=parseInt(B);I=parseInt(I);var C=windowSize();var H=C[0];var K=C[1];var J=screen.availWidth*90/100;var A=screen.availHeight*90/100;if((H>J&&H>B)||(K>A&&K>I)){return}window.resizeTo(B,I);C=windowSize();H=C[0];K=C[1];var D=B-H;var E=I-K;window.resizeTo(B+D,I+E);var G=(screen.availWidth-B)/2;var F=(screen.availHeight-I)/2;this.moveTo(G,F)}function getOffsetLeft(B){var A=0;try{A=B.offsetLeft;while((B=B.offsetParent)!=null){A+=B.offsetLeft}}catch(C){}return A}function getOffsetTop(A){var B=0;try{B=A.offsetTop;while((A=A.offsetParent)!=null){B+=A.offsetTop}}catch(C){}return B}function submitURL(A){if(isMainPageDirty()){if(!confirm(localMsg.unsavedChangeError)){return}}if(opener){opener.top.frames.RightPane.location.href=A}else{this.top.frames.RightPane.location.href=A}}function setElementFocus(A){YAHOO.util.Dom.addClass(A,"focus_field");YAHOO.util.Dom.removeClass(A,"error_field")}function removeElementFocus(A){YAHOO.util.Dom.removeClass(A,"focus_field")}function showCounterFld(A,B){document.getElementById(B).style.visibility="visible";if(A){A.focus()}}function hideCounterFld(A,B){document.getElementById(B).value="";document.getElementById(B).style.visibility="hidden"}function updateCharCount(E,N,F){var J=4000;var K=(F)*0.05;var D=E.value;var I=D.length;var M=0;var B=0;var A=0;for(var H=0;H<I;H++){var C=0;var G=0;if(D.charCodeAt(H)==10&&!is_ie){G=2;C=2}else{G=1;C=bytesCountingOfChar(D.charCodeAt(H))}if(((B+G)>F)||((A+C)>J)){M=H;break}B+=G;A+=C;if(is_mac&&D.charCodeAt(H)==10&&(H+1)<I&&D.charCodeAt(H+1)==10){H++}}var L=Math.min(F-B,J-A);if(L<=K){document.getElementById(N).style.color="#C60000";document.getElementById(N).style.fontWeight="bold"}else{document.getElementById(N).style.color="";document.getElementById(N).style.fontWeight=""}if(M>0){E.value=E.value.substring(0,M)}document.getElementById(N).value=L}function bytesCountingOfChar(A){if(A<=127){return 1}else{if(A<=2047){return 2}else{if(A<=65535){return 3}else{return 4}}}}function buttonFocus(A){if(document.getElementById(A)==null){return}if(document.getElementById(A).className.indexOf("disabled")!=-1){return}document.getElementById(A).hideFocus="true";YAHOO.util.Dom.addClass(document.getElementById(A),"a_hover");A=A+"span";YAHOO.util.Dom.addClass(document.getElementById(A),"s_hover")}function buttonBlur(A){YAHOO.util.Dom.removeClass(document.getElementById(A),"a_hover");A=A+"span";YAHOO.util.Dom.removeClass(document.getElementById(A),"s_hover")}function popMessage(A,D){var C="dms";if(typeof(D)!="undefined"&&D.length>0){C=D}var B=document.getElementById(C);if(!B){return}switch(A){case"info":jQuery("#"+C+".message").attr("style","background-color:#b0cbee");jQuery("#"+C).animate({backgroundColor:"#d9e8fd"},1500);break;case"error":jQuery("#"+C+".message").attr("style","background-color:#FF7F87");jQuery("#"+C).animate({backgroundColor:"#ffc8ca"},1500);break;default:break}}function xmlRequest(){var D=null;try{D=new ActiveXObject("Msxml2.XMLHTTP")}catch(A){try{D=new ActiveXObject("Microsoft.XMLHTTP")}catch(B){D=null}}if(!D&&typeof XMLHttpRequest!="undefined"){D=new XMLHttpRequest()}return D}var refDesCtr=0;function createXMLObject(){var A=new xmlRequest();if((A.readyState==4||A.readyState==0)){refDesCtr=0;return A}else{if(refDesCtr<10){refDesCtr++;return createXMLObject()}}refDesCtr=0;return null}var popupButtonDisabledStyle="buttonDisabled";var objectButtonDisabledStyle="iconButtonDisabledWithBorder";var linkHasBeenClicked=false;var warnToSave=true;var setCursorToHourglass=true;var tableViewOffsetHeight=0;function openUrl(B){var A=new Date();window.open(B,A.getTime())}function getFormNN(formName,i){for(var ctr=i;ctr>=0;ctr--){if(document.forms.spiffyCal){i++;break}}if(formName==null||formName.length==0){return document.forms[i]}return eval("document."+formName)}function addObjectTypeKnownNumbers(A){openDialogWindow("",document.MainForm.module.value,"showAddObjectTypeKnownNumbers","popupWindow",350,450,"true","no","&wizardId="+A)}function openDialogWindowForIlog(I,C,D,F,J,A,B,E,H){var G=getForm(I);G.action="DashboardPLMServlet";openDialogWindow(I,C,D,F,J,A,B,E,H);setTimeout("frm.action = 'PCMServlet'",1000)}function openUploadFileProgressDialogWindow(K,C,E,I,L,A,B,G,J,F){if(I=="_New"){I="popUpWindow"+Math.round(Math.random()*100)}if(G==null||G==""){G="yes"}openModalDialog("",A,L,I,G,null,null,null,null,"false");try{var D="<p id='message' style='padding-left: 74px;padding-top:65px;float: left;color:#333333;font-family:Arial,Verdana,sans-serif;font-size:10px;font-size-adjust:none;font-style:normal;font-variant:normal;font-weight:normal;line-height:normal;'>";D+="<span style='float:left;padding:2px;width:16px;height:16px;background:transparent url("+F+") no-repeat scroll center center' ></span>"+localMsg.uploadingFilesMsg+"</p>";dialogWin.win.document.body.innerHTML=D}catch(H){}fName=K;mod=C;op=E;wName=I;isPop=B;xArgs=J;doSubmitFormLater(fName,mod,op,wName,isPop,xArgs)}function refreshFromGantt(){submitForm("","","refreshFromGantt","","","true","")}function refreshLeftPaneBookmarks(){var A=this.top.RightPane;A.refreshBookmarks()}function refreshLeftPaneSearchTree(){var A=this.top.RightPane;A.refreshSearchTree()}function sortTableBy(tableId,attrId,sortType,refresh){var frm=getForm("");eval("frm.currentPaginationTableId").value=tableId;var sortCriteria="sortCriteria_"+tableId;eval("frm."+sortCriteria).value="&sortBy="+attrId+"&sortType="+sortType;reloadData(refresh)}function reloadData(A){submitForm("","","","","",A)}function submitFormNoWarn(C,B,G,F,A,D,E){warnToSave=false;submitForm(C,B,G,F,A,D,E)}function preSubmitForm(C,B,G,F,A,D,E){if(G!=null&&G=="updateRefreshRows"){disableButton("Save")}if(G!=null&&G=="updateCoverPage"){disableButton("Cancel");3}}function ignoreClick(){return false}var doBeforeSubmit=null;try{doBeforeSubmit=new YAHOO.util.CustomEvent("doBeforeSubmit")}catch(err){}function submitForm(N,A,E,I,M,K,D){preSubmitForm(N,A,E,I,M,K,D);var L=getForm(N);if(N==null||N.length<=0){N=L.name}writeTableInfo(N,E);if(A!=null&&A.length>0){L.module.value=A}else{L.module.value=L.module.defaultValue}if(K!=null&&K.length>0){L.refresh.value=K}else{L.refresh.value=L.refresh.defaultValue}if(D!=null&&D.length>0){L.displayMode.value=D}else{L.displayMode.value=L.displayMode.defaultValue}if(E!=null&&E.length>0){L.opcode.value=E}else{L.opcode.value=L.opcode.defaultValue}if(I!=null&&I.length>0){L.target=I}if(I=="RightPane"){L.popup.value="false"}var J=document.body.clientHeight;var O=document.body.clientWidth;var C=J-250;var G=O-50;var F="";if(M==null||M.length==0){L.addlParam.value=L.addlParam.defaultValue}else{L.addlParam.value=M}setTokenRequired(L);if(window.name==I&&setCursorToHourglass){document.body.style.cursor="wait"}var B="";try{B=submitForm.caller.name}catch(H){}if((I=="_self"||!I)&&window.name!="MainWindow"&&B!="doSubmitFormLater"){disableActions(L.name);if(!I||I.indexOf("self")!=-1){document.body.style.cursor="wait"}else{document.body.style.cursor="default"}}if(doBeforeSubmit){doBeforeSubmit.fire()}L.submit();AGILE.util.preServerRequest()}function saveMultipleRows(K,C,F,G,J,H,D){var I=getForm(K);if(I.registeredTables!=null){var A=I.registeredTables.value;if(A!=null&&A.length>0){var B=A.split(",");var E=0;for(E=0;E<B.length;E++){if(shouldPersistSelections(K,B[E])){if(allWarningsResolved(K,B[E])){serializeWarningInfo(K,B[E])}else{alert(localMsg.resolveWarnings);return true}}}}}submitForm(K,C,F,G,J,H,D)}function autoSelectSingleRow(A,B,D){if(B==null||B.length<=0||D==null||D.length<=0){return}if(D=="showGetAttachmentPopup"){var C=getRowMap(B);if(C!=null&&C.length==2&&C[0]==null){C[1].isSelected="true"}}}function preDisplayObject(F,D,E,B,A,G,H,C){}function displayObjectForSite(E,F,B,C,A,G,H,D){if(isPageLoading){frm=getFormNN("",0)}else{frm=getFormNN("",1)}frm.siteId.value=C;displayObject(E,F,B,A,G,H,D)}function showMultiTextValue(D,E,H,G,C){var B="MainForm";var F=getForm(B);var A="multiTextRowId="+H+"&multiTextAttrId="+E+"&mutliTextFieldName="+G+"&multiTextTableId="+C;F.addlParam.value=A;openDialogWindow(B,D,"showMultiTextValue","popUpWindow","300","400","","",A)}function showRedlineMultiTextValue(D,A,J,B,E,G,C){var I="MainForm";var H=getForm(I);var F="multiTextRowId="+J+"&multiTextNewRowId="+B+"&multiTextAttrId="+A+"&mutliTextFieldName="+G+"&multiTextTableId="+C+"&mutliTextRStatus="+E;H.addlParam.value=F;openDialogWindow(I,D,"showRedlineMultiTextValue","popUpWindow","300","400","","",F)}function showMultiTextValueForSearch(C,A,I,E,B,H){var G="MainForm";var F=getForm(G);var D="multiTextRowId="+I+"&multiTextAttrId="+A+"&mutliTextFieldName="+E+"&multiTextTableId="+B+"&rowObjectClassId="+H;F.addlParam.value=D;openDialogWindow(G,C,"showMultiTextValueForSearch","popUpWindow","300","400","","",D)}function displayDashboardObject(C,D,B,A){displayObject(C,D,B,A,"","","IGNORE_TRAIL=true","","content_view")}function displayTrailObject(A){if(checkReqFiledOnChange()){return}if(isMainPageDirty()){return}var B=getForm("MainForm");var C="module="+B.module.value+"&opcode=navigateTrailObject&trailIndex="+A;markRecentlyForRefresh=true;displayContent({containerToUpdate:RIGHTPANECONTENT,params:C})}function displayObject(C,F,J,A,G,H,I,B,E,D){displayObjectUsingFormName("MainForm",C,F,J,A,G,H,I,B,E,D)}function displayObjectUsingFormName(X,E,S,M,c,h,Y,I,T,Q,Z,e){if(checkReqFiledOnChange()){return}if(isMainPageDirty()){return}if(isPageLoading){frm=getFormNN(X,0)}else{frm=getFormNN(X,1)}if(!frm){displayObjectFromLeftPane(E,S,M,c);return}var G=frm.objid.value;var H=frm.classid.value;var V=frm.tabid.value;var N={args:{rclassid:H,robjid:G,rtabid:V}};if(typeof(e)!="undefined"){AGILE.grid.auditArgs=e}else{AGILE.grid.auditArgs=null}var L=getForm(X);var K="";if(L&&L.objver){K=L.objver.value}if(G!=M&&frm.fulltabledisplay){frm.fulltabledisplay.value="false"}preDisplayObject(frm,E,S,M,c,h,Y,I);cancelQuickViewLink();cancelVersionPalette();if(closeActivityNewsPalette){closeActivityNewsPalette()}if(closeSubstancesView){closeSubstancesView()}if(E!=null&&E.length>0){frm.module.value=E}else{frm.module.value=frm.module.defaultValue;E=frm.module.defaultValue}if(h!=null&&h.length>0){frm.target=h}else{frm.target="_self";h="_self"}if(T!=null&&T.length>0){frm.opcode.value="refreshObject";opcode="refreshObject"}else{frm.opcode.value="displayObject";opcode="displayObject"}if(Z!=null&&Z.length>0){frm.displayMode.value=Z}else{frm.displayMode.value=0}var R=0;var C=frm.popup.value;if(S!=null&&S.length>0){frm.classid.value=S}if(M!=null&&M.length>0){frm.objid.value=M}if(c!=null&&c.length>0){frm.tabid.value=c}if(h!=null&&h.length>0){frm.target=h}if(Y!=null&&Y.length>0){if(typeof(frm.viewid)!="undefined"){frm.viewid.value=Y}}if(c!=null&&c.length>0&&S!=null&&S.length>0){frm.helpID.value=S+"_"+c}if(h=="RightPane"){frm.popup.value="";C=""}var F="";var d="";var A="";if(typeof(frm.cgToItemRevObjId)!="undefined"&&frm.cgToItemRevObjId!=null){F=frm.cgToItemRevObjId.value}if(typeof(frm.cgToItemRevClassId)!="undefined"&&frm.cgToItemRevClassId!=null){d=frm.cgToItemRevClassId.value}if(typeof(frm.cgToItemRevSiteId)!="undefined"&&frm.cgToItemRevSiteId!=null){A=frm.cgToItemRevSiteId.value}var O="";var W="";var P="";if(typeof(frm.preItemRevObjId)!="undefined"&&frm.preItemRevObjId!=null){O=frm.preItemRevObjId.value}if(typeof(frm.preItemRevClassId)!="undefined"&&frm.preItemRevClassId!=null){W=frm.preItemRevClassId.value}if(typeof(frm.preItemRevSiteId)!="undefined"&&frm.preItemRevSiteId!=null){P=frm.preItemRevSiteId.value}if(F!=null&&F.length>0){frm.preItemRevObjId.value=F}if(d!=null&&d.length>0){frm.preItemRevClassId.value=d}if(A!=null&&A.length>0){frm.preItemRevSiteId.value=A}var B=document.body.clientHeight;var J=document.body.clientWidth;var l=B-250;var b=J-50;var f="";if(I==null||I.length==0){f=frm.addlParam.defaultValue}else{f=I}setTokenRequired(frm);if(document.MainForm&&document.MainForm.isProgramSummaryView&&document.MainForm.isProgramSummaryView.value){Q=RIGHTPANECONTENT}if(window.name==h&&setCursorToHourglass){document.body.style.cursor="wait"}var D;if(Q!=null&&Q.length>0){D=Q}else{if(!T&&G==M&&H==S&&O==F&&W==d&&P==A){if(frm.fulltabledisplay&&frm.fulltabledisplay.value=="true"&&frm.tabid.value!=V){D=RIGHTPANECONTENT}else{D=getTargetContainer(TABSVIEW_WRAPPER)?TABSVIEW_WRAPPER:RIGHTPANECONTENT}}else{D=RIGHTPANECONTENT}}if(G!=M||H!=S){AGILE.EventManager.fireEvent("","objectChanged")}var g=getTargetContainer(D);if(g){if(frm.tabid.value!=V){var U=getForm(X,0);U.tabid.value=c;AGILE.event.tabChangedEvent.fire()}if(H==S){var a=document.getElementById("pageViewContent");if(a){cachedPageViewHeight=a.style.height}if(cachedPageViewHeight){f+="&pageViewHeight="+cachedPageViewHeight}}else{cachedPageViewHeight=null}if(typeof(e)!="undefined"&&typeof(e.issubtable)!="undefined"&&!e.issubtable){if(typeof(e.subtabid)!="undefined"&&e.subtabid!=""&&e.subtabid.length>0&&e.subtabid!="0"){hiddenParams=getFormHiddenElems(frm,e.subtabid)+"&"+f}else{if(typeof(e.expandlevel)!="undefined"&&e.expandlevel!="1"){hiddenParams="expandLevel="+e.expandlevel+"&refresh=true&"+getFormHiddenElems(frm)+"&"+f}else{hiddenParams=getFormHiddenElems(frm)+"&"+f}}hiddenParams=hiddenParams+"&needHighlight=true&highlightRowId="+e.rowid[0]+"&highlightAttrId="+e.attrid[0]}else{hiddenParams=getFormHiddenElems(frm)+"&"+f;if(typeof(e)!="undefined"&&typeof(e.issubtable)!="undefined"&&e.issubtable){hiddenParams=hiddenParams+"&needSelect=true&parentRowId="+e.rowid+"&highlightAttrId="+e.subattrid[0]+"&highlightRowId="+e.subrowid[0]+"&highlightSubTabId="+e.subtabid+"&loadSubTableFlag="+e.loadSubTableFlag}}displayContent({containerToUpdate:D},hiddenParams,"",N)}else{frm.submit()}}function getFormHiddenElems(D,C){var A="";if(D!=null){for(var B=0;B<D.elements.length;B++){if(D.elements[B].type=="hidden"&&!D.elements[B].disabled){var E=D.elements[B];if(E.name=="subTabId"&&typeof(C)!="undefined"){A+="subTabId="+C+"&"}else{A+=E.name+"="+encodeURIComponent(E.value)+"&"}}}}return A}function filterTableDivParams(A){return A.substring(0,A.indexOf("&START&"))+A.substring(A.indexOf("&END&")+5,A.length)}function displayObjectForQuery(D,G,E,B,A,F,H,C){if(checkReqFiledOnChange()){return}if(isMainPageDirty()){return}frm=getFormNN("",1);preDisplayObject(frm,D,E,B,A,F,H,C);if(D!=null&&D.length>0){frm.module.value=D}else{frm.module.value=frm.module.defaultValue}if(F!=null&&F.length>0){frm.target=F}else{frm.target="_self"}frm.opcode.value=G;frm.displayMode.value=0;if(E!=null&&E.length>0){frm.classid.value=E}if(B!=null&&B.length>0){frm.objid.value=B}if(A!=null&&A.length>0){frm.tabid.value=A}if(F!=null&&F.length>0){frm.target=F}if(H!=null&&H.length>0){frm.viewid.value=H}if(C!=null&&C.length>0){frm.addlParam.value=C}setTokenRequired(frm);if(window.name==F&&setCursorToHourglass){document.body.style.cursor="wait"}frm.submit()}function displayItem(B,C,J,A,E,G,I,D,K,F){var H=getForm("MainForm");H.cgToItemRevObjId.value=D;H.cgToItemRevClassId.value=K;H.cgToItemRevSiteId.value=F;H.warningString.value="";if(I==null||I.length==0){I=" "}displayObject(B,C,J,A,E,G,I)}function displayDesignObject(B,C,I,A,D,F,H,E){var G=getForm("MainForm");if(G.version){G.version.value=E}if(G.warningString){G.warningString.value=""}if(H==null||H.length==0){H=" "}H=H+"&version="+E;displayObject(B,C,I,A,D,F,H,"",RIGHTPANECONTENT)}function displayCreateObject(A,D,B){var C=getForm("");C.module.value=D;C.opcode.value="goToStep";C.subclsid.value=A;C.addlParam.value="&wizardId="+B;submitForm(C.name,D,"goToStep","","&wizardId="+B)}function displayCreateNewObjectPopup(F,D,E,C){var B=570;var A=500;setTimeout(function(){displayCreateNewObjectPopupWithSize(F,D,E,C,A,B)},800)}function displayCreateNewObjectPopupWithSize(B,H,F,C,G,A){var E=getForm("reqForm");E.create_subclsid.value="";E.wizardId.value=F;E.wizardHandler.value=B;var I=F+"topCreatePopupSize";var D=readCookie(I);if(checkReqFiledOnChange()){return}if(isMainPageDirty()){return}if(D.length>0){A=parseInt(D.split(":")[0]);G=parseInt(D.split(":")[1])}if(typeof(C)!="undefined"&&C!=null){E.create_subclsid.value=C;openDialogWindow(E.name,H,"createNewObjectInPopup","createObject",G,A,"true","false","")}else{openDialogWindow(E.name,H,"createNewObjectInPopup","createObject",G,A,"true","false","")}}function displayCreateNewObjectPopupFromObject(D,M,B,H,E,I){var G=getForm("MainForm");var K="";if(G.create_subclsid!="undefined"&&G.create_subclsid!=null){K=G.create_subclsid.value;G.create_subclsid.value=""}var C="&objCtxCreate=true&wizardId="+H+"&wizardHandler="+D;if(typeof(I)=="string"&&I!=null&&I.length>0){if(I.charAt(0)!="&"){I="&"+I}C+=I}if(G.FROM_CONTENT_TAB){setContentTabValue("false")}var A=550;var J=500;var L=H+"topCreatePopupSize";var F=readCookie(L);if(H=="102"&&D=="CreateProjectWizardHandler"){A=750}if(F.length>0){A=parseInt(F.split(":")[0]);J=parseInt(F.split(":")[1])}if(G.isFromMfr&&(M=="MfrHandler"||M=="MfrHandler")){G.isFromMfr.value="true"}if(typeof(E)!="undefined"&&E!=null&&typeof(G.create_subclsid)!="undefined"){G.create_subclsid.value=E;openDialogWindow(G.name,M,B,"_New",J,A,"true","false",C);G.create_subclsid.value=K}else{openDialogWindow(G.name,M,B,"_New",J,A,"true","false",C)}if(G.FROM_CONTENT_TAB){setTimeout("setContentTabValue('true')",1500)}}function setContentTabValue(A){var B=getForm("MainForm");B.FROM_CONTENT_TAB.value=A}function displayCreateNewObject(D,B,A){var C=getForm("");C.create_subclsid.value="";C.wizardId.value=B;if(typeof(A)!="undefined"&&A!=null){displayCreateNewObjectBySubclass(D,B,A)}else{submitForm("reqForm",D,"createNewObject","RightPane")}}function displayCreateNewObjectBySubclass(D,B,A){var C=getForm("");C.create_subclsid.value=A;C.wizardId.value=B;submitForm(C.name,D,"createNewObject","RightPane")}function displayCreateNewPDX(wizardHandler,wizardId){var frm=getFormFromFrame("","RightPane");if(frm==null||frm.module==null||frm.opcode==null){frm=getFormFromFrame("","TopPane")}frm.action="PCMServlet";frm.module.value=wizardHandler;frm.opcode.value="displayNewPDXWizard";frm.target="RightPane";if(frm.wizardId!=null){frm.wizardId.value=wizardId}else{frm.addlParam.value="&wizardId="+wizardId}frm.addlParam.value=frm.addlParam.value+"&SHOWDIV=false";if(frm.stepId!=null){frm.stepId.value=""}var registeredTables=frm.registeredTables.value;if(registeredTables!=null&&registeredTables.length>0){var tableIds=registeredTables.split(",");var i=0;var result;var selections;var rowObjectMap;var editedRows;var result;var rowmap;for(i=0;i<tableIds.length;i++){if(tableIds[i]!="2"){continue}result=top.frames.RightPane.document.forms[0].persistSelections_2.value;if(result=="true"){selections="";rowObjectMap="";editedRows="";result="";rowmap=eval("top.frames.RightPane.tableArray[tableIds[i]];");if(rowmap==null){rowmap=new Array()}for(i=1;i<rowmap.length;i++){selections=selections+i+"="+rowmap[i].isSelected+"&";rowObjectMap=rowObjectMap+i+"="+rowmap[i].objectID+"&";if(rowmap[i].isEdited==true){editedRows=editedRows+rowmap[i].objectID+"&"}}top.frames.RightPane.document.forms[0].Selections_2.value=selections;top.frames.RightPane.document.forms[0].TableRowMap_2.value=rowObjectMap;top.frames.RightPane.document.forms[0].TableDirtyRows_2.value=editedRows}}}top.frames.RightPane.document.body.style.cursor="wait";frm.submit()}function displayAdvSearch(B,A){document.SearchForm.module.value=B;document.SearchForm.opcode.value="goToStep";document.SearchForm.target="RightPane";document.SearchForm.addlParam.value="&wizardId="+A;setTokenRequired(document.SearchForm);document.SearchForm.objid.value="";document.SearchForm.submit()}function lastSearchResult(){var A=getForm("");submitForm(A.name,"hcmLastSearchHandler","displaySearchResultView")}function refreshTables(A){var B=getForm("");if(A==true){B.refresh.value="true"}else{B.refresh.value="false"}}function setElementsBeforeRefreshRightPane(){}function refreshRightPane(){var C=new Array();var B=getForm("MainForm");var A="";C[C.length]="&refresh=true";C[C.length]="&IGNORE_BACK_FORWARD=true";if(B.siteId){C[C.length]="&siteId="+B.siteId.value}if(B.row_ObjSiteId){C[C.length]="&row_ObjSiteId="+B.row_ObjSiteId.value}if(B.revchangeid){C[C.length]="&revchangeid="+B.revchangeid.value;C[C.length]="&revchangeclass="+B.revchangeclass.value}if(B.subTabId){C[C.length]="&subTabId="+B.subTabId.value}if(B.VERSION_SELECT_NAME){C[C.length]="&version="+B.VERSION_SELECT_NAME.value;A=B.VERSION_SELECT_NAME.value}if(B.fulltabledisplay){C[C.length]="&fulltabledisplay="+B.fulltabledisplay.value}if(B.fullgridtableid){C[C.length]="&fullgridtableid="+B.fullgridtableid.value}if(B.NAV_TO_KEY){C[C.length]="&NAV_TO_KEY="+B.NAV_TO_KEY.value}if(B.SELECTED_PARENT_ROWID){C[C.length]="&SELECTED_PARENT_ROWID="+B.SELECTED_PARENT_ROWID.value}doBeforeRefreshRightPane();AGILE.util.ClearGridScrollInfo();if(B.module&&B.module.value=="DashboardHandler"){displayContent({containerToUpdate:RIGHTPANECONTENT,opcode:"showPreferredInbox",module:"InboxSearchHandler"},C.join(""),"MainForm")}else{displayContent({containerToUpdate:RIGHTPANECONTENT,version:A},C.join(""),"MainForm")}}var prefStartPageUrl="";function goHome(){if(isMainPageDirty()){return}enablePageRefresh();prefStartPageUrl=prefStartPageUrl+"&IGNORE_BACK_FORWARD=true";displayContentForUrl(prefStartPageUrl,RIGHTPANECONTENT)}function doBeforeRefreshRightPane(){}function gotoPage(C,B,A,E){var D=getForm(C);D.pageName.value=A;submitForm(C,B,"",E)}function refreshBookmarks(){var A=this.top.RightPane;A.refreshBookmarks()}function isFieldEmpty(B){var A=0;var C=0;if(B.value.length==0){return true}for(A=0;A<B.value.length;A++){if(B.value.charAt(A)==" "){C++}}if(C&&A==C){return true}return false}function displayValueDialog(C,B,E){if(!E.length>0){return}var D=getForm("");D.refDesLabel.value=B;D.refDesValue.value=E;var A=D.module.value;openModalDialog("PCMServlet?module="+A+"&opcode=refDesPopUp&popup=true",300,300,C,"yes")}function setTokenRequired(frm){if(frm.target!=null&&frm.target.length>0){if(frm.target=="RightPane"){var isTokenRequired=eval(frm.isTokenRequired);if(isTokenRequired!=null){isTokenRequired.value="true"}}}}function trim(C){var B=0;var D=C.length-1;for(var A=0;A<C.length;A++){ch=C.charAt(A);if(ch!=" "){B=A;break}}for(var A=C.length-1;A>=0;A--){ch=C.charAt(A);if(ch!=" "){D=A;break}}return C.substring(B,D+1)}function removeDblBR(B){var C=B.replace(/\<BR\>\<BR\>/gi,"<BR>");var A=C.replace(/\<BR\>\<BR\>/gi,"<BR>");return A}function doCheckOut(F,B,G,C){var D="MainForm";var E=getForm(D);var A="rowId="+F+"&filename="+B+"&fileid="+G+"&filesize="+C+"&version="+version;E.addlParam.value=A;submitForm(D,"","checkoutAttachment","RightPane",A)}function showAttachmentPopup(G,C,H,D,B){var E="MainForm";var F=getForm(E);var A="rowId="+G+"&filename="+C+"&fileid="+H+"&filesize="+D+"&version="+B;F.addlParam.value=A;openDialogWindow(E,"","showAttachmentPopup","popUpWindow","300","400","","",A)}function checkoutAttachment(G,C,H,D,B){var E="MainForm";var F=getForm(E);var A="rowId="+G+"&filename="+C+"&fileid="+H+"&filesize="+D+"&version="+B+"&checkout=true";F.addlParam.value=A;submitForm(E,"","checkoutAttachment","RightPane",A)}function displayEditObject(button,module,tableId){var frm=getForm("");button.className=objectButtonDisabledStyle;button.disabled=true;var displayTableName="displayModeForTable_"+tableId;eval("frm."+displayTableName).value="1";submitForm(frm.name,module,"displayEditObject","RightPane","")}function doCancelCheckOut(C){var A="MainForm";var B=getForm(A);B.addlParam.value=C;submitForm(A,"","cancelCheckoutFile","RightPane",C)}function doCheckIn(E,C){var B="MainForm";var D=getForm(B);var A="rowId="+E+"&filetype="+C;openDialogWindow(B,"","showCheckInDialog","popUpWindow","150","400","","",A)}function refreshAttachmentVersion(I,B){var E="MainForm";var H=getForm(E);var C=I.selectedIndex;var G=I.options[C].text;var A="selectedRow="+B+"&selectedVersion="+G;H.addlParam.value=A;var D=H.opcode.value;var F=H.target;submitForm(E,"","displayObject","RightPane",A);H.opcode.value=D;H.target=F}function exportSupplierResponse(){var A=document.MainForm.module.value;openDialogWindow("MainForm",A,"exportAll_Popup","_New",160,400)}function changeActivityStatus(A){var C="MainForm";var B=getForm(C);openDialogWindow("MainForm_2__","ActivityHandler","preAuditDisplayChangeStatus","popupWindow",520,568,"true","no","&toState="+A)}function setActivityStatus(B){var C="MainForm";var A="";if(B!=""){A="toState="+B}openDialogWindow(C,"ActivityHandler","setChangeStatus","popupWindow",430,530,"true","no",A)}function changeSupplierStatus(A){var C="MainForm";var B=getForm(C);B.toState.value=A;submitForm(C,"SupplierHandler","changeStatus","RightPane")}function noaction(){return}function invokeProcessAction(B){if(isMainPageDirty()){return}var A=getForm("MainForm");A.process_actionId.value=B;A.refreshObjectTables.value="true";submitForm2({opcode:"invokeCustomProcessActions"})}function invokePXActionFromToolsMenu(D,A){if(isMainPageDirty(false,localMsg.pxUnsavedChangeError,true)){return}var B=getForm("MainForm");B.process_actionId.value=D;var C=[];var C="ajaxRequest=true&opcode=invokeCustomProcessActions&module="+A+"&process_actionId="+D;sendAJAXRequest(C,postProcessPXAction,false,null,{},true)}function postProcessPXAction(C){var B=C.thisConn.getResponseHeader("ActionStatus");var D=C.thisConn.getResponseHeader("DisplayPXResultInHTML");var A=AGILE.util.DMS.MSG_DISPLAY_TYPE.TEXT;if("true"==D){A=AGILE.util.DMS.MSG_DISPLAY_TYPE.HTML}AGILE.util.DMS.setMessage(B=="1"?AGILE.util.DMS.INFO:AGILE.util.DMS.ERROR,C.text,"",A)}function addBookMarks(formname,params){if(typeof(formname)=="undefined"){formname="MainForm"}if(typeof(params)=="undefined"){params=""}var module=eval("document."+formname+".module").value;openDataDialog(formname,"",module,"showBookmarkTree",5,"",";",454,566,params,"SaveSearchPopup")}function showSubscription(formname,params){if(isMainPageDirty()){return}if(typeof(formname)=="undefined"){formname="MainForm"}if(typeof(params)=="undefined"){params=""}var module=eval("document."+formname+".module").value;openDataDialog(formname,"",module,"showSubscription",5,"",";",450,850,params,"SaveSearchPopup")}function sendObject(formname,params){if(isMainPageDirty()){return}if(typeof(formname)=="undefined"){formname="MainForm"}if(typeof(params)=="undefined"){params=""}var module=eval("document."+formname+".module").value;openDataDialog(formname,"",module,"showSendObjectPage",5,"",";",456,573,params,"SaveSearchPopup")}function changeParent(){if(isMainPageDirty()){return}var A="MainForm";openDialogWindow(A,"ActivityHandler","showChangeParentActivityPopup","popupWindow",380,730,"true","no","AddObjectTableId=0")}function showCommentPage(formname,params){if(isMainPageDirty()){return}if(typeof(formname)=="undefined"){formname="MainForm"}if(typeof(params)=="undefined"){params=""}var module=eval("document."+formname+".module").value;openDataDialog(formname,"",module,"loadCommentPage",5,"",";",527,570,params,"popupWindow")}function showAddApproverObserverPage(B,A){if(A){openDataDialog("MainForm","",B,"addApproversAndObservers",5,"",";",557,570,"needDisplayAck=true","popupWindow")}else{openDataDialog("MainForm","",B,"addApproversAndObservers",5,"",";",557,570,"","popupWindow")}}function showRemoveApproverObserverPage(B,A){if(A){openDataDialog("MainForm","",B,"removeApproversAndObservers",5,"",";",557,570,"needDisplayAck=true","popupWindow")}else{openDataDialog("MainForm","",B,"removeApproversAndObservers",5,"",";",557,570,"","popupWindow")}}function auditStatus(){var formname="MainForm";var module=eval("document."+formname+".module").value;var classid=eval("document."+formname+".classid").value;var objectid=eval("document."+formname+".objid").value;var callBackArgs=new Array();callBackArgs[0]=formname;callBackArgs[1]=objectid;callBackArgs[2]="doAuditStatus";callBackArgs[3]=430;callBackArgs[4]=530;var param="PCMServlet?ajaxRequest=true&module="+module+"&opcode=doAuditStatus&objid="+objectid+"&classid="+classid+"&popup=false&pheight="+callBackArgs[3]+"&pwidth="+callBackArgs[4];AGILE.util.animate(document.body);sendAJAXRequest(param,confirmAuditRelease,true,null,callBackArgs,true)}function reprocessCTO(){var formname="MainForm";var module=eval("document."+formname+".module").value;var classid=eval("document."+formname+".classid").value;var objectid=eval("document."+formname+".objid").value;var callBackArgs=new Array();callBackArgs[0]=formname;callBackArgs[1]=objectid;callBackArgs[2]="doReprocessCTO";var param="PCMServlet?ajaxRequest=true&module="+module+"&opcode=doReprocessCTO&objid="+objectid+"&classid="+classid;sendAJAXRequest(param,postReprocessCTO,true,null,null,true)}function postReprocessCTO(response){var responseInfo=eval("("+response.text+")");var success=responseInfo.StatusInfo[0].success;if(success=="true"){displayContent({containerToUpdate:RIGHTPANECONTENT,msg:responseInfo.StatusInfo[0].msg},"","MainForm")}else{AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,responseInfo.StatusInfo[0].msg)}}function confirmAuditRelease(response,callBackArgs){AGILE.util.stopAnimation();if(response.text.length>0){eval(response.text)}else{var opcode=callBackArgs[2];var height=callBackArgs[3];var width=callBackArgs[4];var statusId=callBackArgs[5];var addlParam="";if(statusId!=""){addlParam="toState="+statusId}openDialogWindow("MainForm_2__",document.MainForm.module.value,opcode,"popupWindow",height,width,"true","no",addlParam)}}handlePreAuditWarningForAjaxRequest=function(resolvedItems,reqParams){var flag=setPreAuditWarning(resolvedItems,reqParams,"MainForm_2__");if(flag){var addlParam="";if(reqParams.toState){addlParam="toState="+reqParams.toState}openDialogWindow("MainForm_2__",reqParams.module,reqParams.opcode,"popupWindow",reqParams.pheight,reqParams.pwidth,"true","no",addlParam);setTimeout(function(){eval("document.MainForm_2__.pgWarnID").value="";eval("document.MainForm_2__.pgWarnCode").value=""},500)}};handlePreAuditWarning=function(resolvedItems,reqParams){var flag=setPreAuditWarning(resolvedItems,reqParams,"MainForm");if(flag){submitForm("MainForm",reqParams.module,reqParams.opcode,"_self");setTimeout(function(){eval("document.MainForm.pgWarnID").value="";eval("document.MainForm.pgWarnCode").value=""},500)}};setPreAuditWarning=function(resolvedItems,reqParams,formName){var PGWARNID="preAuditRelease";var pgWarnId=[];var pgWarnCode=[];var entryValues=[];var xArgs="";var warningString="";if(resolvedItems&&resolvedItems.length==0){return false}for(var i=0;i<resolvedItems.length;i++){var resolvedRowId=resolvedItems[i].clientRowId;if(resolvedItems[i].appliedWarnCode==AGILE.EW.WARN_CANCELLED){continue}pgWarnId[pgWarnId.length]=PGWARNID+resolvedItems[i].entryValue;pgWarnCode[pgWarnCode.length]=resolvedItems[i].appliedWarnCode;entryValues[entryValues.length]=resolvedItems[i].entryValue}if(entryValues.length==0){return false}eval("document."+formName+".pgWarnID").value=pgWarnId.join(";")+";"+reqParams.pgWarnID;eval("document."+formName+".pgWarnCode").value=pgWarnCode.join(";")+";"+reqParams.pgWarnCode;return true};function auditRelease(){var A="MainForm";openDialogWindow("MainForm",document.MainForm.module.value,"doAuditRelease","popupWindow",430,530,"true","no","")}function showNextWorkflowStatus(statusId,opcode){if(isMainPageDirty()){return}var formname="MainForm";var module=eval("document."+formname+".module").value;var classid=eval("document."+formname+".classid").value;var objectid=eval("document."+formname+".objid").value;if(opcode==null||opcode==""){opcode="showNextWorkflowStatus"}var callBackArgs=new Array();callBackArgs[0]=formname;callBackArgs[1]=objectid;callBackArgs[2]=opcode;callBackArgs[3]=500;callBackArgs[4]=568;var param="";if(statusId==null||statusId==""){callBackArgs[5]="";param="PCMServlet?ajaxRequest=true&module="+module+"&opcode="+opcode+"&objid="+objectid+"&classid="+classid+"&popup=false&pheight="+callBackArgs[3]+"&pwidth="+callBackArgs[4]}else{callBackArgs[5]=statusId;param="PCMServlet?ajaxRequest=true&module="+module+"&opcode="+opcode+"&objid="+objectid+"&classid="+classid+"&toState="+statusId+"&popup=false&pheight="+callBackArgs[3]+"&pwidth="+callBackArgs[4]}AGILE.util.animate(document.body);sendAJAXRequest(param,confirmAuditRelease,true,null,callBackArgs,true)}function viewWorkflows(){var A="MainForm";openDataDialog(A,"",document.MainForm.module.value,"viewWorkflow",5,"",";",550,660,"","viewWorkflow")}function showPrintOptions(){var A="MainForm";openDataDialog(A,"",document.MainForm.module.value,"showPrintOptions",5,"",";",300,470,"","_New")}function showPrintOptionsForBOM(){var A="MainForm";openDataDialog(A,"",document.MainForm.module.value,"showPrintOptions",5,"",";",500,560,"","_New")}function closeProject(){if(confirm(localMsg.isChangeProjectStatus)){submitForm("MainForm",document.MainForm.module.value,"closeProject","RightPane")}}function quickExport(A){var B="MainForm";openDialogWindow(B,A,"quickExport","popupWindow",230,500,"true","true","")}function enableSupplierFinish(B){var A="MainForm";document.MainForm.isWebSupplier.value=B;if(B==1){alert(localMsg.isWebSupplierChecked)}document.MainForm.stepCommand.value="execute";submitForm("MainForm",document.MainForm.module.value,"executeCommand","RightPane","")}function getRegionsForEdit(A){var B="displayEditObject";submitForm("MainForm",document.MainForm.module.value,B,"","","",document.MainForm.displayMode.value)}function getRegionsForCreate(A){document.MainForm.stepCommand.value="execute";submitForm("MainForm",document.MainForm.module.value,"executeCommand","","")}function isWebUserSelected(C,B){var A="MainForm";var D=C[C.selectedIndex].value;if(D==1){if(B<=0){alert(localMsg.createUserForWebSupplier)}}}function showUserPopUpWhenWebSupplier(){var A="isFromCoverpage="+true;openDialogWindow("","SupplierHandler","createSupplierUser","popupWindow",600,700,"true","",A)}function refreshLeftPaneBOMView(C,D,E,F,B,H,A){var G=document.ContextualNavigation;G.classid.value=E;G.objid.value=F;var I;if(G.revchangeclass){G.revchangeclass.value=H}if(G.revchangeid){G.revchangeid.value=B}if(G.siteId){G.siteId.value=A}submitForm("ContextualNavigation",C,D)}function showAllMultiTextValues(){if(document.MainForm.viewMultiTextValues){document.MainForm.viewMultiTextValues.value="true"}submitForm("MainForm",document.MainForm.module.value,document.MainForm.opcode.value,"RightPane")}function makeSelectedValues(C,D){var B=document.getElementsByName(D).item(0);var A=document.getElementById(C);A.options.length=B.options.length;for(i=0;i<B.options.length;i++){A.options[i].value=B.options[i].value;A.options[i].text=B.options[i].text}for(i=0;i<A.options.length;i++){A.options[i].selected=true}}function checkSelections(tableId){var sKeys=parseInt(eval("document.MainForm.selectedItems_"+tableId+".value"));if(sKeys==0){alert(localMsg.checkSelections);return false}else{return true}}function deleteRows(A,B){confirmBeforeRemove(document.MainForm.module.value,B,"RightPane",A)}function getNextBatch(A){submitForm("","",A,"","","")}function disableActions(){var B=null;B=document.getElementById("wrapper_action_dialog_footer");try{if(B){var D=Dom.getElementsByClassName("button","a",B);for(var A=0;A<D.length;A++){Dom.addClass(D[A],"disabled");D[A].onclick=doNotSubmit}}}catch(C){}}function disableAllButtons(formName){document.body.style.cursor="wait";var form;if(formName==null){form=document.MainForm}else{form=eval("document."+formName)}var controls=form.elements.length;for(var i=0;i<controls;i++){var field=form.elements[i];if(field.type=="button"){field.disabled=true;field.className=popupButtonDisabledStyle}}}function clickIt(A){if(!browsertype){return}window.status="";switch(A){case"home":goHome();break;case"inbox":break;case"advsearch":displayAdvSearch_1("CreateAdvancedSearchWizardHandler","131");break;case"lastsearchresults":displayLastSearch();break;case"address":displayAddressBook();break;case"settings":settings();break;case"admin":break;case"tips":clickTips(true);break;case"simplesearch":doSimpleSearch();break;case"fulltextsearch":doFullTextSearch();break;case"searchoptions":doOptionsSearch();break;case"help":break;case"logout":logout();break;default:}}function showActivityScheduleReport(){var A=screen.availWidth*90/100;openDialogWindow("","ActivityHandler","showActivityScheduleReport","popupWindow",600,A,"true")}function doNotSubmit(){}function disableButton(A){document.body.style.cursor="wait";if(document.getElementById(A)!=null){document.getElementById(A).className=document.getElementById(A).className+" disabled";document.getElementById(A).onclick=doNotSubmit}}function disableSaveButton(A){if(document.getElementById(A)!=null){document.getElementById(A).className=document.getElementById(A).className+" disabled";document.getElementById(A).onclick=doNotSubmit}}function enableButton(B,A){document.body.style.cursor="default";var E=document.getElementById(B);if(E!=null){var D=E.childNodes[0];var C=B+"span";if(D!=null&&D.id==C){var F=D.getElementsByTagName("em");if(F!=null&&F.length==1){E.className="button";E.focus();buttonFocus(B);E.onclick=A}else{E.className="button";E.focus();buttonFocus(B);E.onclick=A;E.ondbclick=A}}else{E.className="button a_hover";E.onclick=A}}}function toggleCheckBox(A){if(A.checked){A.value="true"}else{A.value="false"}}function toggleRadio(A){A.click()}function setPopUPContentSize(){var D=document.getElementById("popupContents");if(D){var B=windowSize();var C=B[0];var E=B[1];var F=getOffsetTop(D);var A=E-F-50;if(A>0){}D.style.height=A+"px";if(C>0){D.style.width=C+"px"}}}function setPopUPContentHeightWidth(){setPopUPContentSize(70)}function setPopUPContentHeightWidthBy(A,F){var E=document.getElementById("popupContents");if(E){var B=getOffsetTop(E);var D=document.body.offsetHeight-(B*F);if(D<0){D=document.body.offsetHeight-(B*F/2)}var C=document.body.offsetWidth;E.style.width=C-A;E.style.height=D}}function addObjectSearch(A){openDialogWindow("",document.MainForm.module.value,"showAddObjectSearchFrames","popupWindow",600,850,"true","","&parentTableId="+A)}function addObjectTypeKnownNumbers(B,A,D,C){handleCookie(D,C);openDialogWindow("",document.MainForm.module.value,"showAddObjectTypeKnownNumbers","popupWindow",400,470,"true","no","&parentTableId="+B+"&wizardId="+A)}function handleCookie(E,D){if(!E||!D){return}var C=readCookie("addActionConfig");var B=C.indexOf(D);if(B==-1){C+="&"+D+":"+E+"&"}else{var A=C.substring(0,B)+D+":"+E;temp=C.substring(A.length,C.length);B=temp.indexOf("&");if(B==-1){C=A}else{C=A+temp.substring(B,C.length)}}saveCookie("addActionConfig",C,1000);saveCookie("parentActionId",D,1000)}function readCookie(B){var D=B+"=";var A=document.cookie.split(";");for(var C=0;C<A.length;C++){var E=A[C];while(E.charAt(0)==" "){E=E.substring(1,E.length)}if(E.indexOf(D)==0){return E.substring(D.length,E.length)}}return""}function saveCookie(C,D,E){if(E){var B=new Date();B.setTime(B.getTime()+(E*24*60*60*1000));var A="; expires="+B.toGMTString()}else{A=""}document.cookie=C+"="+D+A+"; path=/"}function displayDiscussionObject(I,G,B,C,E,D){document.MainForm_2__.classid.value=G;document.MainForm_2__.objid.value=B;document.MainForm_2__.tabid.value=C;var H=screen.availWidth*90/100;var A=screen.availHeight*90/100;var F="BaseTableName="+E+"&refreshOnCloseOperation="+D;openDialogWindow("MainForm_2__",I,"displayObjectToPopUP","popupWindow",A,750,"true","no",F);setTimeout("resetDiscussionValues()",1000)}function displayDiscussionObjectFromAttWhereUsed(I,G,B,C,E,D){document.MainForm_2__.classid.value=G;document.MainForm_2__.objid.value=B;document.MainForm_2__.tabid.value=C;var H=screen.availWidth*90/100;var A=screen.availHeight*90/100;var F="BaseTableName="+E+"&refreshOnCloseOperation="+D;openDialogWindowFrom2ndForm("",I,"displayObjectToPopUP","popupWindow",A,750,"true","no",F);setTimeout("resetDiscussionValues()",1000)}function resetDiscussionValues(){document.MainForm_2__.classid.value=document.MainForm.classid.value;document.MainForm_2__.objid.value=document.MainForm.objid.value;document.MainForm_2__.tabid.value=document.MainForm.tabid.value}function createNewDiscussionObject(G,D,E,C){var F=getForm("");F.create_subclsid.value="";F.wizardId.value=E;F.wizardHandler.value=G;var B=screen.availWidth*60/100;var A=screen.availHeight*60/100;if(typeof(C)!="undefined"&&C!=null){F.create_subclsid.value=C}openDialogWindow("",D,"createNewObjectInPopup","popupWindow",A,B,"true","no","")}function setPageContent(C){var H=document.getElementById(C);var G=windowSize();var A=G[0];var F=G[1];var E=getOffsetTop(H);var B=F-E-100;var D=document.body.offsetWidth;H.style.width=D-50;H.style.height=B}function synchTableScrolling(A){var C=A.id.replace("Table","Header");var B=document.getElementById(C);B.scrollLeft=A.scrollLeft}function setTableViewContent(){var D=document.getElementById("scrollTableDiv");var E=document.getElementById("scrollHeaderDiv");if(D){var I=windowSize();var F=I[0];var A=I[1];var H=getOffsetTop(D);var J=A-H-46;J=J>0?J:0;var B=0;var K=0;hasToScroll=false;var C=0;for(var G=0;G<D.childNodes.length;G++){if(D.childNodes[G].tagName=="TABLE"){C++;B=B+D.childNodes[G].offsetHeight;if(K<D.childNodes[G].offsetWidth){K=D.childNodes[G].offsetWidth}}if(B>J-tableViewOffsetHeight){hasToScroll=true;break}}F=F-16;if(K>F){B=B+17}else{B=B+2;if(C==1){B=B+17}}if(F>0){D.style.width=F}if(hasToScroll){D.style.height=J-tableViewOffsetHeight}else{D.style.height=B}if(E){E.style.width=D.style.width}}}function setPopUpTableViewContent(){var D=document.getElementById("scrollTableDiv");var E=document.getElementById("scrollHeaderDiv");if(D){var I=windowSize();var F=I[0];var B=I[1];var H=getOffsetTop(D);var A=document.getElementsByName("pageViewContent")?95:75;var J=B-H-A;J=J>0?J:0;var C=0;var K=0;hasToScroll=false;for(var G=0;G<D.childNodes.length;G++){if(D.childNodes[G].tagName=="TABLE"){C=C+D.childNodes[G].offsetHeight;if(K<D.childNodes[G].offsetWidth){K=D.childNodes[G].offsetWidth}}if(C>J-tableViewOffsetHeight){hasToScroll=true;break}}F=F-16;if(K>F){C=C+17}else{C=C+2}D.style.width=F;if(hasToScroll){D.style.height=J-tableViewOffsetHeight}else{D.style.height=C}if(E){E.style.width=D.style.width}}}function setPageViewContent(G){if(G==null){G=0}if(G==1){obj=document.getElementById("LeftPane");if(obj!=null){G=obj.offsetWidth+70}}var E=windowSize();var C=E[0];var F=E[1];var H=document.getElementsByName("mainTable");var B=document.getElementsByName("pageViewContent");if(B!=null){for(var D=0;D<B.length;D++){if(B.item(D)){var A=C-16-G;if(A>0){B.item(D).style.width=A}}}}}function resetPageViewContent(B){var D=(B)?document.getElementById(B):document.getElementById("pageViewContent");if(!D){return}var H=2;var I=windowSize();var F=I[0];var A=I[1];if(document.getElementById("leftpane")){var C=document.getElementById("leftpane").offsetWidth;F=F-C-8}var G=getOffsetTop(D);var E=A-G-H;E=E<0?0:E;D.style.width=F+"px";D.style.height=E+"px"}function warnMSProjectSetupWindow(){if(confirm(localMsg.autoIntallPPM)){openMSProjectSetupWindow()}else{return}}function showGantApplet(){var B=800;var A=600;if(top.frames.TopPane.warnIntallPPMSetUp){if(confirm(localMsg.autoIntallPPM)){openDialogWindow("","ActivityHandler","showGanttApplet","ganttWindow",A,B,"false","no")}else{return}}else{openDialogWindow("","ActivityHandler","showGanttApplet","ganttWindow",A,B,"false","no")}}function downloadGanttJNLP(D){jwsInstalled=true;if((jwsInstalled)||(navigator.userAgent.indexOf("Gecko")!=-1)){var C=0;var B=0;if(!is_ie){newDiv=document.createElement("iframe");newDiv.style.border="0px";newDiv.style.width="0px";newDiv.style.height="0px";newDiv.frameborder="false";newDiv.id="jnlpFrame";newDiv.name="jnlpFrame";document.body.appendChild(newDiv)}else{document.body.insertAdjacentHTML("beforeEnd",'<iframe src="" name="jnlpFrame" id="jnlpFrame" style="width:20px; height:0px; border:0px" frameborder="false"></iframe>')}var A="lockMode="+D;openDialogWindow("MainForm","ActivityHandler","downloadGanttJNLP","jnlpFrame",B,C,"true","no",A)}else{window.open("http://java.sun.com/j2se/1.5.0/download.jsp");alert(localMsg.JavaPluginNotFound)}}function lauchMSP(A){document.MainForm.launchMSProjectInReadMode.value=A;openDialogWindow("MainForm","ActivityHandler","showLaunchMSProjectApplet","_New",300,600,"true","no")}function saveAsXML(B){var A="SaveAsXMLInReadMode="+B;var C={opcode:"exportActivity",xtraArgs:A};AGILE.util.Export(C)}function showLink(A,C){if(C){if(A.indexOf("&requestUrl=")!=-1){var G=A.split("&requestUrl=");A=unescape(G[1])}if(A.indexOf("&isFromNotf=")!=-1){var F="version="+getParameter(A,"version");if(getParameter(A,"classid")=="-39"){configWorkCalendar(getParameter(A,"objid"),getParameter(A,"tabid"));return}displayObject(getParameter(A,"module"),getParameter(A,"classid"),getParameter(A,"objid"),"0","","",F);return}if(opener){opener.displayObject(getParameter(A,"module"),getParameter(A,"classid"),getParameter(A,"objid"),getParameter(A,"tabid"));this.window.close()}else{displayObject(getParameter(A,"module"),getParameter(A,"classid"),getParameter(A,"objid"),getParameter(A,"tabid"))}}else{var B=screen.availWidth*70/100;var I=screen.availHeight*65/100;var D=(screen.width-B)/2;var H=(screen.height-I)/2;var E=window.open(A,"","height="+I+",width="+B+",scrollbars=yes,resizable=yes,alwaysRaised=yes,menubar=0,left="+D+",top="+H)}}function getParameter(A,B){var C=A.split("&");return parseParams(C,B)}function parseParams(D,C){for(var B=0;B<D.length;B++){if(D[B]){var A=D[B].split("=")[0];if(A==C){return D[B].split("=")[1]}}}return""}function openURLAttachment(A){window.open(A,"_new")}function viewMyActivities(){if(checkReqFiledOnChange()){return}if(isMainPageDirty()){return}if(document.reqForm.addToTrail){document.reqForm.addToTrail.value="false"}submitForm("reqForm","InboxSearchHandler","showRefreshMyActivity","RightPane","")}function viewNotifications(){if(checkReqFiledOnChange()){return}if(isMainPageDirty()){return}if(document.reqForm.addToTrail){document.reqForm.addToTrail.value="false"}submitForm("reqForm","InboxSearchHandler","displayRefreshInboxView","RightPane","")}function viewWorkflowRoutings(){if(checkReqFiledOnChange()){return}if(isMainPageDirty()){return}if(document.reqForm.addToTrail){document.reqForm.addToTrail.value="false"}submitForm("reqForm","InboxSearchHandler","showRefreshWorkflowRouting","RightPane","")}function viewActionItems(){if(checkReqFiledOnChange()){return}if(isMainPageDirty()){return}if(document.reqForm.addToTrail){document.reqForm.addToTrail.value="false"}submitForm("reqForm","InboxSearchHandler","showRefreshMyActionItems","RightPane","")}function viewMyAssignments(){if(checkReqFiledOnChange()){return}if(isMainPageDirty()){return}if(document.reqForm.addToTrail){document.reqForm.addToTrail.value="false"}submitForm("reqForm","InboxSearchHandler","showRefreshMyToDoList","RightPane","")}function viewTimeSheet(){if(checkReqFiledOnChange()){return}if(isMainPageDirty()){return}if(document.reqForm.addToTrail){document.reqForm.addToTrail.value="false"}submitForm("reqForm","InboxSearchHandler","showRefreshTimeSheet","RightPane","")}function addDiscussionByCreate(C,B){handleCookie(C,B);var A=getForm("");openDialogWindow("",A.module.value,"addDiscussion","popupWindow",600,600,"true","no")}function isPageDirty(){if(document.MainForm&&document.MainForm.isPageDirty){var A=document.MainForm.isPageDirty;return(A.value=="true"?true:false)}else{return false}}function isMainPageDirty(A,E,D){var B=isPageDirty();if(Grids.length>0){for(var C=0;C<Grids.length;C++){if(Grids[C]&&AGILE.util.isTableDirty(Grids[C],A)){B=true;break}}}if(B){if(!confirm(E||localMsg.unsavedChangeError)){return true}else{if(!D){if(document.MainForm&&document.MainForm.isPageDirty){document.MainForm.isPageDirty.value="false"}if(Grids.length>0){for(var C=0;C<Grids.length;C++){if(Grids[C]){AGILE.util.cancelTableDirty(Grids[C],A)}}}return false}}}return false}function checkDirtydisplayObject(C,D,B,A,E){displayObject(C,D,B,A,"",E,"")}function hidefirstImage(){var A=document.getElementById("testDIV");if(A){A.style.display="none"}}function showPreviewMsgs(){var elms=document.getElementsByName("previewMsg");for(var i=0;i<elms.length;i++){var objq=eval("document.getElementsByName('previewMsg').item("+i+")");if(objq.style.display==""){objq.style.display="none"}else{objq.style.display=""}}}function showElement(B){var A=document.getElementById(B);A.style.display="block"}function hideElement(A){var B=document.getElementById(A);B.style.display="none"}function updateRefDesig(E,C,B){var D=document.getElementById(C);var A;if(B){A=document.getElementById("sp_"+C)}if(E.indexOf("Error")==0){alert(E.substring(7,E.length))}else{D.value=E;if(B){A.innerHTML=B}}}function escapeRefDesigDelim(A){var B=new Array("%","!","#","$","&","*","+","-",":",";","@","^","?");var F=new Array("%25","%21","%23","%24","%26","*","%2B","-","%3A","%3B","%40","%5E","%3F");var E=A;var D=new RegExp();for(var C=0;C<B.length;C++){D=new RegExp("\\"+B[C],"g");E=E.replace(D,F[C])}return E}var cellWidthsArray=null;function resizeTableByName(E){if(document.getElementsByName(E)!=null){var C=document.getElementsByName(E);var I=new Array();var M=C.length;if(M<=1){return}for(var K=0,J=0;K<M;K++){if(C[K].rows.length>0){I[J++]=C[K]}}M=I.length;if(M<=1){return}var H=I[0].rows[0].cells.length;var L=0;var B=0;if(cellWidthsArray==null){cellWidthsArray=new Array();for(var G=0;G<H;G++){L=I[0].rows[0].cells[G].offsetWidth;for(var F=0;F<M;F++){for(var A=0;A<I[F].rows.length;A++){if(I[F].rows[A].cells[G].offsetWidth>L){L=I[F].rows[A].cells[G].offsetWidth}}}cellWidthsArray[G]=L;B=B+L}}for(var G=0;G<H;G++){if(typeof(cellWidthsArray[G])=="undefined"){break}var D=cellWidthsArray[G];for(var F=0;F<M;F++){for(var A=0;A<I[F].rows.length;A++){if(is_ie){I[F].rows[A].cells[G].style.width=D+"px"}else{I[F].rows[A].cells[G].width=D+"px"}}I[F].style.width="100%"}}}}function refreshWithNewObjectNumber(formName,sub_ClassIDName,autoNumberFieldName,autoNumberName,subClassIDName,numberFieldName,isPopup){var clickEvent=document.getElementById("123").onclick;disableButton("123");var module=eval("document."+formName+".module").value;var selectBox=eval("document."+formName+"."+sub_ClassIDName);var subclassId=selectBox.options[selectBox.selectedIndex].value;var param="PCMServlet?ajaxRequest=true&module="+module+"&opcode=getAutoNumberValue&"+autoNumberFieldName+"="+autoNumberName+"&"+subClassIDName+"="+subclassId+"&popup="+isPopup;var callBackArgs=new Array();callBackArgs[0]=formName;callBackArgs[1]=numberFieldName;sendAJAXRequest(param,setNewObjectNumber,true,null,callBackArgs);enableButton("123",clickEvent)}function setNewObjectNumber(response,callBackArgs){if(response.success){var responseObject=eval("("+response.text+")");var success=responseObject.AutoNumberInfo[0].success;if(success=="true"){eval("document."+callBackArgs[0]+"."+callBackArgs[1]).value=responseObject.AutoNumberInfo[0].nextAutoNumber;var dms_div=document.getElementById("dms");if(dms_div&&dms_div.className=="message error"){AGILE.util.DMS.clearMessage()}}else{AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,responseObject.AutoNumberInfo[0].nextAutoNumber)}dialogs.resize()}}function removeObjectOnCancel(formName,subclassId,number){var sctr=new Date().getTime();var module=eval("document."+formName+".module").value;var xmlhttp=xmlRequest();xmlhttp.open("GET","PCMServlet?ajaxRequest=true&popup=true&module="+module+"&opcode=deleteObjectOnCancel&number="+number+"&subclsid="+subclassId+"&ctr="+sctr,true);xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){xmlhttp.responseText;return true}};xmlhttp.send(null)}function scrollSelect(A){if(event.wheelDelta>=120){A.doScroll("scrollbarUp")}else{if(event.wheelDelta<=-120){A.doScroll("scrollbarDown")}}}function limitMozillaScroll(E,A){var D=document.getElementById(A);var C=getScrollWidth();var B=D.offsetWidth-(E.offsetWidth);if(E.scrollLeft>=B){E.scrollLeft=B}}function scrollOptionIntoView(G,D){var C=getScrollWidth();var F=G.offsetHeight/G.options.length;var E=F*(G.selectedIndex);var A=F*(G.selectedIndex+1);var B=document.getElementById(D);if(A>(B.offsetHeight-C+B.scrollTop)){B.scrollTop=A-B.offsetHeight+C}else{if(E<B.scrollTop){B.scrollTop=E}}}function getScrollWidth(){var A;var C=document.createElement("div");C.style.height=100;C.style.width=100;C.style.overflow="scroll";var B=document.createElement("div");B.style.height="100%";B.style.width="100%";document.body.appendChild(C);C.appendChild(B);A=C.offsetWidth-B.offsetWidth;document.body.removeChild(C);return A}function adjustSelectElms(D,B){var C=document.getElementById(D);var E=document.getElementById(B);var A=E.offsetWidth;if(is_ie){A-=(getScrollWidth())}if(C.offsetWidth<A){C.style.width=A;E.style.overflow="hidden"}else{E.style.overflow="scroll"}}function displayObjectInOpener(B,G,J,A,H,D){var E=parent.opener;E.focus();var I=E.document.forms[1];I.module.value=B;I.opcode.value="displayObject";I.classid.value=G;I.objid.value=J;I.tabid.value=A;if(H!=null){if(I.revchangeclass!=null){I.revchangeclass.value=H;I.revchangeid.value=D}else{var F=I.objid.parentNode;var C=E.document.createElement("input");C.type="hidden";C.name="revchangeclass";C.value=H;F.appendChild(C);C=E.document.createElement("input");C.type="hidden";C.name="revchangeid";C.value=D;F.appendChild(C)}}I.target.value="RightPane";I.popup.value="";I.submit()}function confirmBeforeRemove(A,G,F,C){var D=getSelectedCountInCurrentPage(C);var B=parseInt(document.getElementById("selectedItems_"+C).value);var E=B-D;var H="";if(B==0){alert(localMsg.removeSelectRow);return}if(confirm(H)){submitForm("",A,G,F)}}function getSelectedCountInCurrentPage(A){var C=getRowMap(A);var B=0;for(i=1;i<C.length;i++){if(C[i].isSelected&&C[i].considerForSelectedCount){B++}}return B}function copyToClipboard(A){if(window.clipboardData){window.clipboardData.setData("Text",A)}return false}function removeMultiSpaces(C){var B=/[\s][\s]+/;var A=/^[\s].*[\s]$/;var E=/.*[\s]$/;var D=/^[\s].*$/;while(B.test(C.value)){C.value=C.value.replace(/[\s][\s]+/," ")}if(A.test(C.value)){C.value=C.value.substr(1,(C.value.length-2))}if(E.test(C.value)){C.value=C.value.substr(0,C.value.length-1)}if(D.test(C.value)){C.value=C.value.substr(1,C.value.length)}}function confirmRemoveProject(){var A=new Array();if(confirm(localMsg.removeProject)){displayContent({opcode:"closeProject"},A.join(""),"MainForm")}}function showPersonalizeWidgetConfig(){submitForm("MainForm","ActivityHandler","loadPersonalizeWidgetConfig","RightPane","")}function showActivitySummaryPage(){if(isMainPageDirty()){return}displayContent({containerToUpdate:RIGHTPANECONTENT,module:"ActivityHandler",opcode:"showActivitySummaryPage"},"","MainForm")}function encodeToHex(C){var A="";for(var B=0;B<C.length;B++){if(C.charAt(B)=="&"){A+="\\x26"}else{if(C.charAt(B)=="="){A+="\\x3D"}else{if(C.charAt(B)=="/"){A+="\\x2F"}else{if(C.charAt(B)=='"'){A+="\\x22"}else{if(C.charAt(B)=="#"){A+="\\x23"}else{A+=C.charAt(B)}}}}}}return A}var dirtyMfrParts=new Array();var dMpRowIndex="0";var dMpClass="";var dMfrNameField="";var dMfrPartField="";var dAMLrowKey="";var clickTgtElem=null;var clickBtnElem=null;var currentRowIndex="-1";var isctrlheld=false;var AMLStatus=new Array();var MFRValidatedStatus=0;var MFRFieldModifiedStatus=0;var MFRPartModified=0;var AML_canICreateManufacturer="true";var AML_canICreateMfrPart="true";var saveStatus=0;function findObjectByKey(formName,isDual,objClass,mfrFldName,mfrPartFldName){var fldObj=eval("document."+formName+"."+mfrFldName);var fldDspObj=eval("document."+formName+"."+mfrFldName+"_display");SearchObjectByKey(formName,isDual,objClass,mfrFldName,mfrPartFldName,true)}function SearchObjectByKey(formName,isDual,objClass,mfrFldName,mfrPartFldName,isOnBlur){var secs=new Date().getTime();if(clickTgtElem!=null){clickTgtElem=null;return}if(clickBtnElem!=null&&isOnBlur){var currRowKey=clickBtnElem.id;if(clickBtnElem.id=="ValidateButton"){currRowKey=clickBtnElem.childNodes[0].id}currRowKey=currRowKey.substring(currRowKey.indexOf("_")+1);var onBlurRowKey=dAMLrowKey.substring(dAMLrowKey.indexOf("_")+1);if(currRowKey==onBlurRowKey||onBlurRowKey==""){return}clickBtnElem=null}if(clickBtnElem){if(clickBtnElem.innerHTML.indexOf("validate_disabled.gif")>0||(clickBtnElem.src&&clickBtnElem.src.indexOf("validate_disabled.gif")>0)){clickBtnElem=null;return}}if(clickBtnElem!=null){clickBtnElem=null}if(MFRValidatedStatus==2){return}var module=eval("document."+formName+".module").value;var fldObj=eval("document."+formName+"."+mfrFldName);var fldDspObj=eval("document."+formName+"."+mfrFldName+"_display");var fldInitialObj=eval("document."+formName+"."+mfrFldName+"_initial");var isCreateAddPopUp=eval("document."+formName+".popup").value;if(MFRFieldModifiedStatus==0&&(isOnBlur||fldObj.value!="")){if(isCreateAddPopUp=="true"&&fldDspObj&&fldDspObj.className=="cal-TextBoxInvalid"){}else{return}}MFRValidatedStatus=3;var objectKey="";if(isDual){objectKey=escapeRefDesigDelim(fldDspObj.value)}else{objectKey=escapeRefDesigDelim(fldObj.value)}showProcessLayer("myWaitLayer");toggleSelects("hidden");var xmlhttp=xmlRequest();xmlhttp.open("POST","PCMServlet",false);xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp.send("ajaxRequest=true&module="+module+"&opcode=findObjectByKey&popup=true&objectClass="+objClass+"&objectKey="+objectKey+"&ctr="+secs);if(xmlhttp.readyState==4){var responeTxt=xmlhttp.responseText;if(responeTxt.indexOf("Error")==0){alert(responeTxt.substring(7,responeTxt.length));return}else{if(responeTxt.indexOf("ExactMatch")==0){setMFRValid();fldObj.className="formElm";var manufacturer=responeTxt.substring(responeTxt.indexOf("@#$*^")+5);fldObj.value=manufacturer;if(isDual){fldDspObj.value=manufacturer;fldDspObj.className="formElm"}else{fldInitialObj.value=manufacturer}toggleValidateImage(true)}else{setMFRInvalid();fldObj.className="cal-TextBoxInvalid";if(fldDspObj){fldDspObj.className="cal-TextBoxInvalid"}var addlParam=eval("document."+formName+".addlParam").value;addlParam=addlParam+"&objectClass="+objClass+"&objectKey="+objectKey+"&attr_name="+mfrFldName+"&mfrPartFieldName="+mfrPartFldName+"&isDual="+isDual+"&isSearch=false&AMLRowKey="+dAMLrowKey;var elems=document.getElementsByName("IsFromCreatePopup");if(elems!=null&&elems[0]!=null){addlParam=addlParam+"&IsFromCreatePopup="+elems[0].value}addlParam+=("&callbackOfOpener=callbackFromChild");openDialogWindow(formName,module,"searchMFRByKey","_New",450,550,"true","no",addlParam)}}}hideProcessLayer("myWaitLayer");toggleSelects("visible")}function clearSessionforPopup(){var A=document.MainForm.module.value;var C=new Date().getTime();var B=xmlRequest();B.open("GET","PCMServlet?ajaxRequest=true&module="+A+"&opcode=clearSessionForAMLValidationPopup&popup=true&ctr="+C,true);B.onreadystatechange=function(){};B.send(null)}function showProcessLayer(B){var A=(navigator.vendor==("Netscape6")||navigator.product==("Gecko"));var C=document.getElementById(B);if(A){C.style.left=(document.body.offsetWidth-200)/2+window.scrollX;C.style.top=(document.body.offsetHeight-150)/2+window.scrollY}else{C.style.posLeft=(document.body.offsetWidth-200)/2+document.body.scrollLeft;C.style.posTop=(document.body.offsetHeight-150)/2+document.body.scrollTop}C.style.visibility="visible"}function hideProcessLayer(A){var B=document.getElementById(A);B.style.visibility="hidden"}function toggleSelects(B){var C=document.getElementsByTagName("SELECT");for(var A=0;A<C.length;A++){C[A].style.visibility=B}}function saveMfrRows(){if(dMfrNameField!=""&&dMfrPartField!=""){saveStatus=1;isExistsMFRPartByNameKey("MainForm",dMfrNameField,dMpClass,dMfrPartField,dMpRowIndex,dAMLrowKey,"true");if(saveStatus==2){saveStatus=0;return}saveStatus=0}if(isPageLoading){alert(localMsg.Page_Not_Loaded_Wait);return}setTimeout("actualSaveMfrRows()",500)}function actualSaveMfrRows(){if(dMpRowIndex!=0){while(1){if(AMLStatus[dMpRowIndex]==2){return}if(AMLStatus[dMpRowIndex]==3){break}if(AMLStatus[dMpRowIndex]==0){return}}}if(AMLStatus[dMpRowIndex]==3||dMpRowIndex==0){var B=true;for(var A=1;A<=AMLStatus.length;A++){if(AMLStatus[A]==2){B=false;alert(localMsg.JSP_Edit_AML_Error);break}}if(B){submitForm("MainForm","","updateMultipleRows","RightPane")}}}function highlightInvalidRows(){for(var D=1;D<=AMLStatus.length;D++){var E=document.getElementsByTagName("input");for(var A=0;A<E.length;A++){if(E[A].type=="text"){var C="R"+D;var B=E[A].id.split("_");if(B[0]==C&&AMLStatus[D]==2){E[A].className="cal-TextBoxInvalid"}}}}}function setAMLInvalid(A){AMLStatus[A]=2}function setAMLValid(A){AMLStatus[A]=3}function setMFRInvalid(){MFRValidatedStatus=1}function setMFRValid(){MFRValidatedStatus=2;if(document.MainForm.isMfrValid){document.MainForm.isMfrValid.value="true"}}function setMfrEdited(event,rowIndex,objClass,mfrFieldName,mfrPartFieldName,rowKey){dMpRowIndex=rowIndex;dMpClass=objClass;dMfrNameField=mfrFieldName;dMfrPartField=mfrPartFieldName;dAMLrowKey=rowKey;AMLStatus[rowIndex]=0;var mfrField=eval("document.MainForm."+mfrFieldName+"_display");event=invo.event.getEvent(event);if(event.keyCode==17){isctrlheld=true;return}if(isctrlheld&&event.keyCode==67){return}if(event.keyCode==13){return}if(event.keyCode!=9||(mfrField&&mfrField.value=="")){MFRFieldModifiedStatus=1;MFRValidatedStatus=0;toggleValidateImage(false)}}function setMfrFieldModified(A){}function setMfrPartEdited(E,B,A,C,D){dMpRowIndex=E;dMpClass=B;dMfrNameField=A;dMfrPartField=C;dAMLrowKey=D;AMLStatus[E]=0;MFRPartModified=1}function mfrPartValidated(A){dMpClass="";dMfrNameField="";dMfrPartField=""}function validateDirtyMfrPart(A){currentRowIndex=A;if(A!=dMpRowIndex&&AMLStatus[dMpRowIndex]==0){isExistsMFRPartByNameKey("MainForm",dMfrNameField,dMpClass,dMfrPartField,dMpRowIndex,dAMLrowKey,"true")}else{return true}}function isExistsMFRPartByNameKey(E,C,D,A,G,F,B){tmpformName=E;tmpmfrName=C;tmpobjClass=D;tmpmpnName=A;tmprowIndex=G;tmprowKey=F;existsMFRPartByNameKey()}function existsMFRPartByNameKey(){var secs=new Date().getTime();if(clickTgtElem!=null){clickTgtElem=null;return}if(MFRFieldModifiedStatus==1&&MFRValidatedStatus==0){setTimeout("existsMFRPartByNameKey()",200);return}if(MFRFieldModifiedStatus==1&&MFRValidatedStatus==1){if(saveStatus==1){saveStatus=2}return}if(MFRFieldModifiedStatus==1&&MFRValidatedStatus==3){setTimeout("existsMFRPartByNameKey()",200);return}if(AMLStatus[tmprowIndex]!=0){return}var module=eval("document."+tmpformName+".module").value;var objKey=tmpobjClass;var mfr=eval("document."+tmpformName+"."+tmpmfrName+"_display").value;var mpn=eval("document."+tmpformName+"."+tmpmpnName+"_display").value;if(mpn==""){if(MFRPartModified==0){return}MFRPartModified=0;alert(localMsg.MFRPart_Empty);var previousMpn=eval("document."+tmpformName+"."+tmpmpnName).value;eval("document."+tmpformName+"."+tmpmpnName+"_display").value=previousMpn;if(saveStatus==1){saveStatus=2}return}var initialMpn=eval("document."+tmpformName+"."+tmpmpnName);var escapedMfr=escapeRefDesigDelim(mfr);var escapedMpn=escapeRefDesigDelim(mpn);var registeredTableNames=document.MainForm.registeredTableNames.value;AMLStatus[tmprowIndex]=1;var xmlhttp=xmlRequest();xmlhttp.open("POST","PCMServlet",false);xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp.send("ajaxRequest=true&module="+module+"&opcode=isExistsObject&popup=true&objectClass="+objKey+"&mfrKey="+escapedMfr+"&mpnKey="+escapedMpn+"&AMLRowKey="+tmprowKey+"&tableId=9&registeredTableNames="+registeredTableNames+"&ctr="+secs);if(xmlhttp.readyState==4){var responeTxt=xmlhttp.responseText;if(responeTxt.indexOf("Error")==0){setAMLInvalid(tmprowIndex);var mfrNameString=mpn+" ("+mfr+") ";if(AML_canICreateMfrPart=="true"||AML_canICreateMfrPart=="true"){var isCreate=confirm(localMsg.MFR_Match_Not_Found1+" "+mfrNameString+localMsg.MFR_Match_Not_Found2);if(isCreate){var addlParam="&subClassId="+tmpobjClass+"&manufacturername="+escapedMfr+"&number="+escapedMpn+"&parentTableId=9&wizardId=3&isFromEditAML="+true+"&fieldName="+tmpmpnName+"&MFRFieldName="+tmpmfrName+"&AMLRowKey="+tmprowKey+"&AMLRowIndex="+tmprowIndex;openDialogWindow("MainForm",document.MainForm.module.value,"showAddObjectCreateNew","_New",450,550,"true","no",addlParam)}else{setOriginalValuesToOpener(tmprowIndex,9,tmpmfrName,tmpmpnName,tmprowKey);var elemId=tmpmpnName+"_display";var redlineMpn=document.getElementById("sp_"+elemId);if(redlineMpn&&redlineMpn.innerHTML==initialMpn.value){redlineMpn.style.display="none"}if(saveStatus==1){saveStatus=2}}}else{var isSearch=confirm(localMsg.MFR_Match_Not_Found1+" "+mfrNameString+localMsg.MFR_Match_Not_Found2_Search);if(isSearch){var button=document.getElementById("btn"+tmprowKey);button.click()}else{setOriginalValuesToOpener(tmprowIndex,9,tmpmfrName,tmpmpnName,tmprowKey);var elemId=tmpmpnName+"_display";var redlineMpn=document.getElementById("sp_"+elemId);if(redlineMpn&&redlineMpn.innerHTML==initialMpn.value){redlineMpn.style.display="none"}if(saveStatus==1){saveStatus=2}}}}else{eval("document.MainForm."+tmpmpnName+"_display").className="formElm";initialMpn.value=mpn;setAMLValid(tmprowIndex)}}}function setOriginalValuesToOpener(rowIndex,tableId,mfrFieldName,mpnFieldName,rowKey){var secs=new Date().getTime();var module=document.MainForm.module.value;var registeredTableNames=document.MainForm.registeredTableNames.value;if(rowKey==""){return}var xmlhttp=xmlRequest();xmlhttp.open("POST","PCMServlet",false);xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp.send("ajaxRequest=true&module="+module+"&opcode=getOriginalAML&rowIndex="+rowIndex+"&tableId="+tableId+"&registeredTableNames="+registeredTableNames+"&AMLRowKey="+rowKey+"&popup=true&ctr="+secs);if(xmlhttp.readyState==4){var originalAML=xmlhttp.responseText;var mfr=originalAML.substr(0,originalAML.indexOf("@#$*^"));var mpn=originalAML.substr(originalAML.indexOf("@#$*^")+5);var mpnfldDspObj=eval("document.MainForm."+mpnFieldName+"_display");if(mpnfldDspObj){mpnfldDspObj.value=mpn}else{eval("document.MainForm."+mpnFieldName+"_initial").value=mpn}eval("document.MainForm."+mpnFieldName).value=mpn;var mpnfldDspObj=eval("document.MainForm."+mfrFieldName+"_display");if(mpnfldDspObj){mpnfldDspObj.value=mfr}eval("document.MainForm."+mfrFieldName).value=mfr;setAMLValid(dMpRowIndex);var elemId=mpnFieldName+"_display";var redlineMpn=document.getElementById("sp_"+elemId);if(redlineMpn&&redlineMpn.innerHTML==mpn){redlineMpn.style.display="none"}var mfrelemId=mfrFieldName+"_display";var redlineMfr=document.getElementById("sp_"+mfrelemId);if(redlineMfr&&redlineMfr.innerHTML==mfr){redlineMfr.style.display="none"}}}function closeAlertWindow(){document.getElementById("alertDiv").style.visibility="hidden";unhideSelectElements(document.forms[0].name)}function confirmAlertWindow(){disableAllButtons(document.forms[0].name);closeAlertWindow();postCloseAlertWindow()}function postCloseAlertWindow(){}function confirmWarnWindow(){disableAllButtons(document.forms[0].name);closeAlertWindow();postConfirmAlertWindow()}function postConfirmAlertWindow(){}function showAlertWindow(){var B=(screen.width-900)/2;var A=(screen.height-500)/2;document.getElementById("alertDiv").style.visibility="visible";document.getElementById("alertDiv").style.top=A;document.getElementById("alertDiv").style.left=B;hideSelectElements(document.getElementById("alertDiv").id,document.forms[0].name)}function saveWindowSize(D){var A=windowSize();var B=A[0];var C=A[1];saveCookie(D,B+":"+C,1000)}function checkReqFiledOnChange(){}function setupTrackActiveElements(){if(!is_ie){var D=document.body.getElementsByTagName("*");for(var C=0;C<D.length;C++){if(D[C].focus!=undefined){var B="document.activeElement = this;";var A=D[C].getAttribute("onfocus");if(A){B+=A}D[C].onfocus=new Function("event",B)}}}}function saveCheckBoxSetting(B,A){saveCookie(A,B.checked,1000)}function showSearchResultsInNavigator(){var params="";var baseClassElem=document.getElementById("selectA");var searchInput=document.getElementById("quickSerachInput");if(baseClassElem&&searchInput){params="quickSearchSelectionObject="+baseClassElem.value+"&QUICKSEARCH_STRING="+searchInput.value}showDataInNavDrawer("LeftPaneHandler","showSearchResultsInNavigator",eval("document."+SearchFormName+".classid.value"),eval("document."+SearchFormName+".objid.value"),false,params)}function showWorkflowRoutingsInNavigator(){showDataInNavDrawer("LeftPaneHandler","showWorkflowRoutingsInNavigator",0,0,false,null)}function loadApprovePage(formname,params){if(isMainPageDirty()){return}if(typeof(formname)=="undefined"){formname="MainForm"}if(typeof(params)=="undefined"){params=""}var module=eval("document."+formname+".module").value;openDialogWindow(formname,module,"loadApprovePage","SaveSearchPopup",575,660,"true","true",params)}function loadAcknowledgePage(formname,params){if(isMainPageDirty()){return}if(typeof(formname)=="undefined"){formname="MainForm"}if(typeof(params)=="undefined"){params=""}var module=eval("document."+formname+".module").value;openDialogWindow(formname,module,"loadAcknowledgePage","SaveSearchPopup",575,660,"true","true",params)}function loadRejectPage(qvFormName){if(isMainPageDirty()){return}if(typeof(formname)=="undefined"){formname="MainForm"}if(typeof(params)=="undefined"){params=""}var module=eval("document."+formname+".module").value;openDialogWindow(formname,module,"loadRejectPage","SaveSearchPopup",575,660,"true","true",params)}function saveAsActivity(){if(isMainPageDirty()){return}openDialogWindow("MainForm","ActivityHandler","saveAsActivityObject","SaveSearchPopup",480,720,"true","true","")}function showSaveAsDialogForPrice(){if(isMainPageDirty()){return}openDialogWindow("MainForm","PriceHandler","saveAs","SaveSearchPopup",545,600,"true","true","")}function showSaveAsDialog(A){if(isMainPageDirty()){return}if(A!=null){openDialogWindow("MainForm",A,"saveAs","SaveSearchPopup",450,560,"true","true","")}else{openDialogWindow("MainForm","SaveAsHandler","saveAs","SaveSearchPopup",450,560,"true","true","")}}function showSaveAsDialogForProject(){if(isMainPageDirty()){return}openDialogWindow("MainForm","SaveAsProjectHandler","saveAs","SaveSearchPopup",450,560,"true","true","")}function saveAsUserObject(){if(isMainPageDirty()){return}openDialogWindow("MainForm","UserObjectHandler","displaySaveAsObject","SaveSearchPopup",450,560,"true","true","")}function deleteObject(extraArgs){var module=eval("document.MainForm.module").value;var classId=eval("document.MainForm.classid").value;var objId=eval("document.MainForm.objid").value;var param="PCMServlet?ajaxRequest=true&module="+module+"&opcode=callDeleteObject&classid="+classId+"&objid="+objId+"&popup=false";if(extraArgs!=null){param=param+extraArgs}sendAJAXRequest(param,showDeleteWarning,true,null,{extraArgs:extraArgs})}function showDeleteWarning(response,args){var hasAuditErrors=response.thisConn.getResponseHeader("hasEW")!=null&&response.thisConn.getResponseHeader("hasEW")!="";if(hasAuditErrors){eval(response.text);return}var errorObject=eval("("+response.text+")");var success=errorObject.WarnInfo[0].success;var param="";if(success!="true"){var isWarning=errorObject.WarnInfo[0].IsWarn;if(isWarning=="true"){var classId=eval("document.MainForm.classid").value;var objId=eval("document.MainForm.objid").value;var module=eval("document.MainForm.module").value;var warnId="delobj_"+classId+"_"+objId+";";var errorId=errorObject.WarnInfo[0].WarnID;param="&pgWarnID="+warnId+"&pgWarnCode="+errorId+";";if(args.extraArgs!=null){param=param+"&"+args.extraArgs}if(confirm(errorObject.WarnInfo[0].WarnMsg)){deleteObject(param)}}else{AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,errorObject.WarnInfo[0].WarnMsg)}}else{var isSoftDeleted=errorObject.WarnInfo[0].isSoftDeleted;if(errorObject.WarnInfo[0].parentClassId!=null&&errorObject.WarnInfo[0].parentObjId!=null){var parentClassID=errorObject.WarnInfo[0].parentClassId;var parentObjID=errorObject.WarnInfo[0].parentObjId;param="&parentClassId="+parentClassID+"&parentObjId="+parentObjID}param=param+"&isSoftDeleted="+isSoftDeleted+"&";markRecentlyForRefresh=true;markBookmarksForRefresh=true;var tree=YAHOO.widget.TreeView.getTree("ctxNavTree");if(tree!=null){var nav_classId=tree._classId;var nav_objId=tree._objectId;var classId=eval("document.MainForm.classid").value;var objId=eval("document.MainForm.objid").value;if(nav_classId==classId&&nav_objId==objId){resetCtxNavTree()}else{markNavigationForRefresh=true}}displayContent({opcode:"afterDeleteObject",containerToUpdate:RIGHTPANECONTENT},param,"MainForm")}}AGILE.grid.HandleDeleteObjectAudtiException=function(A){postHandleDeleteObjectAudtiException(A)};function postHandleDeleteObjectAudtiException(A){deleteObject("&PRE_AUDIT_DONE=true")}function undeleteObject(extraArgs){var module=eval("document.MainForm.module").value;var classId=eval("document.MainForm.classid").value;var objId=eval("document.MainForm.objid").value;var param="PCMServlet?ajaxRequest=true&module="+module+"&opcode=unDeleteObject&classid="+classId+"&objid="+objId+"&popup=false";if(extraArgs!=null){param=param+extraArgs}sendAJAXRequest(param,showUnDeleteWarning,true)}function showUnDeleteWarning(response){if(response.success){var errorObject=eval("("+response.text+")");var success=errorObject.WarnInfo[0].success;var param="";if(success!="true"){var isWarning=errorObject.WarnInfo[0].IsWarn;if(isWarning=="true"){var classId=eval("document.MainForm.classid").value;var objId=eval("document.MainForm.objid").value;var module=eval("document.MainForm.module").value;var warnId="undelobj_"+classId+"_"+objId+";";var errorId=errorObject.WarnInfo[0].WarnID;param="&pgWarnID="+warnId+"&pgWarnCode="+errorId+";";if(confirm(errorObject.WarnInfo[0].WarnMsg)){undeleteObject(param)}}else{AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,errorObject.WarnInfo[0].WarnMsg)}}else{markRecentlyForRefresh=true;markBookmarksForRefresh=true;displayContent({opcode:"displayObject",containerToUpdate:RIGHTPANECONTENT},"","MainForm")}}}function showErrWarDetailPopUp(A){openDialogWindow("MainForm",document.MainForm.module.value,"showErrWarDetailPopUp","popupWindow",400,545,"true","no","&layoutType="+A)}function ShowExportDialog(){var module=eval("document.MainForm.module").value;openDialogWindow("MainForm",module,"export","ExportPopup",600,875,"true","true","")}function postSaveView(A,B){if(A.text.indexOf("Error:")!=-1){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,A.text.substring(7))}else{AGILE.util.DMS.setMessage(AGILE.util.DMS.INFO,A.text);markPaletteForSaveAs(false);refreshViewList(B.gridID,B.reloadGrid)}}var viewsProperties=new Array();function refreshViewList(gridID,reloadGrid){var sctr=new Date().getTime();var manager=new AGILE.util.RequestManager(function(result){var json=result;var dataSet=(json?eval("("+json+")"):{});var viewSelectObj=Dom.get("TABLE_VIEWS_LIST_"+dataSet.tableID);viewSelectObj.innerHTML="";viewsProperties[dataSet.tableID]=new Array();var viewsList=dataSet.ViewListData;for(var index=0;index<viewsList.length;index++){var id=(viewsList[index].id).htmlToText();var name=(viewsList[index].name).htmlToText();var isSelected=(viewsList[index].selected).htmlToText();var canIModify=(viewsList[index].canIModify).htmlToText();var subClassLevelView=(viewsList[index].classLevelView).htmlToText();viewsProperties[dataSet.tableID][id]=canIModify;viewsProperties[dataSet.tableID][id+"_classLevelInfo"]=subClassLevelView;viewSelectObj[index]=new Option(name,id);if(isSelected=="true"){viewSelectObj[index].selected=true;toggleDeleteMenu(gridID,(canIModify=="false"));toggleSetAsDefaultClassMenu(gridID,(subClassLevelView=="true"))}}if(typeof(reloadGrid)!="undefined"&&reloadGrid==true){AGILE.util.refreshGrid(gridID,true,{opcode:"reloadGrid"},"",AGILE.util.renderGrid,{gridID:gridID})}});var frm=getForm("MainForm");var uri=[];uri[uri.length]="PCMServlet?ctr="+sctr;uri[uri.length]="&ajaxRequest=true";uri[uri.length]="&module="+frm.module.value;uri[uri.length]="&opcode=getViewList";uri[uri.length]="&GRID_CTX_NAME="+gridID;manager.sendRequest("GET",uri.join(""),null)}function manageViewAction(A){tablePaletteInit(A);toggleSaveAsMenu(A,true)}var viewMenuIds=new Array();function toggleSaveAsMenu(B,A){var D=viewMenuIds[B];if(D){var C=menuObjArr["arMenu"+D+"_obj"];if(!C||C.getItems().length==0){actionsMenu["arMenu"+D][0][1].disabled=A}else{C.getItems()[1].cfg.setProperty("disabled",A)}}}function toggleDeleteMenu(B,A){var D=viewMenuIds[B];var C=menuObjArr["arMenu"+D+"_obj"];if(!C||C.getItems().length==0){actionsMenu["arMenu"+D][0][2].disabled=A}else{C.getItems()[2].cfg.setProperty("disabled",A)}}function toggleSetAsDefaultClassMenu(B,A){var D=viewMenuIds[B];var C=menuObjArr["arMenu"+D+"_obj"];if(!C||C.getItems().length==0){if(actionsMenu["arMenu"+D][0][4]!=null){actionsMenu["arMenu"+D][0][4].disabled=A}else{actionsMenu["arMenu"+D][0][3].disabled=A}}else{if(C.getItems()[4]!=null){C.getItems()[4].cfg.setProperty("disabled",A)}else{C.getItems()[3].cfg.setProperty("disabled",A)}}}function saveAsViewAction(A){destoryTablePalette();tablePaletteInitForSaveAs(A,true);toggleSaveAsMenu(A,true)}function deleteViewAction(A,B){if(Grids[A]&&AGILE.util.isTableDirty(Grids[A])){AGILE.util.DMS.clearMessage();setTimeout(function(){AGILE.util.DMS.showInfoMessage(localMsg.TableDirtyDeletePersonalization)},250);return}var C=getForm("MainForm");var F=document.getElementById("TABLE_VIEWS_LIST_"+B);var E=F.options[F.selectedIndex].text;var D="module="+C.module.value+"&GRID_CTX_NAME="+A+"&opcode=deleteTableView&classid="+C.classid.value+"&subclsid="+C.subclsid.value+"&objid="+C.objid.value+"&tabid="+C.tabid.value;if(C.revchangeclass&&C.revchangeid){D+="&revchangeclass="+C.revchangeclass.value;D+="&revchangeid="+C.revchangeid.value}D+="&forwardToPage=false&ajaxRequest=true";sendAJAXRequest(D,postDeleteTableView,false,null,{gridID:A,viewName:E})}function setAsDefaultViewAction(B,D,C,A){var E=getForm("MainForm");var H=document.getElementById("TABLE_VIEWS_LIST_"+D);var G=H.options[H.selectedIndex].text;var F="module="+E.module.value+"&GRID_CTX_NAME="+B+"&opcode=setAsDefaultView&classid="+E.classid.value+"&subclsid="+E.subclsid.value+"&tableId="+D+"&objid="+E.objid.value+"&tabid="+E.tabid.value+"&forwardToPage=false&ajaxRequest=true&applyToSubClass="+C;sendAJAXRequest(F,postSetAsDefaultTableView,false,null,{gridID:B,viewName:G,actionName:A})}function postDeleteTableView(B,C){if(B.text.length>0){if(B.text.indexOf("Error:")!=-1){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,B.text.substring(7))}else{var D=String.format(localMsg.tableview_deleted_success,C.viewName);AGILE.util.DMS.setMessage(AGILE.util.DMS.INFO,D);refreshViewList(C.gridID);if(B.text.substring(0,10).indexOf("treegrid")!=-1){document.getElementById(getGridDivId(C.gridID)).innerHTML+=B.text;var A=document.getElementById(getGridDivId(C.gridID)).innerHTML;clearGrid(C.gridID);document.getElementById(getGridDivId(C.gridID)).innerHTML=A;try{StartTreeGrid()}catch(E){}}}}}function postSetAsDefaultTableView(A,B){if(A.text.length>0){if(A.text.indexOf("Error:")!=-1){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,A.text.substring(7))}else{AGILE.util.DMS.setMessage(AGILE.util.DMS.INFO,localMsg.table_view+" "+B.viewName+" "+localMsg.is+" "+B.actionName)}refreshViewList(B.gridID)}}function loadShareDialog(A){openDialogWindow("MainForm",A,"loadShareDialog","SaveSearchPopup",450,660,"true","true","")}function stopEventNavigation(A){YAHOO.util.Event.stopEvent(A)}function selectTableView(E,B,I,A){if(E==null||E.value.length==0){return}closeTablePalette();destoryTablePalette();Grids[B]["CurrentPage"]=0;var D=E.options[E.selectedIndex].value;var H=getForm("MainForm");var J=H.subTabId.value;var C=[];var F=[{name:"opcode",value:"loadSelectedTableView"}];var G=AGILE.util.replacePageURLParam(B,F);C[C.length]=G;C[C.length]="&IGNORE_BACK_FORWARD=true";C[C.length]="&IGNORE_TRAIL=true";C[C.length]="&reloadGrid=true";C[C.length]="&refresh=true";C[C.length]="&tableId="+A;C[C.length]="&subTabId="+J;C[C.length]="&"+I+"="+D;if(H.revchangeclass){C[C.length]="&revchangeclass="+H.revchangeclass.value;C[C.length]="&revchangeid="+H.revchangeid.value;if(H.siteId){C[C.length]="&siteId="+H.siteId.value}}if(H.fulltabledisplay){C[C.length]="&fulltabledisplay="+H.fulltabledisplay.value}if(H.fullgridtableid){C[C.length]="&fullgridtableid="+H.fullgridtableid.value}if(typeof(Grids[B]["SelectedParentId"])!="undefined"){C[C.length]="&SELECTED_PARENT_ROWID="+Grids[B]["SelectedParentId"]}if(typeof(Grids[B]["prev_key"])!="undefined"){C[C.length]="&PREV_KEY="+Grids[B]["prev_key"]}if(typeof(Grids[B]["next_key"])!="undefined"){C[C.length]="&NEXT_KEY="+Grids[B]["next_key"]}C[C.length]="&PAGEIDX="+Grids[B]["CurrentPage"];C[C.length]="&GSaveCtxKey="+Grids[B]["SaveCtxKey"];sendAJAXRequest(C.join(""),postSelectTableView,false,null,{gridID:B,tableId:A,modifiedViewId:D})}function postSelectTableView(B,C){if(B.text.length>0){if(B.text.substring(0,10).indexOf("treegrid")!=-1){AGILE.grid.ErrorWarnings.clearDMSErrorMessage();if(document.getElementById(getGridDivId(C.gridID))){document.getElementById(getGridDivId(C.gridID)).innerHTML+=B.text;var A=document.getElementById(getGridDivId(C.gridID)).innerHTML;clearGrid(C.gridID);document.getElementById(getGridDivId(C.gridID)).innerHTML=A;try{StartTreeGrid()}catch(E){}if(C.modifiedViewId){var D=viewsProperties[C.tableId];var G=D[C.modifiedViewId];var F=D[C.modifiedViewId+"_classLevelInfo"];toggleDeleteMenu(C.gridID,(G=="false"));toggleSetAsDefaultClassMenu(C.gridID,(F=="true"))}}}}}function archive(A){var B=AGILE.grid.rowSelections[A].getSelectedCount();if(B==0){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,localMsg.checkSelections);return}submitTableActionWithCallbk(document.MainForm.module.value,"inactivateComposition",handleArchiveError,A)}function unArchive(A){var B=AGILE.grid.rowSelections[A].getSelectedCount();if(B==0){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,localMsg.checkSelections);return}submitTableActionWithCallbk(document.MainForm.module.value,"activateComposition",handleArchiveError,A)}function handleArchiveError(response,args){var json=eval("("+response.text+")");var hasErrors=json.Results[0].haswarning;var errorMsg=json.Results[0].errMsg;var relatedGrid=json.Results[0].relatedGrid;AGILE.util.DMS.clearMessage();if(hasErrors=="true"){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,errorMsg)}else{if(args&&args.gridID&&args.gridID.length>0){AGILE.util.refreshGrid(args.gridID,true,{opcode:"reloadGrid"},"",AGILE.util.renderGrid,{gridID:args.gridID})}if(relatedGrid&&relatedGrid.length>0){AGILE.util.refreshGrid(relatedGrid,true,{opcode:"reloadGrid"},"",AGILE.util.renderGrid,{gridID:relatedGrid})}AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.INFO,errorMsg)}}function correctDeclarationExceptions(A){var B=getForm("MainForm");var C=[];C[C.length]="ajaxRequest=true";C[C.length]="&module=MaterialDeclarationHandler";C[C.length]="&opcode=correctDeclarationExceptions";C[C.length]="&IGNORE_BACK_FORWARD=true";C[C.length]="&IGNORE_TRAIL=true";C[C.length]="&classid="+B.classid.value;C[C.length]="&subclsid="+B.subclsid.value;C[C.length]="&objid="+B.objid.value;C[C.length]="&objver="+B.objver.value;C[C.length]="&tabid="+B.tabid.value;if(typeof(B.revchangeid)!="undefined"){C[C.length]="&revchangeid="+B.revchangeid.value;C[C.length]="&revchangeclass="+B.revchangeclass.value}C[C.length]="&refresh=true";sendAJAXRequest(C.join(""),handleCorrectDeclarationError,false,null,{gridID:A})}function handleCorrectDeclarationError(response,args){var json=eval("("+response.text+")");var hasErrors=json.Results[0].haswarning;var errorMsg=json.Results[0].errMsg;AGILE.util.DMS.clearMessage();if(hasErrors=="true"){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,errorMsg)}else{openDataDialog("MainForm","","MaterialDeclarationHandler","correctUnknownSubstance","","","",500,600)}}function addSubLevel(A){if(Grids[A]["ReadOnly"]=="1"){AGILE.util.DMS.showInfoMessage(localMsg.Table_ReadOnly);return}var C=AGILE.grid.rowSelections[A].getSelectedCount();if(C==0){AGILE.util.DMS.showErrorMessage(localMsg.checkSelections);return}var D=getForm("MainForm");var E=[];var B=AGILE.grid.rowSelections[A].getSelections();E[E.length]="ajaxRequest=true";E[E.length]="&module=MaterialDeclarationHandler";E[E.length]="&opcode=addSubLevel";E[E.length]="&classid="+D.classid.value;E[E.length]="&subclsid="+D.subclsid.value;E[E.length]="&objid="+D.objid.value;E[E.length]="&objver="+D.objver.value;E[E.length]="&tabid="+D.tabid.value;E[E.length]="&tableId="+Grids[A]["TableId"];E[E.length]="&selectedKeys=";E[E.length]=escape(B);var F="TABLE_VIEWS_LIST_"+Grids[A]["TableId"];if(document.getElementById(F)!=null){E[E.length]="&"+F+"="+document.getElementById(F).value}if(D.revchangeclass){E[E.length]="&revchangeclass="+D.revchangeclass.value;E[E.length]="&revchangeid="+D.revchangeid.value;if(D.siteId){E[E.length]="&siteId="+D.siteId.value}}if(D.siteId){E[E.length]="&siteId="+D.siteId.value}E[E.length]="&GRID_CTX_NAME="+A;sendAJAXRequest(E.join(""),handleAddSubLevelError,false,null,{gridID:A})}function handleAddSubLevelError(response,args){var json=eval("("+response.text+")");var hasErrors=json.Results[0].haswarning;var errorMsg=json.Results[0].errMsg;AGILE.util.DMS.clearMessage();if(hasErrors=="true"){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,errorMsg)}else{AGILE.grid.AddChildRowToTable(args.gridID)}}function submitTableActionWithCallbk(C,F,B,A){var E=getForm("MainForm");var G=[];var D=AGILE.grid.rowSelections[A].getSelections();G[G.length]="ajaxRequest=true";G[G.length]="&reloadGridID="+A;G[G.length]="&module="+C;G[G.length]="&opcode="+F;G[G.length]="&IGNORE_BACK_FORWARD=true";G[G.length]="&IGNORE_TRAIL=true";G[G.length]="&classid="+E.classid.value;G[G.length]="&subclsid="+E.subclsid.value;G[G.length]="&objid="+E.objid.value;G[G.length]="&objver="+E.objver.value;G[G.length]="&tabid="+E.tabid.value;G[G.length]="&selectedKeys=";G[G.length]=escape(D);G[G.length]="&refresh=true";var H="TABLE_VIEWS_LIST_"+Grids[A]["TableId"];if(document.getElementById(H)!=null){G[G.length]="&"+H+"="+document.getElementById(H).value}if(E.revchangeclass){G[G.length]="&revchangeclass="+E.revchangeclass.value;G[G.length]="&revchangeid="+E.revchangeid.value;if(E.siteId){G[G.length]="&siteId="+E.siteId.value}}sendAJAXRequest(G.join(""),B,false,null,{gridID:A})}function submitFormAction(B,E,A){var D=getForm("MainForm");var F=[];var C=AGILE.grid.rowSelections[A].getSelections();F[F.length]="ajaxRequest=true";F[F.length]="&reloadGridID="+A;F[F.length]="&module="+B;F[F.length]="&opcode="+E;F[F.length]="&IGNORE_BACK_FORWARD=true";F[F.length]="&IGNORE_TRAIL=true";F[F.length]="&classid="+D.classid.value;F[F.length]="&subclsid="+D.subclsid.value;F[F.length]="&objid="+D.objid.value;F[F.length]="&objver="+D.objver.value;F[F.length]="&tabid="+D.tabid.value;F[F.length]="&selectedKeys=";F[F.length]=escape(C);F[F.length]="&refresh=true";F[F.length]="&reloadGrid=true";var G="TABLE_VIEWS_LIST_"+Grids[A]["TableId"];if(document.getElementById(G)!=null){F[F.length]="&"+G+"="+document.getElementById(G).value}if(D.revchangeclass){F[F.length]="&revchangeclass="+D.revchangeclass.value;F[F.length]="&revchangeid="+D.revchangeid.value;if(D.siteId){F[F.length]="&siteId="+D.siteId.value}}sendAJAXRequest(F.join(""),postSelectTableView,false,null,{gridID:A})}function submitFormActionWithNoSelections(B,D,A){var C=getForm("MainForm");var E=[];E[E.length]="ajaxRequest=true";E[E.length]="&module="+B;E[E.length]="&opcode="+D;E[E.length]="&IGNORE_BACK_FORWARD=true";E[E.length]="&IGNORE_TRAIL=true";E[E.length]="&classid="+C.classid.value;E[E.length]="&subclsid="+C.subclsid.value;E[E.length]="&objid="+C.objid.value;E[E.length]="&objver="+C.objver.value;E[E.length]="&tabid="+C.tabid.value;if(typeof(C.revchangeid)!="undefined"){E[E.length]="&revchangeid="+C.revchangeid.value;E[E.length]="&revchangeclass="+C.revchangeclass.value}E[E.length]="&refresh=true";sendAJAXRequest(E.join(""),postSelectTableView,false,null,{gridID:A})}function doSimpleSearch(){if(isMainPageDirty()){return}AGILE.object.RequestManager.abort(RIGHTPANECONTENT);hidePaletteDiv("floater_window2");hidePaletteDiv("floater_window");var B=document.reqForm;var A=stringTrim(B.QUICKSEARCH_STRING.value);if(A==null||A.length<=0||B.QUICKSEARCH_STRING.value==searchCriteriaStr){B.QUICKSEARCH_STRING.value=searchCriteriaStr;B.QUICKSEARCH_STRING.select();return}execTopPaneQuickSearch()}function execTopPaneQuickSearch(){clearGrid();var B=AGILE.util.SearchManager.QUICK_SEARCH;var A=false;AGILE.util.SearchManager.search(B,A)}function rollupCompliance(B){var A=new Array();if(typeof(document.MainForm.revchangeid)!="undefined"){A[A.length]="&revchangeid="+document.MainForm.revchangeid.value;A[A.length]="&revchangeclass="+document.MainForm.revchangeclass.value;if(document.MainForm.siteId){A[A.length]="&siteId="+document.MainForm.siteId.value}}showBackGroudProcessPrompt();var C=new AGILE.util.ActionStatusTracker({opcode:B,statusTrackerOpcode:"handleTask",statusTrackerModule:"BackgroundProcessHandler"},"MainForm",A.join(""));C.setCallback(rollupComplianceComplete);C.setCallBackArgs(A.join(""));C.invoke(document.body)}function showBackGroudProcessPrompt(){var B=[];B[B.length]='<p class="table_loading_indicator" id="p1">';B[B.length]='<img border="0" src="'+localMsg.loadingImage+'" />';var A=new AGILE.util.BasePrompt();A.setTitle("");A.setContent(B.join(""));A.setActions("");A.showPrompt()}function rollupComplianceComplete(A,B){displayContent({containerToUpdate:RIGHTPANECONTENT,msg:localMsg.RollupCompliance},B,"MainForm")}function displayBOMComplianceReport(){openDialogWindow("MainForm","ItemHandler","showBOMComplianceReport","popupWindow",600,750,"true","true")}function displayItemAttributeHistoryReport(){openDialogWindow("MainForm","ItemHandler","attributeHistoryReport","popupWindow",600,750,"true","true")}function displayActivityCalendarExceptionReport(){openDialogWindow("MainForm","ActivityHandler","showActivityCalendarExceptionRpt","popupWindow",670,875,"true","true")}function displayCompareItemAttributeReport(){openDialogWindow("MainForm","PartFamilyHandler","itemAttributeReport","popupWindow",600,750,"true","true")}function showSupplierAnalysisReport(){openDialogWindow("MainForm","ProjectHandler","supplierAnalysisReport","popupWindow",600,750,"true","true")}function calculateCompliance(B,D){var A=Grids[D];if(A&&A.TableId){disbleAction("MSG_Action_Calculate_Compliance_"+A.TableId)}var C=[];C[C.length]="ajaxRequest=true&classid="+document.MainForm.classid.value;C[C.length]="&objid="+document.MainForm.objid.value;C[C.length]="&opcode="+B;C[C.length]="&module="+document.MainForm.module.value;sendAJAXRequest(C.join(""),postCalculateCompliance,false,null,{id:D,msg:localMsg.RollupCompliance,fulltabledisplay:document.MainForm.fulltabledisplay.value,fullgridtableid:document.MainForm.fullgridtableid.value},true)}function postCalculateCompliance(A,B){var C=Grids[B.id];if(C&&C.TableId){enableAction("MSG_Action_Calculate_Compliance_"+C.TableId)}postActionCallback(A,B)}function postActionCallback(A,B){if(typeof(A.xml)!="undefined"&&A.thisConn.getResponseHeader("GlobalError")!=null&&A.thisConn.getResponseHeader("GlobalError")=="true"){var E=A.xml;var F=E.getElementsByTagName("Error")[0];var D=getXMLNodeValue(F,"Error");AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,D)}else{var G=B.id;var C="&addToTrail=false&fulltabledisplay="+B.fulltabledisplay+"&fullgridtableid="+B.fullgridtableid;if(Grids[G]){C=C+"&NAV_TO_KEY="+(typeof(Grids[G]["NAV_TO_KEY"])!="undefined"?Grids[G]["NAV_TO_KEY"]:"");if(!frm.SELECTED_PARENT_ROWID&&typeof(Grids[G]["SelectedParentId"])!="undefined"){C=C+"&SELECTED_PARENT_ROWID="+Grids[G]["SelectedParentId"]}}displayContent(B,C,"MainForm")}}function trackAction(){var A=new Array();var B=new AGILE.util.ActionStatusTracker({module:"BackgroundProcessHandler",opcode:"handleTask",statusTrackerOpcode:"handleTask",statusTrackerModule:"BackgroundProcessHandler"},"MainForm",A.join(""));B.setCallback(refreshObjectAfterObjectAction);B.invoke(document.body)}function refreshObjectAfterObjectAction(){displayContent({containerToUpdate:RIGHTPANECONTENT},"","MainForm")}function unincorporateObject(){var A=new Array();A[A.length]="&revchangeid="+document.MainForm.revchangeid.value;A[A.length]="&revchangeclass="+document.MainForm.revchangeclass.value;displayContent({opcode:"unincorporateObject"},A.join(""),"MainForm")}function incorporateObject(){var A=new Array();A[A.length]="&revchangeid="+document.MainForm.revchangeid.value;A[A.length]="&revchangeclass="+document.MainForm.revchangeclass.value;displayContent({opcode:"incorporateObject"},A.join(""),"MainForm")}function BOMBulkChange(){openDialogWindow("MainForm","BulkChangeWizardHandler_BOM","goToStep","popupWindow",700,850,"true","true","&wizardId=18&cleanupWizard=true")}function AMLBulkChange(){openDialogWindow("MainForm","BulkChangeWizardHandler_AML","goToStep","popupWindow",700,850,"true","true","&wizardId=19&cleanupWizard=true")}function MassAttachFiles(){openDialogWindow("MainForm","MassUpdateAttachFilesWizardHandler","showVersionsPage","popupWindow",600,850,"true","no","&MASSUPDATE_ACTION_TYPE=3&AddObjectTableId=0")}function MassReplaceAttachedFiles(){openDialogWindow("MainForm","AttachmentHandler","showMassUpdateWizard","popupWindow",600,850,"true","true","&MASSUPDATE_ACTION_TYPE=1")}function MassReplaceAttachedVersions(){openDialogWindow("MainForm","AttachmentHandler","showMassUpdateWizard","popupWindow",500,660,"true","true","&MASSUPDATE_ACTION_TYPE=2")}function MassRemoveAsAttachment(){openDialogWindow("MainForm","MassUpdateAttachFilesWizardHandler","showVersionsPage","popupWindow",500,660,"true","true","&MASSUPDATE_ACTION_TYPE=4")}function submitFormToGetRelatedTable(F,B){if(isMainPageDirty()){return}var G=getValue(F,"gridID","");var A=getValue(F,"rowID","");var L=getValue(B,"sourceGridID","");var K=getValue(B,"destGridID","");var J=getForm("MainForm");if(typeof(J.SELECTED_PARENT_ROWID)!="undefined"){var D=J.SELECTED_PARENT_ROWID.value;if(D==A){return}J.SELECTED_PARENT_ROWID.value=A}var C=[];var E=[{name:"opcode",value:"displayRelatedTable"}];var I=AGILE.util.replacePageURLParam(G,E);C[C.length]=I;C[C.length]="&DEST_GRID_CTX_NAME="+K;C[C.length]="&IGNORE_BACK_FORWARD=true";C[C.length]="&reloadGrid=true";C[C.length]="&refresh=true";C[C.length]="&reloadGridID="+K;C[C.length]="&SELECTED_PARENT_ROWID="+A;C[C.length]="&IGNORE_TRAIL=true";var H=sendAJAXRequest(C.join(""),postSelectTableView,false,null,{gridID:K},true);AGILE.object.RequestManager.addRequest(RIGHTPANECONTENT_SUBTABS,H)}function submitFormToDisplaySubTabs(D,B){if(isMainPageDirty(true)){return}var F=getForm("MainForm");var A=getValue(D,"gridID","");var G=getValue(D,"rowID","");if(typeof(F.SELECTED_PARENT_ROWID)!="undefined"){var E=F.SELECTED_PARENT_ROWID.value;if(E==G&&(typeof(AGILE.grid.auditArgs)=="undefined"||AGILE.grid.auditArgs==null)){return}}var C=getValue(D,"row_ObjSiteId","");document.MainForm.row_ObjSiteId.value=C;var H=[];H[H.length]="&IGNORE_BACK_FORWARD=true";H[H.length]="&forwardToPage=true";H[H.length]="&refresh=true";if(typeof(AGILE.grid.auditArgs)!="undefined"&&AGILE.grid.auditArgs!=null&&typeof(AGILE.grid.auditArgs.subtabid)!="undefined"){H[H.length]="&subTabId="+AGILE.grid.auditArgs.subtabid}else{H[H.length]="&subTabId="+document.MainForm.subTabId.value}H[H.length]="&SELECTED_PARENT_ROWID="+G;H[H.length]="&row_ObjSiteId="+C;H[H.length]="&IGNORE_TRAIL=true";if(document.MainForm.NAV_TO_KEY){H[H.length]="&NAV_TO_KEY="+document.MainForm.NAV_TO_KEY.value}H[H.length]="&fulltabledisplay="+document.MainForm.fulltabledisplay.value;H[H.length]="&fullgridtableid="+document.MainForm.fullgridtableid.value;if(typeof(AGILE.grid.auditArgs)!="undefined"&&AGILE.grid.auditArgs!=null&&typeof(AGILE.grid.auditArgs.issubtable)!="undefined"&&AGILE.grid.auditArgs.issubtable){H[H.length]="&needSelect=true";H[H.length]="&parentRowId="+AGILE.grid.auditArgs.rowid;H[H.length]="&highlightAttrId="+AGILE.grid.auditArgs.subattrid[0];H[H.length]="&highlightRowId="+AGILE.grid.auditArgs.subrowid[0];H[H.length]="&highlightSubTabId="+AGILE.grid.auditArgs.subtabid}if(typeof(AGILE.grid.auditArgs)!="undefined"&&AGILE.grid.auditArgs!=null&&typeof(AGILE.grid.auditArgs.type)!="undefined"&&AGILE.grid.auditArgs.type=="6"){AGILE.grid.auditArgs.type=null;displayContent({opcode:"displayEditRedlineTitleBlock",containerToUpdate:"rightpanecontentsubTabs",clearGrid:"false"},H.join(""),"MainForm")}else{displayContent({opcode:"displaySubTabTable",containerToUpdate:"rightpanecontentsubTabs",clearGrid:"false"},H.join(""),"MainForm")}}function navigateToObj(B,A){if(A=="displaySubTabTable"){loadSubTabs(B,A)}else{loadRelatedTable(B,A)}}function loadSubTabs(C,A){if(C==""){return}var B=getForm("MainForm");var D=[];D[D.length]="&IGNORE_BACK_FORWARD=true";D[D.length]="&forwardToPage=true";D[D.length]="&NAV_TO_KEY="+C;D[D.length]="&row_ObjSiteId="+C.split("_")[3];D[D.length]="&SELECTED_PARENT_ROWID=";D[D.length]="&refresh=true";D[D.length]="&subTabId="+B.subTabId.value;D[D.length]="&IGNORE_TRAIL=true";D[D.length]="&fulltabledisplay="+B.fulltabledisplay.value;D[D.length]="&fullgridtableid="+B.fullgridtableid.value;displayContent({opcode:A,containerToUpdate:"rightpanecontentsubTabs",clearGrid:"false"},D.join(""),"MainForm")}function loadRelatedTable(F,D){var E=getForm("MainForm");var A=E.fullgridtableid.value;var G=[];var C=[{name:"opcode",value:D}];var B=AGILE.util.replacePageURLParam(A,C);G[G.length]=B;G[G.length]="&DEST_GRID_CTX_NAME="+A;G[G.length]="&IGNORE_BACK_FORWARD=true";G[G.length]="&reloadGrid=true";G[G.length]="&refresh=true";G[G.length]="&reloadGridID="+A;G[G.length]="&SELECTED_PARENT_ROWID=";G[G.length]="&NAV_TO_KEY="+F;G[G.length]="&IGNORE_TRAIL=true";G[G.length]="&fulltabledisplay="+E.fulltabledisplay.value;G[G.length]="&fullgridtableid="+A;sendAJAXRequest(G.join(""),postSelectTableView,false,null,{gridID:A})}function setValueRedline(C){var A=document.getElementById(C);var D=document.getElementById("sp_"+C);if(A!=null&&D!=null){var B="<em>"+A.value+"</em>";if(A.tagName=="SELECT"&&A.selectedIndex>-1){B="<em>"+A.options[A.selectedIndex].text+"</em>"}if(B!=D.innerHTML){document.getElementById("sp_"+C).style.display=""}else{document.getElementById("sp_"+C).style.display="none"}}}function setMultiListValueRedline(G,B){if(typeof(B)=="undefined"||B==null||B==""){return}var D=G.substring(0,G.lastIndexOf("_"));var F=document.getElementById(D).value;B=replaceHtmlText(B);var A=F.split(";");var H=B.split(";");var C=false;if(B.length>0&&F.length==0){C=true}if(A.length<H.length){C=true}for(var E=0;E<A.length;E++){if(A[E]!=null&&A[E].length!=0&&B.indexOf(A[E])==-1){C=true;break}}if(C==true){document.getElementById("sp_"+G).style.display="inline-block"}else{document.getElementById("sp_"+G).style.display="none"}}function setMoneyValueRedline(F){var C=document.getElementById(F);var G=document.getElementById("sp_"+F);if(C!=null&&G!=null){var D=F.substring(0,F.lastIndexOf("_")+1)+"uom";var B=document.getElementById(D);var A=B.options[B.selectedIndex].text;var E="<em>"+C.value+" "+A+"</em>";if(E!=G.innerHTML){document.getElementById("sp_"+F).style.display=""}else{document.getElementById("sp_"+F).style.display="none"}}}function displaySubTabTable(B,C,A){if(isMainPageDirty(true)){return}var D=getForm("MainForm");var E=[];if(document.MainForm.subTabId.value!=B){AGILE.util.SearchManager.clearContextGridId()}document.MainForm.subTabId.value=B;E[E.length]="&displaySubTabs=true";E[E.length]="&DEST_GRID_CTX_NAME="+A;E[E.length]="&IGNORE_BACK_FORWARD=true";E[E.length]="&forwardToPage=true";E[E.length]="&subTabId="+B;E[E.length]="&IGNORE_TRAIL=true";E[E.length]="&SELECTED_PARENT_ROWID="+document.MainForm.SELECTED_PARENT_ROWID.value;if(document.MainForm.NAV_TO_KEY){E[E.length]="&NAV_TO_KEY="+document.MainForm.NAV_TO_KEY.value;E[E.length]="&row_ObjSiteId="+document.MainForm.NAV_TO_KEY.value.split("_")[3]}else{if(D.row_ObjSiteId){E[E.length]="&row_ObjSiteId="+D.row_ObjSiteId.value}}E[E.length]="&fulltabledisplay="+document.MainForm.fulltabledisplay.value;E[E.length]="&fullgridtableid="+document.MainForm.fullgridtableid.value;displayContent({opcode:"displaySubTabTable",containerToUpdate:"rightpanecontentsubTabs",clearGrid:"false"},E.join(""),"MainForm")}function displayEditRedlineTitleBlock(B,C,A){var D=getForm("MainForm");var E=[];document.MainForm.subTabId.value=B;E[E.length]="&displaySubTabs=true";E[E.length]="&DEST_GRID_CTX_NAME="+A;E[E.length]="&IGNORE_BACK_FORWARD=true";E[E.length]="&forwardToPage=true";E[E.length]="&subTabId="+B;E[E.length]="&IGNORE_TRAIL=true";E[E.length]="&SELECTED_PARENT_ROWID="+document.MainForm.SELECTED_PARENT_ROWID.value;if(document.MainForm.NAV_TO_KEY){E[E.length]="&NAV_TO_KEY="+document.MainForm.NAV_TO_KEY.value}E[E.length]="&fulltabledisplay="+document.MainForm.fulltabledisplay.value;E[E.length]="&fullgridtableid="+document.MainForm.fullgridtableid.value;displayContent({opcode:"displayEditRedlineTitleBlock",containerToUpdate:"rightpanecontentsubTabs",clearGrid:"false"},E.join(""),"MainForm")}function cancelEditRedlineTitleBlock(B,C,A){document.MainForm.isPageDirty.value="false";AGILE.util.DMS.clearMessage();displaySubTabTable(B,C,A)}function displayRedlineCoverPage(F,B,A){var D=getForm("MainForm");var E=[];E[E.length]="&displaySubTabs=true";E[E.length]="&DEST_GRID_CTX_NAME="+A;E[E.length]="&IGNORE_BACK_FORWARD=true";E[E.length]="&forwardToPage=true";if(A=="FOLDER_REDLINE_TITLE_BLOCK"){document.MainForm.subTabId.value="7";E[E.length]="&subTabId=7"}else{document.MainForm.subTabId.value="1";E[E.length]="&subTabId=1"}E[E.length]="&IGNORE_TRAIL=true";E[E.length]="&REDLINES_MODE="+F;E[E.length]="&refresh=true";E[E.length]="&SELECTED_PARENT_ROWID="+document.MainForm.SELECTED_PARENT_ROWID.value;if(document.MainForm.NAV_TO_KEY){E[E.length]="&NAV_TO_KEY="+document.MainForm.NAV_TO_KEY.value}E[E.length]="&fulltabledisplay="+document.MainForm.fulltabledisplay.value;E[E.length]="&fullgridtableid="+document.MainForm.fullgridtableid.value;var C=getFormElems(D);E[E.length]="&"+C;displayContent({opcode:"displaySubTabTable",containerToUpdate:"rightpanecontentsubTabs",clearGrid:"false"},E.join(""),"MainForm");document.MainForm.isPageDirty.value="false"}AGILE.util.UndoCoverPageRedlinesPrompt=function(B,A){this.initialize();this.initParams(B,A)};YAHOO.extend(AGILE.util.UndoCoverPageRedlinesPrompt,AGILE.util.BasePrompt,{_module:null,_gridId:null,initParams:function(B,A){this._module=B;this._gridId=A;this.initialize();this.setTitle(localMsg.Confirm_Undo_Redlines_Title);this.setContent("<br/> <p class='promptContent'> "+localMsg.Confirm_Undo_Redlines+"</p><br/>")},getActions:function(){var A=[];A[A.length]="<a id='prompt_undo' class='button' onclick='javascript:AGILE.util.Prompts[0].undoCoverPageRedlinesImpl();' onblur='buttonBlur(this.id)' onfocus='buttonFocus(this.id)' href='#'><span class='' id='prompt_undospan'><em class='save_dialog'>&nbsp;</em>"+localMsg.Button_Undo_Redline+"&nbsp;</span></a>";A[A.length]="<a id='prompt_close' class='button' onclick='javascript:AGILE.util.Prompts[0].hidePrompt();' onblur='buttonBlur(this.id)' onfocus='buttonFocus(this.id)' href='#'><span class='' id='prompt_closespan'><em class='cancel'>&nbsp;</em>"+localMsg.cancel+"&nbsp;</span></a>";return A.join("")},undoCoverPageRedlinesImpl:function(){var A=this._module;var C=getForm("MainForm");var E=[];var A=C.module.value;E[E.length]="ajaxRequest=true&displaySubTabs=true";E[E.length]="&module="+A;E[E.length]="&IGNORE_BACK_FORWARD=true";if(this._gridId=="FOLDER_REDLINE_TITLE_BLOCK"){E[E.length]="&subTabId=7"}else{E[E.length]="&subTabId=1"}E[E.length]="&IGNORE_TRAIL=true";E[E.length]="&SELECTED_PARENT_ROWID="+document.MainForm.SELECTED_PARENT_ROWID.value;if(document.MainForm.NAV_TO_KEY){E[E.length]="&NAV_TO_KEY="+document.MainForm.NAV_TO_KEY.value}E[E.length]="&fulltabledisplay="+document.MainForm.fulltabledisplay.value;E[E.length]="&fullgridtableid="+document.MainForm.fullgridtableid.value;var B=getFormElems(C);E[E.length]="&"+B;displayContent({opcode:"undoCoverPageRedLines",containerToUpdate:"rightpanecontentsubTabs",clearGrid:"false"},E.join(""),"MainForm");document.MainForm.isPageDirty.value="false";var D=C.fulltabledisplay.value;if(D!="true"){AGILE.grid.checkForRowRedLine()}this.hidePrompt()}});function undoCoverPageRedlines(C,B){var A=new AGILE.util.UndoCoverPageRedlinesPrompt(C,B);A.showPrompt()}function updateRedlineTitleBlock(tabId,module,gridId){var frm=getForm("MainForm");disableSaveButton("MSG_Save");document.getElementById("MSG_Save").className="button disabled";var params=[];if(gridId=="FOLDER_REDLINE_TITLE_BLOCK"){if(eval("document.MainForm.Selections_0")){setTableInfo("MainForm",0)}if(eval("document.MainForm.Selections_8")){setTableInfo("MainForm",8)}}else{if(eval("document.MainForm.Selections_0")){setTableInfo("MainForm",0)}if(eval("document.MainForm.Selections_11")){setTableInfo("MainForm",11)}if(eval("document.MainForm.Selections_12")){setTableInfo("MainForm",12)}}document.MainForm.subTabId.value=tabId;params[params.length]="&displaySubTabs=true";params[params.length]="&DEST_GRID_CTX_NAME="+gridId;params[params.length]="&IGNORE_BACK_FORWARD=true";params[params.length]="&forwardToPage=true";params[params.length]="&subTabId="+tabId;params[params.length]="&IGNORE_TRAIL=true";params[params.length]="&SELECTED_PARENT_ROWID="+document.MainForm.SELECTED_PARENT_ROWID.value;if(document.MainForm.NAV_TO_KEY){params[params.length]="&NAV_TO_KEY="+document.MainForm.NAV_TO_KEY.value}params[params.length]="&fulltabledisplay="+document.MainForm.fulltabledisplay.value;params[params.length]="&fullgridtableid="+document.MainForm.fullgridtableid.value;var formparams=getFormElems(frm);params[params.length]="&"+formparams;var f=function(){displayContent({opcode:"updateRedlineTitleBlockRows",containerToUpdate:"rightpanecontentsubTabs",clearGrid:"false"},params.join(""),"MainForm");var fullTableView=frm.fulltabledisplay.value;frm.isPageDirty.value="false";if(fullTableView!="true"){AGILE.grid.checkForRowRedLine()}};setTimeout(f,500)}function callBackToSetRedlineImage(A,B){var C=getForm("MainForm");var D=C.fulltabledisplay.value;if(!AGILE.util.hasErrors(A,B)&&D!="true"){AGILE.grid.checkForRowRedLine()}Grids[B.gridID]["RemovedRowCount"]=0;AGILE.util.handleErrors(A,B)}AGILE.util.UndoRedLinesPrompt=function(B,A){this.initialize();this.initParams(B,A)};YAHOO.extend(AGILE.util.UndoRedLinesPrompt,AGILE.util.BasePrompt,{_tabId:null,_gridId:null,initParams:function(B,A){this._tabId=B;this._gridId=A;this.initialize();this.setTitle(localMsg.Confirm_Undo_Redlines_Title);this.setContent("<br/> <p class='promptContent'> "+localMsg.Confirm_Undo_Redlines+"</p><br/>")},getActions:function(){var A=[];A[A.length]="<a id='prompt_undo' class='button' onclick='javascript:AGILE.util.Prompts[0].undoRedlinesImpl();' onblur='buttonBlur(this.id)' onfocus='buttonFocus(this.id)' href='#'><span class='' id='prompt_undospan'><em class='save_dialog'>&nbsp;</em>"+localMsg.Button_Undo_Redline+"&nbsp;</span></a>";A[A.length]="<a id='prompt_close' class='button' onclick='javascript:AGILE.util.Prompts[0].hidePrompt();' onblur='buttonBlur(this.id)' onfocus='buttonFocus(this.id)' href='#'><span class='' id='prompt_closespan'><em class='cancel'>&nbsp;</em>"+localMsg.cancel+"&nbsp;</span></a>";return A.join("")},undoRedlinesImpl:function(){var A=this._gridId;var B=this._tabId;var E=getForm("MainForm");var F=[];var C=E.module.value;var D=AGILE.grid.rowSelections[A].postStr();F[F.length]="ajaxRequest=true&displaySubTabs=true";F[F.length]="&module="+C;F[F.length]="&opcode=undoRedLines";F[F.length]="&classid="+E.classid.value;F[F.length]="&subclsid="+E.subclsid.value;F[F.length]="&objid="+E.objid.value;F[F.length]="&tabid="+E.tabid.value;F[F.length]="&clearGrid=false";F[F.length]="&GRID_CTX_NAME="+A;F[F.length]="&IGNORE_BACK_FORWARD=true";F[F.length]="&subTabId="+B;F[F.length]=D;F[F.length]="&IGNORE_TRAIL=true";sendAJAXRequest(F.join(""),callBackToSetRedlineImage,false,null,{gridID:A},true)}});function undoRedLines(C,B){AGILE.util.DMS.clearMessage();if(AGILE.util.getSelectedCount(B)<=0){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,localMsg.checkSelections);return}if(AGILE.util.isTableDirty(Grids[B])){if(!confirm(localMsg.unsavedChangeError)){return}}var A=new AGILE.util.UndoRedLinesPrompt(C,B);A.showPrompt()}function toggleWorlflowOverView(B,C){var A=document.getElementById("WorkflowDiagram_toggle");var D=document.getElementById("WorkflowDiagram");if(A!=null&&D!=null){if(D.style.display=="block"){A.className="toggle collapse";D.style.display="none";setWorkflowCookie("0",C)}else{A.className="toggle expand";D.style.display="block";setWorkflowCookie("1",C)}}}function toggleDiagramFirst(A,C,D){var E=document.getElementById("WorkflowDiagram");var B=document.getElementById(A);if(E!=null){if(C=="0"){E.style.display="none";B.className="toggle collapse";setWorkflowCookie("0",D)}else{E.style.display="block";B.className="toggle expand";setWorkflowCookie("1",D)}}}function setWorkflowCookie(H,G){var I=document.location.host;var A=I.indexOf(".");var F="";var C="";var B="";if(A>=0){var D=I.indexOf(":");if(D<0){D=I.indexOf("/")}if(D>=0){F=I.substring(A+1,D)}else{F=I.substring(A+1)}}if(F==""){C=""}else{C=";domain=."+F}C="";var E=new Date();E.setTime(E.getTime()+(365*24*60*60*1000));document.cookie="workflowToggle_"+G+"="+H+";path=/;expires="+E.toGMTString()}function onURLPXClick(B,A,D){if(D&&D.handler){var C=D.handler;if(YAHOO.lang.isString(C)){C=window[C]}if(YAHOO.lang.isFunction(C)){C(D.url,D.target,D.props);return}}out("Invalid URL PX CLICK handler")}function invokeURLPX(C,G,D){if(isMainPageDirty(false,localMsg.pxUnsavedChangeError,true)){return}sendAJAXRequest("ajaxRequest=true&module=LoginHandler&opcode=updateSession",null,false,null,{});var B=new Date();if(typeof(D)!="undefined"){var A=D.split(",");var F=(screen.width-parseParams(A,"width"))/2;var E=(screen.height-parseParams(A,"height"))/2;D=D+",left="+F+",top="+E;if((typeof(G)!="undefined")&&(G=="_parent")){window.open(C,G,D)}else{window.open(C,B.getTime(),D)}}else{if((typeof(G)!="undefined")&&(G=="_parent")){window.open(C,G)}else{window.open(C,B.getTime())}}}function printQuery(){var A=getForm("MainForm");openDialogWindow("MainForm",A.module.value,"printQuery","popupWindow",500,850,"true","true")}function getOnDemandContextID(){if(document.MainForm&&document.MainForm.helpID&&document.MainForm.helpID.value&&document.MainForm.helpID.value.length>0){return document.MainForm.helpID.value}return"-1"}function getOnDemandApplicationName(){return localMsg.AGILE}function handlePostQueryWarning(resolvedItems,reqParams){var isCancelled=false;for(var i=0;i<resolvedItems.length;i++){if(resolvedItems[i].appliedWarnCode==AGILE.EW.WARN_CANCELLED){isCancelled=true}}if(isCancelled){return}eval("document.MainForm.showWarningMessage").value="true";if(typeof(document.getElementById("wizardId"))!="undefined"&&eval("document.MainForm.wizardId").value==151){if(typeof(document.getElementById("stepId"))!="undefined"&&eval("document.MainForm.stepId").value==2606){if(typeof(document.getElementById("isQueryModified"))!="undefined"){eval("document.MainForm.isQueryModified").value="true"}}}submitForm("MainForm","","")}function submitSupplierForm(){var formname="MainForm";var module=eval("document."+formname+".module").value;var classid=eval("document."+formname+".classid").value;var objectid=eval("document."+formname+".objid").value;var webSuppAttribute=document.getElementById("R1_17526_0");if(webSuppAttribute!=null&&webSuppAttribute.options[webSuppAttribute.options.selectedIndex].value=="1"){var param="PCMServlet?ajaxRequest=true&module="+module+"&opcode=updateSupplierCoverPage&objid="+objectid+"&classid="+classid+"&popup=false";sendAJAXRequest(param,checkIfWebSupplier,true)}else{submitForm2({opcode:"updateRows"})}}function submitSupplierFormForMultipleWindows(){var params="ajaxRequest=true&module=ObjectViewHandler&opcode=isMultipleWindowsForSubmit&objid="+getForm("MainForm").objid.value;var handler=function(response){if(response.success){var responseObject=eval("("+response.text+")");if(responseObject.multipleWindowsFlag=="true"){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,responseObject.errorMessage);if(document.getElementById("MSG_Save")!=null){document.getElementById("MSG_Save").className="button disabled";document.getElementById("MSG_Save").onclick=""}}else{submitSupplierForm()}}else{submitSupplierForm()}};sendAJAXRequest(params,handler,false)}function checkIfWebSupplier(B){if(B.success){if(B.text=="true"){var C=getForm("MainForm");var A="isFromCoverpage="+true+"&classid="+C.classid.value+"&objid="+C.objid.value;openDialogWindow("MainForm","SupplierHandler","continueCreatingObject","_New",300,600,"true","",A)}else{submitForm2({opcode:"updateRows"})}}}function refreshParentObject(A){if(typeof(A)=="undefined"){A="MainForm"}var B=getForm(A);var C=new Array();C[C.length]="PCMServlet?ajaxRequest=true";C[C.length]="module="+B.module.value;C[C.length]="opcode=refreshParentObject";C[C.length]="objid="+B.objid.value;C[C.length]="classid="+B.classid.value;C[C.length]="tabid="+B.tabid.value;sendAJAXRequest(C.join("&"),noaction,true)}(function(){registerNS("AGILE.util");AGILE.util.ReportWizardManager={launchDialog:function(D){var C=getForm("MainForm");var B=C.classid.value;var A=C.objid.value;var E="objid="+A+"&classid="+B;openDialogWindow("MainForm","ReportHandler",D,"SaveSearchPopup",670,875,"true","true",E)},launchScheduleDialog:function(A){var B=AGILE.util.getSelectedCount(A);if(B<1){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,localMsg.attachmentActionsSelectOneRow);return}else{if(B!=1){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,localMsg.selectOnlyOneRow);return}}openDialogWindow("MainForm","ReportHandler","viewReportScheduleDetails","popupwindow",400,600,"true","true")},launchViewReportDialog:function(A){var B=AGILE.util.getSelectedCount(A);if(B<1){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,localMsg.attachmentActionsSelectOneRow);return}else{if(B!=1){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,localMsg.selectOnlyOneRow);return}}openDialogWindow("MainForm","ReportHandler","viewHistoricalReport","popupwindow",400,600,"true","true")}}})();function doFrameRefresh(){if(isMainPageDirty()){return}var B=document.MainForm.module;var A=document.MainForm.reloadRVisitedFromDB;refreshLeftPane();if(Dom.get("searchTopPane")){navigateCurrent()}else{refreshRightPane()}}function showChangePassword(A){openDialogWindow("MainForm","UserObjectHandler","showChangePassword","popupWindow",500,600,"true","",A)}function showTransferAuthority(){openDialogWindow("MainForm","SettingsHandler","showTransferAuthoritySummary","popupWindow",600,700,"true","")}function showResetUser(){openDialogWindow("MainForm","UserObjectHandler","showResetUserAccount","popupWindow",400,600,"true","")}function showPersonalCriteria(){openDialogWindow("MainForm","AdminHandler","showPersonalCriteriaSummary","popupWindow",600,700,"true","")}function addUserGroupEscalation(B){var A="&GRID_CTX_NAME="+B;openDialogWindow("MainForm","UserGroupObjectHandler","addUserGroupEscalation","popupWindow",450,550,"true","no",A)}function addUserEscalation(B){var A="&GRID_CTX_NAME="+B;openDialogWindow("MainForm","UserObjectHandler","addUserEscalations","popupWindow",450,600,"true","no",A)}function showWhereSentpopUp(B){var A="&GRID_CTX_NAME="+B;openDialogWindow("MainForm","CTOHandler","showAddWhereSent","popupWindow",400,700,"true","no",A)}function showAssignAssignments(A){var B=AGILE.grid.rowSelections[A].getSelectedCount();if(B==0){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,localMsg.checkSelections);return}openDialogWindow("MainForm","UserGroupObjectHandler","showAssignAssignments","popupWindow",500,700,"true","no")}function showAddManageServer(B){var A="&GRID_CTX_NAME="+B;openDialogWindow("MainForm","ClusterObjectHandler","showAddServer","_New",400,600,"true","no",A)}function addJobFunction(B){var A="&GRID_CTX_NAME="+B;openDialogWindow("MainForm","UserGroupObjectHandler","addJobFunction","popupWindow",450,550,"true","no",A)}function createUserGroup(B){var A="&classid=11885&wizardId=1009&GRID_CTX_NAME="+B;openDialogWindow("MainForm","UserGroupObjectHandler","createNewObjectInPopup","popupWindow",400,600,"true","no",A)}function createFunctionalTeam(B){var A="&classid=2000017166&wizardId=1023&GRID_CTX_NAME="+B;openDialogWindow("MainForm","UserGroupObjectHandler","createNewObjectInPopup","popupWindow",400,600,"true","no",A)}function createUser(B){var A="&classid=11605&GRID_CTX_NAME="+B;openDialogWindow("MainForm","UserObjectHandler","createUser","popupWindow",500,600,"true","no",A)}function assignRolesToUsers(D){AGILE.util.DMS.clearMessage();var C=AGILE.grid.rowSelections[D].getSelectedCount();if(C==0){AGILE.util.DMS.showErrorMessage(localMsg.checkSelections);return}var B=AGILE.grid.rowSelections[D].getSelections();var A="&GRID_CTX_NAME="+D+"&selectedKeys="+B;openDialogWindow("MainForm","AdminGroupsHandler","showUserRoles","popupWindow",400,600,"true","no",A)}AGILE.util.ChangePasswordManager={changePasswordNextLogin:function(uri){var callback=function(message){hideProcessingIndicator();var result=(message?eval("("+message+")"):{message:localMsg.NextLoginChangePassword_FAILURE,success:false});if(result.success==true){AGILE.util.DMS.showInfoMessage(result.message)}else{AGILE.util.DMS.showErrorMessage(result.message)}};showProcessingIndicator("","");var manager=new AGILE.util.RequestManager(callback);manager.sendRequest("GET",uri,null)},forceMultiplePasswordChangeNextLogin:function(B){AGILE.util.DMS.clearMessage();var A=AGILE.grid.rowSelections[B].getSelectedCount();if(A==0){AGILE.util.DMS.showErrorMessage(localMsg.checkSelections);return}var C=[];C[C.length]="PCMServlet?";C[C.length]="&ajaxRequest=true";C[C.length]="&module=AdminGroupsHandler";C[C.length]="&opcode=forcePasswordChangeNextLogin";C[C.length]="&GRID_CTX_NAME="+B;C[C.length]="&selectedKeys="+escape(AGILE.grid.rowSelections[B].getSelections());AGILE.util.ChangePasswordManager.changePasswordNextLogin(C.join(""))},forcePasswordChangeNextLogin:function(userId){userId=(!userId?eval("document.MainForm.objid").value:userId);var params=[];params[params.length]="PCMServlet?";params[params.length]="&ajaxRequest=true";params[params.length]="&module=UserObjectHandler";params[params.length]="&opcode=forcePasswordChangeNextLogin";params[params.length]="&objid="+userId;AGILE.util.ChangePasswordManager.changePasswordNextLogin(params.join(""))}};function showCreateUserGroup(D){AGILE.util.DMS.clearMessage();var C=AGILE.grid.rowSelections[D].getSelectedCount();if(C==0){AGILE.util.DMS.showErrorMessage(localMsg.checkSelections);return}var A="&classid=11885&wizardId=1009";var B=AGILE.grid.rowSelections[D].getSelections();A=A+"&GRID_CTX_NAME="+D+"&selectedKeys="+B;openDialogWindow("MainForm","UserGroupObjectHandler","createNewObjectInPopup","popupWindow",400,600,"true","no",A)}function showUserGroupsforAdd(D){AGILE.util.DMS.clearMessage();var C=AGILE.grid.rowSelections[D].getSelectedCount();if(C==0){AGILE.util.DMS.showErrorMessage(localMsg.checkSelections);return}var B=AGILE.grid.rowSelections[D].getSelections();var A="&GRID_CTX_NAME="+D+"&selectedKeys="+B;openDialogWindow("MainForm","AdminGroupsHandler","showUserGroupsforAdd","popupWindow",400,600,"true","no",A)}function alterUsers(D,E){AGILE.util.DMS.clearMessage();var B=AGILE.grid.rowSelections[D].getSelectedCount();if(B==0){AGILE.util.DMS.showErrorMessage(localMsg.checkSelections);return}var A=AGILE.grid.rowSelections[D].getSelections();var F=[];var C=getForm("MainForm");F[F.length]="PCMServlet?";F[F.length]="&ajaxRequest=true";F[F.length]="&module="+C.module.value;F[F.length]="&opcode="+E;F[F.length]="&GRID_CTX_NAME="+D;F[F.length]="&selectedKeys="+escape(A);showProcessingIndicator("","");sendAJAXRequest(F.join(""),handleAlterUserErrors,true,null,{gridID:D,showDMS:true})}function refreshUsersFromLdap(B){AGILE.util.DMS.clearMessage();var C=[];var A=getForm("MainForm");C[C.length]="PCMServlet?";C[C.length]="&ajaxRequest=true";C[C.length]="&module="+A.module.value;C[C.length]="&opcode=refreshUsersFromLdap";C[C.length]="&GRID_CTX_NAME="+B;showProcessingIndicator("","");sendAJAXRequest(C.join(""),handleAlterUserErrors,true,null,{gridID:B})}function deleteRecycleBinObjects(A){var B=AGILE.grid.rowSelections[A].getSelectedCount();if(B==0){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,localMsg.checkSelections);return false}var C=getForm("MainForm");C.module.value="SavedSearchExecutionHandler";C.opcode.value="reloadGrid";var D=AGILE.grid.rowSelections[A].postStr();AGILE.util.refreshGrid(A,true,{opcode:"deleteRows",module:"SavedSearchExecutionHandler"},D,AGILE.util.handleErrors)}function handleAlterUserErrors(response,args){hideProcessingIndicator();var xml=response.xml;var hasErrors=response.thisConn.getResponseHeader("hasEW")!=null&&response.thisConn.getResponseHeader("hasEW")!="";if(hasErrors){var errors=getXMLNodeValue(xml.getElementsByTagName("EW")[0]);eval(errors)}else{AGILE.grid.rowSelections[args.gridID].clear();if(args.showDMS){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.INFO,localMsg.Change_User_Status)}AGILE.util.refreshGrid(args.gridID,true,{},"",AGILE.util.renderGrid,{gridID:args.gridID})}}function enableDeclarationSubstanceTableActions(B,A){if((typeof(Grids[A]["SelectedParentId"])!="undefined"||typeof(Grids[A]["NAV_TO_KEY"])!="undefined")&&Grids[A]["ReadOnly"]!="1"){enableDeclarationRelatedTableActions(B)}else{disableDeclarationRelatedTableActions(B)}}function enableDeclarationRelatedTableActions(A){enableAction("MSG_Add_"+A);enableAction("MSG_Add_Child_"+A);enableAction("MSG_Remove_"+A);enableAction("MSG_More_"+A)}function disableDeclarationRelatedTableActions(A){disbleAction("MSG_Add_"+A);disbleAction("MSG_Add_Child_"+A);disbleAction("MSG_Remove_"+A)}function showUtilizationReport(A){var D=AGILE.grid.rowSelections[A].getSelectedCount();if(D==0){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,localMsg.attachmentActionsSelectOneRow);return}else{if(D>1){AGILE.util.DMS.setMessage(AGILE.util.DMS.ERROR,localMsg.selectOnlyOneRow);return}}var B=document.MainForm.module.value;var C=document.MainForm.classid.value;openDialogWindowForIlog("MainForm",B,"showUtilizationReport","popupWindow",700,900,"true","no")}function getTargetContainer(A){return document.getElementById(A)}var addRuleTabIdsForContent=new Array();function showRuleDialogForContent(I,G){AGILE.grid.ErrorWarnings.clearDMSErrorMessage();var E=AGILE.grid.rowSelections[I].getSelectedCount();if(E==0){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,localMsg.checkSelections);return}else{if(E>1){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,localMsg.selectOnlyOneRow);return}}var B=AGILE.grid.rowSelections[I].getSelections();var D="";if(G==1||G==2){D="editRuleDialogForContent"}else{D="deleteRuleDialog"}var H=getForm("MainForm");var C=new Array();C[C.length]="PCMServlet?ajaxRequest=true&module="+H.module.value;C[C.length]="&opcode="+D;C[C.length]="&classid="+document.MainForm.classid.value;C[C.length]="&objid="+document.MainForm.objid.value;C[C.length]="&popup=true";C[C.length]="&forwardToPage=true";C[C.length]="&selectedKeys="+B;C[C.length]="&GRID_CTX_NAME="+I;if(G==1||G==2){sendAJAXRequest(C.join(""),displayRuleDialogForContent,true,this,{gridID:I},true)}else{var F=document.getElementById("relationshipTableEditRule");var A=false;if(F){A=F.value}C[C.length]="&relationshipTableEditRule="+A;sendAJAXRequest(C.join(""),postDeleteRuleForContent,true,this,{gridID:I},true)}}function deleteRuleForContent(A){showRuleDialogForContent(A,3)}function reloadRelationShipGrid(A){AGILE.util.refreshGrid(A,true,{opcode:"reloadGrid"},"",AGILE.util.renderGrid,{gridID:A})}function postDeleteRuleForContent(A,C){var B=A.thisConn.getResponseHeader("Error");if(B&&B.length>0){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,A.text)}else{closeRuleDialogForContent(C.gridID)}}function displayRuleDialogForContent(D,F){var E=D.thisConn.getResponseHeader("Error");if(E&&E.length>0){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,D.text);cancelRuleDialogForContent(F.gridID)}else{var B=getTargetContainer("content_rule_table_container");B.innerHTML=D.text;handleScriptElems(B);addRuleTabIdsForContent[addRuleTabIds.length]="cmdSave";addRuleTabIdsForContent[addRuleTabIds.length]="cmdCancel";addRuleTabIdsForContent[addRuleTabIds.length]="cmdRemove";getTargetContainer("content_rule_prompt_mask").style.display="block";getTargetContainer("content_rule_prompt_shadow").style.display="block";var I=getTargetContainer("rule_table");getTargetContainer("content_rule_prompt_shadow").style.width=I.offsetWidth+35+"px";var C=windowSize();var A=C[0];var G=C[1];getTargetContainer("content_rule_prompt_shadow").style.left=(A-getTargetContainer("content_rule_prompt_shadow").offsetWidth)/2+"px";getTargetContainer("content_rule_prompt_shadow").style.top=(G-getTargetContainer("content_rule_prompt_shadow").offsetHeight)/2+50+"px";doRuleOnloadActions(F);Dom.get(addRuleTabIdsForContent[0]).focus()}}function saveRuleForContent(B,D){var F=document.getElementById("RELATIONAL_CTRL_OBJECT");var I=document.getElementById("RELATIONAL_EFF_OBJECT");if(F){F.disabled=false}if(I){I.disabled=false}var H=getRuleParams();var E=document.getElementById("relationshipTableEditRule");var A=false;if(E){A=E.value}var G=getForm("MainForm");var C=new Array();C[C.length]="PCMServlet?ajaxRequest=true&module="+G.module.value;C[C.length]="&opcode=saveRuleDialog";C[C.length]="&classid="+document.MainForm.classid.value;C[C.length]="&objid="+document.MainForm.objid.value;C[C.length]="&rowId="+rowId;C[C.length]="&popup=true";C[C.length]="&forwardToPage=true";C[C.length]="&GRID_CTX_NAME="+B;C[C.length]="&relationshipTableEditRule="+A;if(typeof(D)!="undefined"){C[C.length]=D}C[C.length]=H;sendAJAXRequest(C.join(""),displayRuleDialogForContent,true,this,{gridID:B},true)}function postSaveCallbackForContent(B,D){var C=B.thisConn.getResponseHeader("Error");if(C&&C.length>0){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,B.text)}else{var A=getTargetContainer("content_rule_table_container");if(A){A.innerHTML=B.text;handleScriptElems(A)}if(operationSuccess){closeRuleDialogForContent(D.gridID)}else{doRuleOnloadActions()}}}function cancelRuleDialogForContent(B){var A=getTargetContainer("content_rule_table_container");A.innerHTML="";getTargetContainer("content_rule_prompt_mask").style.display="none";getTargetContainer("content_rule_prompt_shadow").style.display="none";addRuleTabIds=new Array()}function closeRuleDialogForContent(gridId){cancelRuleDialogForContent();if(eval("reloadRelationShipGrid")){reloadRelationShipGrid(gridId)}}function displaySubTabTablesData(A){var B=getForm("MainForm");if(typeof(B.subTabId)!="undefined"){B.subTabId.value=A}displayObject(B.module.value,B.classid.value,B.objid.value,B.tabid.value)}AGILE.util.ExportObjects=function(A){var B="&wizardId = 13&GRID_CTX_NAME="+A;openDialogWindow("MainForm","CreatePDXWizardHandler","exportFromSearch","ExportPopup",600,875,"true","true",B)};function autoPopulateEffectiveDate(A){var C=AGILE.grid.rowSelections[A].getSelectedCount();if(C==0){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,localMsg.checkSelections);return}var B=AGILE.grid.rowSelections[A].postStr()+"&GRID_CTX_NAME="+A;openDialogWindow("MainForm","ChangeHandler","autoPopulateEffectiveDate","_New",400,600,"true",null,B)}function replaceAllSpaces(C){var A="";for(var B=0;B<C.length;B++){if(C.charAt(B)==" "){A+=String.fromCharCode(160)}else{A+=C.charAt(B)}}return A}function bulkAddSpecs(){openDialogWindow("MainForm","RegulationHandler","showBulkUpdateSpecWizard","popupWindow",600,750,"true","true","&BULKUPDATESPEC_ACTION=0&cleanupWizard=true")}function bulkReplaceSpecs(){openDialogWindow("MainForm","RegulationHandler","showBulkUpdateSpecWizard","popupWindow",600,750,"true","true","&BULKUPDATESPEC_ACTION=1&cleanupWizard=true")}function assignJobFunction(D){AGILE.util.DMS.clearMessage();var C=AGILE.grid.rowSelections[D].getSelectedCount();if(C==0){AGILE.util.DMS.showErrorMessage(localMsg.checkSelections);return}var B=AGILE.grid.rowSelections[D].getSelections();var A="&GRID_CTX_NAME="+D+"&selectedKeys="+B;openDialogWindow("MainForm","AdminGroupsHandler","showJobFuncs","popupWindow",400,600,"true","no",A)}function displayObjectInCoverPageForAudit(B){if(isMainPageDirty()){return}var A={type:B.type,module:B.module,opcode:"displayEditObject",classid:B.classId,objid:B.objectId,attrid:B.attrId,tabid:B.tabId,target:"RightPane",viewid:"0",cgToItemRevClassId:B.changeClsId,cgToItemRevObjId:B.changeId,fromaudit:true};displayContent(A)}function displayObjectInTableForAudit(D){var E=D.rowId.split(";");var A=D.attrId.split(";");if(D.classId=="10000"||D.classId=="9000"){var C=getForm("MainForm");C.cgToItemRevObjId.value=D.changeId;C.cgToItemRevClassId.value=D.changeClsId}var B={type:D.type,module:D.module,classid:D.classId,objid:D.objectId,attrid:A,tabid:D.tabId,rowid:E,subtabid:D.subTabId,expandlevel:D.expandLevel,issubtable:false};if(A[0]=="1110"){sendNotification(B)}displayObjectUsingFormName("MainForm",D.module,D.classId,D.objectId,D.tabId,"RightPane","0","","","","",B)}function sendNotification(A){var B=[];B[B.length]="ajaxRequest=true&module="+A.module;B[B.length]="&opcode=sendNotification";B[B.length]="&userids=704";sendAJAXRequest(B.join(""),"",false,null,{},true)}function displayObjectInSubTableForAudit(C){var A=C.subRowId.split(";");var D=C.subAttrId.split(";");var B={type:C.type,module:C.module,classid:C.classId,objid:C.objectId,attrid:C.attrId,tabid:C.tabId,rowid:C.rowId,subattrid:D,subtabid:C.subTabId,subrowid:A,issubtable:true,loadSubTableFlag:false};displayObjectUsingFormName("MainForm",C.module,C.classId,C.objectId,C.tabId,"RightPane","0","","","","",B)}function displayEditObjectInRedlineTableForAudit(C){var A=C.subRowId.split(";");var D=C.subAttrId.split(";");var B={type:C.type,module:C.module,classid:C.classId,objid:C.objectId,attrid:C.attrId,tabid:C.tabId,rowid:C.rowId,subattrid:D,subtabid:C.subTabId,subrowid:A,issubtable:true};displayObjectUsingFormName("MainForm",C.module,C.classId,C.objectId,C.tabId,"RightPane","0","","","","",B)}function addUnreleasedChildrenToAITableForAudit(D){var B={type:D.type,module:D.module,classid:D.classId,objid:D.objectId,tabid:D.tabId,gridId:"CHANGETABLE_AFFECTEDITEMS",childrennames:D.childrenNames};var C=getForm("MainForm");if(C&&C.objid&&C.objid.value&&C.tabid.value){var A=C.objid.value;var E=C.tabid.value;if(D.objectId==A&&D.tabId==E){addUnreleasedChildrenToAITable(D.module,D.classId,D.objectId,D.tabId,D.childrenNames,B.gridId);return}}displayObjectUsingFormName("MainForm",D.module,D.classId,D.objectId,D.tabId,"RightPane","0","","","","",B)}function updateRelationshipForCreatedChange(C,D,A,B){var E=[];E[E.length]="ajaxRequest=true&module="+C;E[E.length]="&opcode=updateRelationshipForCreatedChange";E[E.length]="&classid="+D;E[E.length]="&objid="+A;sendAJAXRequest(E.join(""),AGILE.grid.postAcceptNewRevisions,false,null,null)}function addUnreleasedChildrenToAITable(C,J,O,A,M,E){var G=[];var N=[];var B=M.strim().split(";");var K=B.removeDuplicates();var D=AGILE.grid.GenRowId(E);for(var I=0;I<K.length;I++){if(K[I].strim()!=""){N[N.length]=K[I];if(D){G[G.length]=D;D=null}else{G[G.length]=AGILE.grid.AddRow(E,false)}}}var L=getForm("MainForm");var F=[];F[F.length]="ajaxRequest=true&module="+C;F[F.length]="&opcode=addObjectsByTypeIn";F[F.length]="&classid="+J;F[F.length]="&objid="+O;F[F.length]="&tabid="+A;F[F.length]="&typeInClass=901";F[F.length]="&tableId="+Grids[E]["TableId"];F[F.length]="&typeInNames="+encodeURIComponent(N.join(";"));F[F.length]="&gridRowId="+G.join(";");F[F.length]="&GRID_CTX_NAME="+E;showProcessingIndicator("","");var H="true";sendAJAXRequest(F.join(""),AGILE.grid.RenderRowToTable,false,null,{gid:E,rid:G,audit:H},true)}var $jq=jQuery.noConflict();var global=this;var actionMessage="";var actionStatus="0";var displayPXResultInHTML="false";registerNS("AGILE.object");registerNS("AGILE.event");AGILE.event.tabChangedEvent=new YAHOO.util.CustomEvent("tabChangedEvent");AGILE.event.contentLoadedEvent=new YAHOO.util.CustomEvent("contentLoadedEvent");AGILE.event.contentUnLoadedEvent=new YAHOO.util.CustomEvent("contentUnLoadedEvent");AGILE.event.objectChangedEvent=new YAHOO.util.CustomEvent("objectChangedEvent");AGILE.object.LayoutRequestManager=function(){this.containerHierarchy=[];this.processingRequests=[];this.initialize()};AGILE.object.LayoutRequestManager.prototype={initialize:function(){this.containerHierarchy[RIGHTPANECONTENT]=[TABSVIEW_WRAPPER,CONTENT_VIEW,RIGHTPANECONTENT_SUBTABS];this.containerHierarchy[TABSVIEW_WRAPPER]=[RIGHTPANECONTENT_SUBTABS];this.containerHierarchy[CONTENT_VIEW]=[RIGHTPANECONTENT_SUBTABS]},addRequest:function(A,B){this.processingRequests[A]=B.thisConn},abort:function(A){var C=this.containerHierarchy[A];if(C){for(var D=0;D<C.length;D++){if(this.processingRequests[C[D]]!=null){out("Child container loading in progress.. abort1..");var B=this.processingRequests[C[D]];B.onreadystatechange=function(){};B.abort();this.removeRequest(C[D])}}}if(this.processingRequests[A]!=null){out("abort2.. Same container being reloaded..");this.processingRequests[A].onreadystatechange=function(){};this.processingRequests[A].abort();this.removeRequest(A)}},removeRequest:function(A){this.processingRequests[A]=null}};AGILE.object.RequestManager=new AGILE.object.LayoutRequestManager();AGILE.object.Content=function(){this.name=null;this.sourceurl=null;this.targeturl=null;this.dom=null;this.container=null;this.callbackConfig=null};AGILE.object.Content.prototype.load=function(C,A,B,E){this.sourceurl=C;this.container=A;this.args={};for(var D in B){if(B.hasOwnProperty(D)){this.args[D]=B[D]}}this.makeAJAXRequest();this.callbackConfig=E};AGILE.object.Content.prototype.reload=function(){this.makeAJAXRequest()};AGILE.object.Content.prototype.unload=function(){this.name=null;this.sourceurl=null;this.targeturl=null;this.dom=null;this.container=null};AGILE.object.Content.prototype.validate=function(){};AGILE.object.Content.prototype.validate=function(A){this.targeturl=A};AGILE.object.Content.prototype.getdom=function(){return this.container.innerHTML};AGILE.object.Content.prototype.isloaded=function(){if(this.container.innerHTML==null){return false}else{return true}};AGILE.object.Content.prototype.makeAJAXRequest=function(){if(!this.container){return}AGILE.object.RequestManager.abort(this.container.id);postCheck=function(B){};processDLSResponse=function(D){if(D.success){if(isLoginPage(D)){submitForm("MainForm","","","_self");return}var C=document.getElementById("loading_indicator");if(C){C.innerHTML="processing"}if(isObjectErrorPage(D)){AGILE.object.RequestManager.removeRequest(this.container.id);setTimeout("globalProgressIndicatorOff()",1);showObjectErrorPrompt(D);resetMainFormParameters(this.callbackConfig);return}if(AGILE.util.hasErrors(D)){AGILE.object.RequestManager.removeRequest(this.container.id);setTimeout("globalProgressIndicatorOff()",1);displayContentErrors(D);return}if(this.container&&this.container.id=="rightpanecontent"||this.container.id=="tabsview_wrapper"){AGILE.util.AgileDragDropMgr.purgeAllDropTargets()}clearMenus(this.container.id);if(this.container&&this.container.id=="rightpanecontent"){if(!AGILE.util.SearchManager.isSearchPaletteEnabled()){AGILE.util.SearchManager.destroySearches()}}if(this.container&&(this.container.id=="rightpanecontent"||this.container.id=="rightpanecontentsubTabs"||this.container.id=="widgetContentL1"||this.container.id=="activityObjectInfoDiv")){if(AGILE.util.SelectControlManager){AGILE.util.SelectControlManager.destroyAllControls()}}var K=getValue(this.args,"clearGrid");var B=D.text.length-50;var E=D.text.substr(B,D.text.length);var I={container:this.container.id};AGILE.EventManager.fireEvent(this.container.id,ON_UNLOAD,I);AGILE.EventManager.clearEvents(this.container.id);if(this.container.id==TABSVIEW_WRAPPER&&E.indexOf(RIGHTPANECONTENT)!=-1){AGILE.EventManager.fireEvent(RIGHTPANECONTENT,ON_UNLOAD,I);AGILE.EventManager.clearEvents(RIGHTPANECONTENT);this.container=getTargetContainer(RIGHTPANECONTENT);if(!this.container){return}}var J=windowSize();if(typeof(K)=="undefined"){clearGrid()}this.container.innerHTML=D.text;if(D.text.indexOf("showTableLoading")==-1){var C=document.getElementById("loading_indicator");if(C){C.innerHTML="done"}}var G=document.getElementById("pageViewContent");if(G){if(!G.style.height){var H=2;var F=J[1]-getOffsetTop(G)-H;F=F<0?0:F;cachedPageViewHeight=F+"px";G.style.height=cachedPageViewHeight}else{}}postCheck(this.container.innerHTML);handleScriptElems(this.container);var L=document.getElementById("pageViewContent2");if(L&&this.container.id!="rightpanecontentsubTabs"){AGILE.EventManager.fireEvent("rightpanecontentsubTabs",ON_LOAD)}AGILE.EventManager.fireEvent(this.container.id,ON_LOAD,I);reloadLeftPaneContents();hidePaletteDiv("floater_window2");hidePaletteDiv("floater_window");hideProcessingIndicator();document.body.style.cursor="default";showDisplayContentMessage(D);AGILE.object.RequestManager.removeRequest(this.container.id);setTimeout("globalProgressIndicatorOff()",1);setTimeout(function(){loadAssistPlus()},300);if(this.callbackConfig&&this.callbackConfig.callback){this.callbackConfig.callback.call(this.callbackConfig.scope,this.callbackConfig.response,this.callbackConfig.args)}}};if(!window.loggedOut){AGILE.util.setGridScrollInfo()}setTimeout("globalProgressIndicatorOn()",1);var A=sendAJAXRequest(this.sourceurl,processDLSResponse,false,this,{},true);AGILE.object.RequestManager.addRequest(this.container.id,A)};function showDisplayContentMessage(D){var C=false;if("string"==(typeof D.requestURL)){if(-1!=D.requestURL.indexOf("opcode=invokeCustomProcessActions")){C=true}}if(actionStatus.length>0){if(actionMessage.length>0){var B=AGILE.util.DMS.MSG_DISPLAY_TYPE.TEXT;if("true"==displayPXResultInHTML){B=AGILE.util.DMS.MSG_DISPLAY_TYPE.HTML}var A=jQuery("#dms").css("display");jQuery("#dms").css("display","none");if(actionStatus=="true"||actionStatus=="1"){AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.INFO,actionMessage,"",B,true)}else{AGILE.util.DMS.setMessage(AGILE.grid.ErrorWarnings.ERROR,actionMessage,"",B,true)}if((jQuery("#dms").height()>55*2)&&C){AGILE.util.DMS.clearMessage();jQuery("#dms").css("max-height","55px");jQuery("#dms").css("display",A);if("true"==displayPXResultInHTML){showPXOuputInDialog(actionMessage.htmlConsecutiveWS())}else{showPXOuputInDialog(actionMessage.textToHTML().htmlConsecutiveWS())}}else{jQuery("#dms").css("max-height","55px");jQuery("#dms").css("display",A)}actionMessage=""}actionStatus=""}displayPXResultInHTML="false"}function showPXOuputInDialog(C){var B=[];B[B.length]='<p id="PXOutput">';B[B.length]=C;B[B.length]="</p>";openModalDialog("",570,500,"PXOutputWindow","yes","yes",true,"false",false,"No Cust Loading Msg","false","true");if(AGILE.WindowManager.childWindows.PXOutputWindow){if((typeof AGILE.WindowManager.childWindows.PXOutputWindow.document)!="undefined"){var A=AGILE.WindowManager.childWindows.PXOutputWindow.document;A.write("<html><head><title>PX Output</title></head>");A.write("<body>"+B.join("")+"</body>")}}}function reloadLeftPaneContents(){if(markBookmarksForUpdate){var rvtree=YAHOO.widget.TreeView.getTree("recentlyVisitedTree");if(rvtree){var firstNode=rvtree.getTopLevelNode().children[0];if(firstNode){oldBookmarkNodeName=firstNode.data.label}}}if(markRecentlyForRefresh){var rvNode=document.getElementById("hiddenRVTable");if(false&&rvNode){setTimeout("refreshRVTree()",1)}else{refreshRVTree()}markRecentlyForRefresh=false}if(markBookmarksForUpdate){updateBookMarkTree();markBookmarksForUpdate=false;oldBookmarkNodeName=null}if(markBookmarksForRefresh){refreshBookMarkTree();markBookmarksForRefresh=false}if(markReportsForRefresh){refreshReportsTree();markReportsForRefresh=false}var skipEmphasisNode=false;if(markNavigationForRefresh){refreshCtxNavTree();markNavigationForRefresh=false;skipEmphasisNode=true}if(!markNavigationForRefresh&&markActivityTreeForRefresh){var tree=YAHOO.widget.TreeView.getTree("ctxNavTree");if(tree!=null){var nav_classId=tree._classId;var nav_objId=tree._objectId;var classId=eval("document.MainForm.classid").value;var objId=eval("document.MainForm.objid").value;var parentId=0;if(eval("document.MainForm.rootParentId")){parentId=eval("document.MainForm.rootParentId").value}if(nav_objId==objId||nav_objId==parentId){refreshCtxNavTree()}}markActivityTreeForRefresh=false;skipEmphasisNode=true}if(!skipEmphasisNode){emphasisLeftPaneActivityNode()}}function isLoginPage(B){if(B.text.length<50){return}var C=B.text.length-50;var A=B.text.substr(C,B.text.length);return A.indexOf("LoginForm")!=-1}function isObjectErrorPage(A){return A.thisConn.getResponseHeader("NoPriv")!=null&&A.thisConn.getResponseHeader("NoPriv")!=""}function emphasisLeftPaneActivityNode(){var tree=YAHOO.widget.TreeView.getTree("ctxNavTree");if(tree!=null){var nav_classId=tree._classId;if(!(nav_classId==18022||nav_classId==18387)){return}var nav_objId=tree._objectId;var classId=eval("document.MainForm.classid").value;var objId=eval("document.MainForm.objid").value;var parentId=0;if(eval("document.MainForm.rootParentId")){parentId=eval("document.MainForm.rootParentId").value}if(nav_objId==objId||nav_objId==parentId){var rowKey;if(nav_objId==objId){rowKey=classId+"_"+objId+"_-1_-1_-1_-1"}else{rowKey=classId+"_"+objId+"_0"}emphasisActivityNode("ctxNavTree",rowKey)}}}function resetMainFormParameters(A){var B=getForm("MainForm");var C=get2ndForm("MainForm");if(B&&C){B.module.value=C.module.value;B.displayMode.value=0;B.classid.value=(A&&A.args)?A.args.rclassid:C.classid.value;B.objid.value=(A&&A.args)?A.args.robjid:C.objid.value;B.tabid.value=(A&&A.args)?A.args.rtabid:C.tabid.value;if(YAHOO.lang.isString(B.classid.value)&&(B.classid.value=="10000"||B.classid.value=="9000")){B.revchangeclass.value=(A&&A.args&&A.args.rrevchangeclass)?A.args.rrevchangeclass:C.revchangeclass.value;B.revchangeid.value=(A&&A.args&&A.args.rrevchangeid)?A.args.rrevchangeid:C.revchangeid.value}}}function isGoToHomepage(A){return typeof(A)!="underfine"&&A.thisConn.getResponseHeader("goToHomepage")=="true"}function showObjectErrorPrompt(C){var B=C.text;var A=new AGILE.util.BasePrompt();A.setPromptId("ObjectErrorPrompt");A.setTitle(localMsg.error);A.setContent('<br/> <p style="padding-left:10px"> '+B+"</p><br/>");var E="<a href='#' id='prompt_save' onblur='buttonBlur(this.id)' onfocus='buttonFocus(this.id)' onclick='javascript:AGILE.util.Prompts[0].hidePrompt();' class='button'> <span id='prompt_savespan' class='nodrag'><em class='save_dialog nodrag'>&nbsp;</em>"+localMsg.ok+"</span> </a>";A.setActions(E);A.setInitialFocusId("prompt_save");if(isGoToHomepage(C)){var D=function(){if(document.MainForm&&document.MainForm.isPageDirty){document.MainForm.isPageDirty.value="false"}if(Grids.length>0){for(var F=0;F<Grids.length;F++){if(Grids[F]){AGILE.util.cancelTableDirty(Grids[F],checkSubTabDataOnly)}}}goHome()};A.setHidePromptCallBack(D)}A.showPrompt()}function displayContentErrors(response,args){var xml=response.xml;var hasErrors=AGILE.util.hasErrors(response);if(hasErrors){var errors=getXMLNodeValue(xml.getElementsByTagName("EW")[0]);eval(errors)}else{if(!AGILE.EW.EWView.isWarningPanelVisible()){if(args.gridID.indexOf("PREVIEW")!=-1){objInfoPalette.loadContent("")}}}}function handleDisplayContentErrors(K,L){var F="loadTable";var E=new Array();var J=new Array();var B=new Array();var H="";var D=new Array();var I=0;var A=L.opcode;for(var G=0;G<K.length;G++){if(K[G].appliedWarnCode==AGILE.EW.WARN_CANCELLED){return}E[E.length]=F+K[G].entryValue;J[J.length]=K[G].appliedWarnCode;D[D.length]=K[G].clientRowId+"=true"}var C=new Array();for(var G in L){if(G!="pgWarnCode"&&G!="pgWarnID"){C[C.length]=G+"="+L[G]}}if(L.pgWarnCode){H="&pgWarnCode="+J.join(";")+";"+L.pgWarnCode+"&pgWarnID="+E.join(";")+";"+L.pgWarnID}else{H="&pgWarnCode="+J.join(";")+"&pgWarnID="+E.join(";")}C[C.length]=H;if(A=="displaySubTabTable"){displayContent({opcode:"displaySubTabTable",containerToUpdate:"rightpanecontentsubTabs",clearGrid:"false"},C.join("&"),"MainForm")}else{displayContent({opcode:A},C.join("&"),"MainForm")}}var global=window;function handleScriptElems(div){var scriptElems=div.getElementsByTagName("script");var headElem=document.getElementsByTagName("head")[0];if(scriptElems!=null){for(var i=0;i<scriptElems.length;i++){if(scriptElems[i].src){jQuery.getScript(scriptElems[i].src)}var content=scriptElems[i].innerHTML;if(content.indexOf("window.top")!=-1){}if(content.indexOf("scriptIgnore")==-1){var str=trim(content);if(window.execScript&&str.length>0){window.execScript(str)}else{if(is_safari){var s=document.createElement("script");s.type="text/javascript";headElem.appendChild(s);s.text=scriptElems[i].text}else{this.eval(str)}}}}}}function clearGrid(C){out(" ClearGrid called ... ");try{if(!Grids){return}var F=new Array();var A=false;for(var E=0;E<Grids.length;E++){if(C&&Grids[E]&&Grids[E].id!=C){A=true;continue}if(Grids[E]){if(!isNonObjectViewGrid(Grids[E].id)){out(" Clearing Grid ... # "+Grids[E].id);var B=document.getElementById("treegrid_"+Grids[E].id);if(B&&B.onresize){B.onresize=null}Grids[E].Clear(1);Grids[Grids[E].id]=null;Grids[E]=null}else{A=true}}}if(!A){Grids.length=0}AGILE.grid.GridsRendered=new Array()}catch(D){}}function isNonObjectViewGrid(B){var A=false;for(var C=0;C<AGILE.grid.NonObjectViewGridIDs.length;C++){if(B==AGILE.grid.NonObjectViewGridIDs[C]){A=true}}return A}function hidePaletteDiv(B){var A=document.getElementById(B);if(A){A.style.display="";destoryTablePalette()}}function displayContent(C,K,c,I){var b;if(typeof(c)!="undefined"&&c.length>0){b=getForm(c)}var B="";var P="";var H="";var Y="";var U="";var E="";var D="";var Z="";if(b){B=b.module.value;P=b.classid.value;H=b.objid.value;Y=b.tabid.value;U=b.opcode.value}B=getValue(C,"module",B);P=getValue(C,"classid",P);H=getValue(C,"objid",H);Y=getValue(C,"tabid",Y);E=getValue(C,"version",E);D=getValue(C,"cgToItemRevClassId",D);Z=getValue(C,"cgToItemRevObjId",Z);var d=getValue(C,"target","");var V=getValue(C,"viewid","");U=getValue(C,"opcode",U);var R=getValue(C,"containerToUpdate",RIGHTPANECONTENT);var L=getValue(C,"objectVersion","");var G=getValue(C,"msg","");var N=new AGILE.object.Content();var Q="";if(B.length>0&&U.length>0){Q="module="+B+"&opcode="+U+"&classid="+P+"&objid="+H+"&tabid="+Y+"&target="+d+"&version="+E+"&viewid="+V+"&objver="+L+"&";if(typeof(C.fromaudit)!="undefined"&&C.fromaudit){if((P=="10000"||P=="9000")&&(D=="6000"||D=="1450"||D=="11907")){Q=Q+"cgToItemRevClassId="+D+"&cgToItemRevObjId="+Z+"&"}}}if(typeof(K)!="undefined"){Q=Q+K}var W=getTargetContainer(R);var X="req=req&ajaxRequest=true&forwardToPage=true&container="+R+"&";var a=getValue(C,"params","");a=(a.length>0)?a:Q;var F="PCMServlet?"+X+a;if(typeof(C.fromaudit)!="undefined"&&C.fromaudit){F=F+"fromaudit="+C.fromaudit+"&attrid="+C.attrid}var O=false;if("displayEditRedlineTitleBlock"===U){O=true}else{if(K&&"loadSummaryWidgetContent"===U){var A,J;var S=K.split("&");for(var T=0;T<S.length;T++){var M=S[T].split("=");if(M[0]==="displayMode"){J=M[1]}else{if(M[0]==="widgetId"){A=M[1]}}}if(J==="1"&&A==="1"){O=true}}}if(O){AGILE.richtext.onDisplayEditObject(b)}N.load(F,W,C,I);if(G.length>0){AGILE.util.DMS.showInfoMessage(G)}}function displayContentForUrl(F,A){var C=getTargetContainer(A);var D="&req=req&ajaxRequest=true&forwardToPage=true&container="+A+"&";var B="PCMServlet?"+D+F;var E=new AGILE.object.Content();E.load(B,C)}function applyThemes(B,E){if(B.indexOf("css")!=-1){var D=document.getElementsByTagName("head")[0];var G=D.firstChild;while(G){try{if(G.getAttribute("href").indexOf("styleSheetGenerator")!=-1){var A=G;G=G.nextSibling;D.removeChild(A);continue}}catch(F){}G=G.nextSibling}}else{var D=document.getElementsByTagName("head")[0];var C=document.createElement("link");C.setAttribute("rel","stylesheet");C.setAttribute("type","text/css");C.setAttribute("href",B);D.appendChild(C)}if(E&&THEMED_CONTROL_HILITE_COLOR){THEMED_CONTROL_HILITE_COLOR=E}doFrameRefresh()}AGILE.util.setGridScrollInfo=function(){try{if(!Grids){return}for(var A=0;A<Grids.length;A++){if(Grids[A]&&!isNonObjectViewGrid(Grids[A].id)){Grids.saveGridScroll(Grids[A])}}}catch(B){}};AGILE.util.ClearGridScrollInfo=function(){try{if(!Grids){return}for(var A=0;A<Grids.length;A++){if(Grids[A]&&!isNonObjectViewGrid(Grids[A].id)){Grids[A]["CurrentPage"]=0}}}catch(B){}};AGILE.util.hasErrors=function(A,B){return A.thisConn.getResponseHeader("hasEW")!=null&&A.thisConn.getResponseHeader("hasEW")!=""};function saveCookie(B,D,F){var C="";if(F){var A=new Date();var E=A.getTime()+(F*24*60*60*1000);A.setTime(E);C="; expires="+A.toGMTString()}document.cookie=B+"="+D+C+"; path=/"}function readCookie(A){var E=document.cookie.split(";");var D=A+"=";if(A=="ObjCreateContinueChecked"){setTimeout(function(){loadAssistPlus()},300)}for(var B=0;B<E.length;B++){var C=E[B];while(C.charAt(0)==" "){C=C.substring(1,C.length)}if(C.indexOf(D)==0){return C.substring(D.length,C.length)}}return""}function deleteCookie(A){saveCookie(A,"",-1)}var minColWidth=10;var rowPrefix="R";var modified="false";var dupRows=new Array();var tableArray=new Array();var selectedTableArray=new Array();var tableRowWarningMap=new Array();var strImagePath="images/";var adjustTableBorder=false;if(typeof(imageContextPath)!="undefined"){strImagePath=imageContextPath+"images/"}function getForm(formName){if(formName==null||formName.length==0){for(i=0;i<document.forms.length;i++){if(document.forms[i].name!="spiffyCal"){return document.forms[i]}}}return eval("document."+formName)}function getRowMap(B){var A=tableArray[B];if(A==null){tableArray[B]=new Array()}return tableArray[B]}function getSelectedRowMap(B){var A=selectedTableArray[B];if(A==null){selectedTableArray[B]=new Array()}return selectedTableArray[B]}function setRowMap(A,B){tableArray[A]=B}function getRowWarningMap(B){var A=tableRowWarningMap[B];if(A==null){tableRowWarningMap[B]=new Array()}return tableRowWarningMap[B]}function rd(H,I,B,E,C,A,D,F,G){this.rowID=H;this.parentID=I;this.objectID=B;this.rowLevel=E;this.isSelected=C;this.isExpanded=A;this.isEdited=D;this.isSelectable=F;this.children=null;this.considerForSelectedCount=G}function rw(D,H,E,G,F,A,B,C){this.rowID=D;this.objectID=H;this.warningId=E;this.warningType=G;this.isWarning=F;this.objNumber=A;this.message=B;this.warningResolution=C}function addTableRow(F,L,M,B,G,C,A,E,I,J){var H=getRowMap(F);var K=getIndex(L);H[K]=new rd(L,M,B,G,C,A,E,I,J);var D=getSelectedRowMap(F);if(C){D[K-1]=C}if(M!=null&&M!=""){if(H[getIndex(M)].children==null){H[getIndex(M)].children=new Array}H[getIndex(M)].children[H[getIndex(M)].children.length]=L}}function getIdFromIndex(B,A){var C=getRowMap(B);return C[A].objectID}function addRowWarning(D,J,B,H,K,C,I,L,A){var F=getRowWarningMap(D);var G=getIndex(J);var E=F[G];if(E==null){E=new Array()}E[E.length]=new rw(J,B,H,K,C,I,L,A);F[G]=E}function showWarning(C,B,A,H,J,I,D){var E=getRowWarningMap(C);var F=getIndex(B);var G=document.getElementById(("error_"+B+"_"+C));if(D){H=localMsg.mutlipleWarnings_per_row+"\n"+H}if(J=="1"){if(confirm(H)){setWarningResolution(C,B,"1");G.src=strImagePath+"warning_yes.gif"}else{setWarningResolution(C,B,"2");G.src=strImagePath+"warning_fix.gif"}}else{if(J=="0"){alert(H)}}}function setWarningResolution(E,G,C){var A=getRowWarningMap(E);if(A==null||A.length==0){return}var B=getIndex(G);var F=A[B];if(F==null){return}for(var D=0;D<F.length;D++){F[D].warningResolution=C}}function resetWarningResolutions(A,B){setWarningResolution(A,B,"0")}function hasWarnings(B,C){var A=getRowWarningMap(C);if(A!=null&&A.length>0){return true}return false}function allWarningsResolved(B,C){var A=getRowWarningMap(C);for(i=0;i<A.length;i++){if(A[i]!=null){var D=A[i];for(k=0;k<D.length;k++){if(D[k].isWarning&&D[k].warningResolution==""){return false}}}}return true}function serializeWarningInfo(formName,tableId){var result="";var warnings=getRowWarningMap(tableId);if(!hasWarnings(formName,tableId)){return}for(i=1;i<warnings.length;i++){if(warnings[i]!=null){var rowWarnings=warnings[i];for(k=0;k<rowWarnings.length;k++){if(rowWarnings[k].warningResolution!=""){result=result+rowWarnings[k].objectID+"="+rowWarnings[k].warningId+";"+rowWarnings[k].warningResolution+"&"}}}}eval("document."+formName+".TableRowWarnings_"+tableId).value=result}function setExpanded(formName,tableId,rowID,expand){var index=getIndex(rowID);var treeRows=getRowMap(tableId);setTreeRowInfo(formName,tableId);treeRows[index].isExpanded=expand;eval("document."+formName+".ExpandedRow_"+tableId).value=treeRows[index].objectID}function printRowMap(C){var A=getRowMap(C);var B=0;for(B=1;B<A.length;B++){alert("RowMap ["+B+"] rowID = "+A[B].rowID+" objectId = "+A[B].objectID+" isExpanded = "+A[B].isExpanded)}}function setTreeRowInfo(formName,tableId){var expanded="";var treeRows=getRowMap(tableId);for(i=1;i<treeRows.length;i++){if(treeRows[i].isExpanded==true){expanded=expanded+treeRows[i].objectID+"="+treeRows[i].isExpanded+"&"}}eval("document."+formName+".TableTreeRows_"+tableId).value=expanded}function expandRow(A,C,E,B){setExpanded(A,C,E,B);var D=getForm(A);D.submit()}function setTableInfo(formName,tableId){serializeWarningInfo(formName,tableId);var selections="";var rowObjectMap="";var editedRows="";var result="";var frm=getForm(formName);var registeredTables;if(tableId==null||tableId.length<=0){registeredTables=frm.registeredTables.value;if(registeredTables!=null&&registeredTables.length>0){var tableIds=registeredTables.split(",");if(tableIds.length>0){tableId=tableIds[0]}}}var rowmap=getRowMap(tableId);for(i=1;i<rowmap.length;i++){if(rowmap[i].isSelectable){selections=selections+i+"="+rowmap[i].isSelected+"&"}rowObjectMap=rowObjectMap+i+"="+rowmap[i].objectID+"&";if(rowmap[i].isEdited==true){editedRows=editedRows+rowmap[i].objectID+"&"}}eval("document."+formName+".Selections_"+tableId).value=selections;eval("document."+formName+".TableRowMap_"+tableId).value=rowObjectMap;eval("document."+formName+".TableDirtyRows_"+tableId).value=editedRows}function isRowSelected(B,C){var A=1;for(A=1;A<B.length;A++){if(C.test(B[A].rowID)&&B[A].isSelected==true){return true}}return false}function deselectAll(C,D){var F,B,A;var E=getRowMap(D);for(B=1;B<E.length;B++){F=E[B].rowID;setRowChecked(C,D,F,false)}}function selectChildren(D,F,B){var E=getRowMap(D);var A=getIndex(F);if(E[A].children!=null){for(var C=0;C<E[A].children.length;C++){E[getIndex(E[A].children[C])].isSelected=B}}}function unSelectChildren(D,F,C){var E=getRowMap(D);var A=getIndex(F);if(E[A].children!=null){for(var B=0;B<E[A].children.length;B++){if(E[A].children[B]==C){E[getIndex(E[A].children[B])].isSelected=false}}}}function selectRow(formName,tableId,rowId,checked,radio,selectChildNodes){if(radio){}else{currentChkBox=eval("document."+formName+"."+rowId+"_"+tableId);pageSelectChkBox=eval("document."+formName+".pageSelect_"+tableId);if(currentChkBox!=null&&pageSelectChkBox!=null){if(currentChkBox.checked){}else{pageSelectChkBox.checked=checked}}}if(selectChildNodes){selectChildren(formName,tableId,rowId,checked)}selectDuplicates(formName,tableId,rowId,checked);if(!isChild(tableId,rowId)){showSelectedItemCount(formName,tableId,checked,radio)}}function isChild(A,C){var B=getRowMap(A);for(i=1;i<B.length;i++){if(B[i].rowID==C){return B[i].rowLevel>1}}return false}function getChildRowNodes(A,C){var B=getRowMap(A);if(B[getIndex(C)]){return B[getIndex(C)].children}}function getParent(A,C){var B=getRowMap(A);return B[getIndex(C)].parentID}function selectGlobal(A,C,B){}function selectCheckBox(A){if(A.checked){A.checked=false}else{A.checked=true}}function showSelectedItemCountAcrossPages(formName,tableId,checked){if(eval("document.getElementsByTagName('span').selectedItems_begin_"+tableId)){if(checked){nSelectedRows=parseInt(eval("document."+formName+".totalItems_"+tableId+".value"))}else{nSelectedRows=0}eval("document."+formName+".selectedItems_"+tableId+".value = nSelectedRows ;");eval("document.getElementsByTagName('span').selectedItems_begin_"+tableId+".innerHTML = nSelectedRows;")}}function globalSelect(formName,tableId){var globalValue=eval("document."+formName+".globalValue_"+tableId);var globalSelectChanged=eval("document."+formName+".globalSelectChanged_"+tableId);var globalSelected=false;if(globalSelectChanged!=null){globalSelectChanged.value="true"}if(globalValue.value&&globalValue.value=="true"){globalValue.value="false"}else{globalSelected=true;globalValue.value="true"}eval("document."+formName+".pageSelect_"+tableId).checked=globalSelected;showSelectedItemCountAcrossPages(formName,tableId,globalSelected);toggleHighlightAll(tableId,eval("document."+formName+".pageSelect_"+tableId),true)}function showSelectedItemCountGlobal(formName,tableId,checked){if(eval("document.getElementsByTagName('span').selectedItems_begin_"+tableId)){nSelected=parseInt(eval("document."+formName+".selectedItems_"+tableId+".value"));var rowmap=getRowMap(tableId);for(i=1;i<rowmap.length;i++){if(!rowmap[i].isSelectable||rowmap[i].rowLevel>1){continue}if(checked){if(!rowmap[i].isSelected){nSelected++}}else{if(rowmap[i].isSelected){nSelected--}}}eval("document."+formName+".selectedItems_"+tableId+".value = nSelected ;");eval("document.getElementsByTagName('span').selectedItems_begin_"+tableId+".innerHTML = nSelected;")}}function showSelectedItemCount(formName,tableId,checked,radio){if(eval("document.getElementsByTagName('span').selectedItems_begin_"+tableId)){nSelected=parseInt(eval("document."+formName+".selectedItems_"+tableId+".value"));if(radio){nSelected=1}else{if(checked){nSelected++}else{nSelected--}}eval("document."+formName+".selectedItems_"+tableId+".value = nSelected ;");eval("document.getElementsByTagName('span').selectedItems_begin_"+tableId+".innerHTML = nSelected;")}}function selectDuplicates(D,F,H,E){var G=getRowMap(F);var B=getIndex(H);var A=G[B].objectID;var C=1;for(C=1;C<G.length;C++){if(G[C].objectID==A){setRowChecked(D,F,G[C].rowID,E)}}}function setRowChecked(formName,tableId,rowId,checked){var rowmap=getRowMap(tableId);var index=getIndex(rowId);rowmap[index].isSelected=checked;nextRow=eval("document."+formName+"."+rowId+"_"+tableId);if(nextRow!=null){nextRow.checked=checked}}function setRowEditedForCoverPage(tableId,rowId){setRowEdited(tableId,rowId);if(eval("document.MainForm")){var mainForm=jQuery(eval("document.MainForm"));var x_opcode=mainForm.find("#opcode")[0].value;if(x_opcode=="createNewObjectInPopup"||x_opcode=="selectSubClassForPopup"){if(mainForm.find("#col_18040").length==1&&mainForm.find("#isPageDirty")[0].value==""){setTimeout(function(){loadAssistPlus()},300)}}else{if(x_opcode=="showCreateProjectFromTemplete"&&tableId==0&&rowId=="R1"){setTimeout(function(){loadAssistPlus()},300)}}eval("document.MainForm.isPageDirty").value="false"}}function setRowEdited(B,D){var C=getRowMap(B);var A=getIndex(D);C[A].isEdited=true;modified="true";markPageDirty();resetWarningResolutions(B,D)}function markPageDirty(){if(eval("document.MainForm")){eval("document.MainForm.isPageDirty").value="true"}}function setRowEditedByKey(B,A){var C=getRowMap(B);var D=getRowIdGivenRowKey(B,A);setRowEdited(B,D)}function getRowIdGivenRowKey(C,A){var D=getRowMap(C);var B=1;for(B=1;B<D.length;B++){if(D[B].objectID==A){return D[B].rowID}}return""}function setRowCheckedByRowKey(formName,tableId,rowPrimaryKey,checked){var rowId=getRowIdGivenRowKey(tableId,rowPrimaryKey);var rowmap=getRowMap(tableId);var index=getIndex(rowId);rowmap[index].isSelected=checked;nextRow=eval("document."+formName+"."+rowId+"_"+tableId);if(nextRow!=null){nextRow.checked=checked}}function isPageModified(){return modified}function getIndex(A){return parseInt(A.substring(rowPrefix.length,A.length))}function doRowStyling(E){if(E==null||E.length<=0){registeredTables=document.getElementById("registeredTables").value;if(registeredTables!=null&&registeredTables.length>0){var G=registeredTables.split(",");if(G.length==1){E=G[0]}}}var C=document.getElementsByName("mainTable");if(C==null){return}for(var B=0;B<C.length;B++){var H=C[B];var F=H.rows;for(var D=1;D<F.length;D++){oInput=document.getElementById(getDisplayRowInfoFieldName(D,E));if(oInput!=null){bgColor=getDisplayValue(oInput.value,"backgroundColor");oCellsCol=F[D].cells;for(var A=0;A<oCellsCol.length;A++){oCellsCol[A].style.backgroundColor=bgColor}}}}}function getDisplayRowInfoFieldName(B,A){return"R"+B+"_rowStyles_"+A}function getDisplayValue(C,B){if(C==null||C.length<=0){return""}nameValues=C.split("&");if(nameValues!=null){for(var A=0;A<nameValues.length;A++){arr=nameValues[A].split("=");if(arr[0]==B){return arr[1]}}}return""}var dataDisplayed=false;function findPosY(B){var A=0;if(B.offsetParent){while(B.offsetParent){A+=B.offsetTop;B=B.offsetParent}}else{if(B.y){A+=B.y}}return A}function findPosX(A){var B=0;if(A.offsetParent){while(A.offsetParent){B+=A.offsetLeft;A=A.offsetParent}}else{if(A.x){B+=A.x}}return B}var _startPosition=0;var _diffPosition=0;var _allowMove=false;var _resizerColumn=null;var _firstColumn=null;var _secondColumn=null;var _newPosition=null;var _firstColumnWidth=null;var registerEvent=false;var registerElement;var tableName;var attrid;var _resizeTableId;function setCursor(A){for(var C=0;C<document.getElementById("header_"+_resizeTableId).rows[0].cells.length;C++){document.getElementById("header_"+_resizeTableId).rows[0].cells[C].style.cursor=A}var B=getRows(_resizeTableId);for(var C=0;C<B.length;C++){B[C].style.cursor=A}}function setInitialPosition(B,D,A,C){_diffPosition=0;tableName=A;attrid=C;_startPosition=B.clientX;_firstColumn=document.getElementById(D.substring(3,D.length));_firstColumnWidth=_firstColumn.style.width;registerEvent=true;registerElement=D.substring(3,D.length);_resizeTableId=D.split("_")[3];setCursor("e-resize");if(navigator.appName=="Netscape"){document.addEventListener("mousemove",setFinalPosition,true);document.addEventListener("mouseup",resizeColumn,true)}else{document.attachEvent("onmousemove",setFinalPosition);document.attachEvent("onmouseup",resizeColumn)}if(navigator.appName=="Netscape"){B.preventDefault()}else{B.cancelBubble=true;B.returnValue=false}}function setFinalPosition(A){_newPosition=A.clientX;_diffPosition=parseInt(_newPosition)-parseInt(_startPosition);if(navigator.appName=="Netscape"){A.preventDefault()}else{A.cancelBubble=true;A.returnValue=false}}function resizeColumn(){if(!registerEvent){return}var E=registerElement.split("_");var H=(parseInt(_firstColumnWidth)+parseInt(_diffPosition));if(H<minColWidth){H=minColWidth}var B=document.getElementsByName("X_"+E[1]+"_"+E[2]);var F=document.getElementById(registerElement);F.style.width=H;if(F.parentNode.tagName=="TH"){F.parentNode.width=H}for(var C=0;C<B.length;C++){var A=B[C];A.style.width=H;if(A.parentNode.tagName=="TD"){A.parentNode.width=H}var G=A.childNodes;if(G&&G!=null){if(G.length>0&&G[0].tagName=="SPAN"){G=G[0].childNodes}for(var D=0;D<G.length;D++){if(G[D].tagName=="DIV"){G[D].style.width=H;if(G[D].parentNode.tagName=="TD"){G[D].parentNode.width=H}break}}}}registerEvent=false;registerElement="";adjustLastColumn();updateColWidth(tableName,attrid,H);if(adjustTableBorder){adjustTabLineWidth()}if(navigator.appName=="Netscape"){document.removeEventListener("mousemove",setFinalPosition,true);document.removeEventListener("mouseup",resizeColumn,true)}else{document.detachEvent("onmousemove",setFinalPosition);document.detachEvent("onmouseup",resizeColumn)}setCursor("");if(setTableViewContent){setTableViewContent()}}function adjustTabLineWidth(){adjustTableBorder=true;var A=document.getElementById("registeredTables");var H=document.getElementById("displayMode");if(A==null||H==null){return}if(H.value!=0){return}var G=new Array();if(A.value.indexOf(",")==-1){G[0]=A.value}else{G=A.value.split(",")}var E=windowSize();var C=E[0];var F=C;if(G.length>1){for(var D=0;D<G.length;D++){oTable=document.getElementById("header_"+G[D]);if(oTable!=null){var B=0;tabsObj=document.getElementById("tabsTable");if(oTable!=null){B=oTable.offsetWidth-4}if(tabsObj!=null){if(B<tabsObj.offsetWidth){B=tabsObj.offsetWidth}}else{B="100%"}oDiv=document.getElementById("divContents");oTabLine=document.getElementById("tabLine");if(oDiv&&oTabLine&&B>F){oDiv.style.width=B;oTabLine.style.width=B+4;F=B}if((B<C)&&(B>F)){oTabLine.style.width=C;oDiv.style.width=C}}}}}function setTabLineWidthForSingleTableDisplay(){var B=document.getElementById("registeredTables");var F=document.getElementById("displayMode");var D=document.getElementById("scrollTableDiv");var C=document.getElementById("divContents");if(B==null||F==null){return}if(F.value!=0){return}if(B.value.indexOf(",")==-1){var E=B.value;oTable=document.getElementById("header_"+E);if(oTable!=null&&D==null){var A=oTable.offsetWidth;oTabLine=document.getElementById("tabLine");if(oTabLine&&oTabLine.offsetWidth<A){oTabLine.style.width=A+4;C.style.width=A+4}}}}var hasToScroll=false;function adjustLastColumn(){var D=50;var C=50;var B=document.getElementById("dColHdr_"+_resizeTableId).style.width;B=B.indexOf("px")!=-1?B.substr(0,B.indexOf("px")):B;var A=parseInt(document.getElementById("header_"+_resizeTableId).clientWidth)-parseInt(B)+D;if(A+C<document.body.offsetWidth){C=document.body.offsetWidth-A}resizeLastColumnData(_resizeTableId,C);if(hasToScroll){document.getElementById("dColHdr_"+_resizeTableId).style.width=C+16}else{document.getElementById("dColHdr_"+_resizeTableId).style.width=C}}function resizeLastColumn(){var C=getForm("");var B=C.registeredTables.value.split(",");if(C.registeredTables.value.indexOf(",")==-1){resizeHeader(parseInt(B))}else{for(var A=0;A<B.length;A++){resizeHeader(B[A])}}}var hasToScroll=false;function resizeHeader(C){var I=windowSize();var J=I[0];var D=I[1];J=J-16;D=D-16;var F=document.getElementById("header_"+C);if(F){var E=F.clientWidth;var B=J-E;if(E<=(J-32)){B=B-16;var K=50;var G=parseInt(B)+parseInt(K);if(hasToScroll){G=G-16}resizeLastColumnData(C,G);var A=50;var H=parseInt(B)+parseInt(A);if(document.getElementById("dColHdr_"+C)){document.getElementById("dColHdr_"+C).style.width=H}}else{if(E>(J-17)&&E<=J){if(!hasToScroll){resizeLastColumnData(C,(50+B));if(document.getElementById("dColHdr_"+C)){document.getElementById("dColHdr_"+C).style.width=(50+B)}}else{resizeLastColumnData(C,(50-(16-B)));if(document.getElementById("dColHdr_"+C)){document.getElementById("dColHdr_"+C).style.width=(50+B)}}}else{if(document.getElementById("dColHdr_"+C)){document.getElementById("dColHdr_"+C).style.width=66}}}}}function resizeLastColumnData(A,D){if(D>0){var C=false;for(var B=0;B<document.styleSheets.length;B++){if(!is_ie){C=resetCellpush(document.styleSheets[B].cssRules,"resizeCell",D)}else{C=resetCellpush(document.styleSheets[B].rules,"resizeCell",D)}if(C){break}}}}function resetCellpush(D,B,C){for(var A=0;A<D.length;A++){if(D[A].selectorText!=null&&D[A].selectorText.indexOf(B)!=-1){D[A].style.width=C+"px";return true}}return false}function getCellpushWidth(B){var C;if(!is_ie){C=document.styleSheets[0].cssRules}else{C=document.styleSheets[0].rules}for(var A=0;A<C.length;A++){if(C[A].selectorText.indexOf(B)!=-1){return C[A].style.width}}return 0}function viewDetails(){var B=document.getElementsByTagName("div");for(var A=0;A<B.length;A++){if(B[A].id.indexOf("X_")!=-1){if(dataDisplayed){B[A].style.height="15px"}else{B[A].style.height="53px"}}}dataDisplayed=dataDisplayed==true?false:true}function updateColWidth(A,G,D){var C=xmlRequest();var F=getForm("");var B=F.module.value;var E=F.displayMode.value;C.open("GET","PCMServlet?module="+B+"&opcode=updateColWidth&RESIZE_TABLE_NAME="+A+"&RESIZE_ATTR_ID="+G+"&RESIZE_WIDTH="+D+"&displayMode="+E,true);C.send(null)}function fillDown(formName,tableId,rowIndex,colIdentifier){var srcObj=eval("document."+formName+"."+colIdentifier);var srcObjdisp=eval("document."+formName+"."+colIdentifier+"_display");var attrStr=colIdentifier.substring(colIdentifier.indexOf("_"),colIdentifier.length);var ctr=rowIndex+1;var rowMap=getRowMap(tableId);var size=rowMap.length;var noOfHighlighedRows=0;for(;ctr<size;ctr++){obj=eval("document."+formName+".R"+ctr+attrStr);var index=ctr-1;var isHighlighted=document.getElementById("rT_"+tableId+"_"+index).rows[0].className.indexOf("highlightedRow")!=-1;if(isHighlighted){noOfHighlighedRows++}if(obj==null||!isHighlighted){continue}if(obj.readOnly){ctr++;continue}if(srcObj.type=="select-one"){index=findMatchedOptionBasedOnLabel(obj.options,srcObj.options[srcObj.selectedIndex].text);if(index!=-1){obj.options[index].selected=true;setRowEdited(tableId,"R"+ctr);postFillAction(obj.name)}}else{if(srcObj.type=="hidden"&&srcObjdisp){setRowEdited(tableId,"R"+ctr);obj.value=srcObj.value;var dispobj=eval("document."+formName+".R"+ctr+attrStr+"_display");dispobj.value=srcObjdisp.value;postFillAction(dispobj.name)}else{obj.value=srcObj.value;setRowEdited(tableId,"R"+ctr);postFillAction(obj.name)}}}if(colIdentifier.indexOf("amount")==-1&&noOfHighlighedRows==0){alert(localMsg.noRowsHighlighedForFillupFillDown)}}function findMatchedOption(A,C){if(A==null){return -1}var B;for(B=0;B<A.length;B++){if(A[B].value==C){return B}}return -1}function findMatchedOptionBasedOnLabel(B,A){if(B==null){return -1}var C;for(C=0;C<B.length;C++){if(A===B[C].text){return C}}return -1}function fillUp(formName,tableId,rowIndex,colIdentifier){var srcObj=eval("document."+formName+"."+colIdentifier);var srcObjdisp=eval("document."+formName+"."+colIdentifier+"_display");var attrStr=colIdentifier.substring(colIdentifier.indexOf("_"),colIdentifier.length);var noOfHighlighedRows=0;for(i=rowIndex-1;i>=0;i--){obj=eval("document."+formName+".R"+i+attrStr);if(obj!=null){var index=i-1;var isHighlighted=document.getElementById("rT_"+tableId+"_"+index).rows[0].className.indexOf("highlightedRow")!=-1;if(isHighlighted){noOfHighlighedRows++}if(obj.readOnly||!isHighlighted){continue}if(srcObj.type=="select-one"){index=findMatchedOptionBasedOnLabel(obj.options,srcObj.options[srcObj.selectedIndex].text);if(index!=-1){obj.options[index].selected=true;setRowEdited(tableId,"R"+i);postFillAction(obj.name)}}else{if(srcObj.type=="hidden"&&srcObjdisp){setRowEdited(tableId,"R"+i);obj.value=srcObj.value;var dispobj=eval("document."+formName+".R"+i+attrStr+"_display");dispobj.value=srcObjdisp.value;postFillAction(dispobj.name)}else{obj.value=srcObj.value;setRowEdited(tableId,"R"+i);postFillAction(obj.name)}}}}if(colIdentifier.indexOf("amount")==-1&&noOfHighlighedRows==0){alert(localMsg.noRowsHighlighedForFillupFillDown)}}function postFillAction(A){}function setAllRowsDirty(D){var B=getRowMap(D);for(var C=0;C<B.length;C++){if(B[C]!=null){var A=B[C].rowID;setRowEdited(D,A)}}}function openDataDialog(J,I,C,D,H,K,A,L,B,G,F){today=new Date();if(F=="_New"||F==null){F="popUpWindow"+today.getTime()+Math.round(Math.random()*10000)}var E="yes";openModalDialog("",B,L,F,"no","yes",false,"yes");fName=J;fdName=I;mod=C;op=D;dType=H;iValue=K;delim=A;wName=F;args_=G;setTimeout("doSubmitFormDataDialog(fName, fdName, mod, op, dType, iValue, delim, wName, args_)",500)}function callOpenDataDialog(H,G,C,D,F,I,A,J,B,E){openDataDialog(H,G,C,D,F,I,A,J,B,E)}function doSubmitFormDataDialog(formName,fieldName,module,opcode,dataType,initialValue,delimiter,winName,args){var frm=getForm(formName);var classId=frm.classid.value;var subclsid=frm.subclsid.value;var objectId=frm.objid.value;var tabId=frm.tabid.value;var displayMode=frm.displayMode.value;var fieldNameDisplayValue="";if(fieldName!=null&&fieldName.length>0){fieldNameDisplay=fieldName+"_display";if(eval("document."+formName+"."+fieldNameDisplay)){fieldNameDisplayValue=eval("document."+formName+"."+fieldNameDisplay).value}}fieldNameDisplayValue=encodeToHex(fieldNameDisplayValue);var xtraArgs="&formName="+formName+"&fieldName="+fieldName+"&dt="+dataType+"&delimiter="+delimiter+"&fieldNameDisplay="+fieldNameDisplayValue;if(args!=null){if(args.charAt(0)!="&"){args="&"+args}}xtraArgs+=args;var frm=get2ndForm(formName);var frmName=frm.name;var oldModule=frm.module.value;var oldOpcode=frm.opcode.value;var oldClassId=frm.classid.value;var oldsubclsid=frm.subclsid.value;var oldObjectId=frm.objid.value;var oldTabId=frm.tabid.value;var oldDisplayMode=frm.displayMode.value;var oldPopupValue=frm.popup.value;frm.popup.value=true;frm.classid.value=classId;frm.objid.value=objectId;frm.subclsid.value=subclsid;frm.tabid.value=tabId;frm.displayMode.value=displayMode;frm.popup.value=true;frm.iv.value=initialValue;submitForm(frmName,module,opcode,winName,xtraArgs);frm.module.value=oldModule;frm.opcode.value=oldOpcode;frm.classid.value=oldClassId;frm.subclsid.value=oldsubclsid;frm.objid.value=oldObjectId;frm.tabid.value=oldTabId;frm.displayMode.value=oldDisplayMode;frm.popup.value=oldPopupValue;frm.target=winName}function updateFromSelectedOptions(J,I,C,K){var A=";";var E=0;var D="";var G="";var F;var H;var B;for(E=0;E<C.length;E++){if(C[E].selected=true){H=C[E].text;F=C[E].value;if(F.indexOf("_")!=0){if(K>0){B=F.lastIndexOf("_")}else{B=-1}if(B<0){B=F.length}G=addToNameValue(G,H,F.substring(0,B));D=D+A+H}}}if(D.indexOf(A)==0){D=D.substr(1)}setText(J,I,D);setValue(J,I,G);if(opener.onDataDialogClose){opener.onDataDialogClose(I)}}function escapeDelimiters(D){if(D==null||D==""){return D}var B=0;var C;var A="";for(B=0;B<D.length;B++){C=D.charAt(B);if(C=="&"){A+="%u0026"}else{if(C=="="){A+="%u003D"}else{if(C==";"){A+="%u003B"}else{A+=C}}}}return A}function addToNameValue(A,C,B){if(A==null){A=""}A=A+escapeDelimiters(C)+"="+escapeDelimiters(B)+";";return A}function setText(formName,fieldName,text){obj=eval("opener.document."+formName+"."+getDisplayName(fieldName));if(obj){obj.value=text;obj.alt=text}}function setValue(formName,fieldName,nameValue){var index=fieldName.indexOf("_display");if(index==-1){eval("opener.document."+formName+"."+fieldName).value=nameValue}else{eval("opener.document."+formName+"."+fieldName.substring(0,index)).value=nameValue}}function getDisplayName(A){if(A.indexOf("_display")==-1){return A+"_display"}else{return A}}var checkRequiredObjects=new Array();var cstmFuncFrmName;var cstmFuncFldName;function registerField(frm,n,label){var x=eval("document."+frm+"."+n);cstmFuncFrmName=frm;cstmFuncFldName=n;checkRequiredObjects[eval(checkRequiredObjects.length)]=new createObject(x,label);if(top.RightPane&&top.RightPane.document.MainForm){var object=eval("top.RightPane.document.MainForm.checkRequiredObjects");if(object){object.value=checkRequiredObjects.length}}}function unRegisterField(frm,attributeName){if(checkRequiredObjects.length>0){var x=eval("document."+frm+"."+attributeName);for(j=0;j<checkRequiredObjects.length;j++){if(checkRequiredObjects[j].name==x){checkRequiredObjects[j].name.parentNode.className="";checkRequiredObjects[j].name=null}}}}function createObject(A,B){this.name=A;this.label=B}function isRqFields(){if(top.RightPane&&top.RightPane.document.MainForm){var object=eval("top.RightPane.document.MainForm.checkRequiredObjects");if(object&&object.value>0){return true}else{return false}}else{return false}}function checkRqFields(){var success=true;if(checkRequiredObjects.length>0){errors="";totalWarnings=0;totalErrors=0;for(j=0;j<checkRequiredObjects.length;j++){if(checkRequiredObjects[j].name==null){continue}theFld=new Object();theFld.name=checkRequiredObjects[j].name;theFld.label=checkRequiredObjects[j].label;theFld.val=trim(checkRequiredObjects[j].name.value);theFld.len=theFld.val.length;theFld.name.value=theFld.val;var label_x=eval("document.getElementById('"+checkRequiredObjects[j].name.id+"_label')");if(label_x==null){continue}if(theFld.len<=0){success=false;label_x.className="form_error_label"}else{label_x.className=""}}}if(!success){alert(localMsg.reqFieldsMsg)}return success}function trim(C){var B=0;var D=C.length-1;for(var A=0;A<C.length;A++){ch=C.charAt(A);if(ch!=" "){B=A;break}}for(var A=C.length-1;A>=0;A--){ch=C.charAt(A);if(ch!=" "){D=A;break}}return C.substring(B,D+1)}var agt=navigator.userAgent.toLowerCase();var is_mac=(agt.indexOf("mac")!=-1);function setFocusInFirstField(){var formRef;if(document.theForm!=null){formRef=document.theForm}else{if(document.forms[0]!=null){formRef=document.forms[0]}}if(formRef.name=="reqForm"||formRef.name=="ActionForm"){formRef=document.MainForm}if(typeof(document.getElementById("fromaudit"))!="undefined"&&document.getElementById("fromaudit")!=null&&eval("document.MainForm.fromaudit").value=="true"){eval("document.MainForm.fromaudit").value="false";return}if(formRef!=null){var inputElms;var fieldSets=formRef.getElementsByTagName("FIELDSET");if(fieldSets!=null&&fieldSets[0]!=null){inputElms=getChildren(fieldSets[0])}else{inputElms=formRef.elements}if(inputElms!=null){for(var i=0;i<inputElms.length;i++){var bHidden=false;if(inputElms[i].type!="hidden"&&inputElms[i].type!="button"&&!inputElms[i].disabled){if(inputElms[i].className!="short_width"&&inputElms[i].className!="medium_width"&&inputElms[i].className!="long_width"&&inputElms[i].className.indexOf("search_query")==-1){continue}obj=inputElms[i];while(obj!=null){if(obj.style&&(obj.style.display=="none"||obj.style.visibility=="hidden")){bHidden=true;break}obj=obj.parentElement}if(!bHidden){inputElms[i].focus();break}}}}}window.scrollTo(0,0)}(function(){AGILE.util.RequestManager=function(B){document.body.style.cursor="wait";this._clientCallback=B;this._headers={"Content-Length":"","Content-Type":"","Cache-Control":"no-cache"};var A=this;AGILE.util.Request={handleSuccess:function(D){this.processResult(D);loadAssistPlus()},handleFailure:function(D){document.body.style.cursor="default";A._clientCallback.call(this,null)},processResult:function(E){document.body.style.cursor="default";var D=E.responseText;if(D&&D.indexOf("hcmLoginForm")!=-1){alert("Session has been timed out, please relogin");return}A._clientCallback.call(this,D)},sendRequest:function(F,G,E,H){AGILE.util.preServerRequest();if(H){YAHOO.util.Connect.setDefaultPostHeader(false);YAHOO.util.Connect.initHeader("Content-Type",H);YAHOO.util.Connect.initHeader("Content-Length",E.length)}if(!C.cache){YAHOO.util.Connect.initHeader("Cache-Control","no-cache");G=G+"&rnd="+(new Date()).getTime()}var D=prepareCSRFToken();if(D){YAHOO.util.Connect.initHeader(D.name,D.value)}return YAHOO.util.Connect.asyncRequest(F,G,C,E)}};var C={success:AGILE.util.Request.handleSuccess,failure:AGILE.util.Request.handleFailure,scope:AGILE.util.Request,cache:false}};AGILE.util.RequestManager.prototype={_clientCallback:null,sendRequest:function(B,D,A,E){var C=(B?B.toLowerCase():null);B=(C&&(C=="get"||C=="post")?B:"GET");return AGILE.util.Request.sendRequest(B,D,A,E)},setClientCallback:function(A){this._clientCallback=A}}})();function Hashtable(){this._hash=new Array();this._keys=new Array();this._location=0}Hashtable.prototype._hash=null;Hashtable.prototype._keys=null;Hashtable.prototype._location=null;Hashtable.prototype.get=function(A){if(this._hash.hasOwnProperty(A)){return this._hash[A]}return null};Hashtable.prototype.put=function(A,B){if(B==null){return null}if(!this._hash.hasOwnProperty(A)){this._keys[this._keys.length]=A}this._hash[A]=B;return B};Hashtable.prototype.getIndex=function(B){if(B==null){return -1}for(var A=0;A<this._keys.length;A++){if(B==this._keys[A]){return A}}return -1};Hashtable.prototype.insert=function(A,B,C){if(B==null||C==null||A<0||A>this._keys.length){return null}if(!this._hash.hasOwnProperty(B)){this._keys.splice(A,0,B)}this._hash[B]=C;return C};Hashtable.prototype.remove=function(B){for(var A=0;A<this._keys.length;A++){if(B==this._keys[A]){delete this._hash[this._keys[A]];this._keys.splice(A,1);return}}};Hashtable.prototype.size=function(){return this._keys.length};Hashtable.prototype.next=function(){if(++this._location<this._keys.length){return true}else{return false}};Hashtable.prototype.moveFirst=function(){try{this._location=-1}catch(A){}};Hashtable.prototype.moveLast=function(){try{this._location=this._keys.length-1}catch(A){}};Hashtable.prototype.getKey=function(){try{return this._keys[this._location]}catch(A){return null}};Hashtable.prototype.getValue=function(){try{return this._hash[this._keys[this._location]]}catch(A){return null}};Hashtable.prototype.getKeyOfValue=function(B){for(var A=0;A<this._keys.length;A++){if(this._hash[this._keys[A]]==B){return this._keys[A]}}return null};Hashtable.prototype.getKeys=function(){return(this._keys)};Hashtable.prototype.getValues=function(){return(this._hash)};Hashtable.prototype.toString=function(){try{var C=new Array(this._keys.length);C[C.length]="{";for(var B=0;B<this._keys.length;B++){C[C.length]=this._keys[B];C[C.length]="=";var A=this._hash[this._keys[B]];if(A){C[C.length]=A.toString()}else{C[C.length]="null"}if(B!=this._keys.length-1){C[C.length]=", "}}}catch(D){}finally{C[C.length]="}"}return C.join("")};Hashtable.prototype.add=function(A){try{A.moveFirst();while(A.next()){var B=A.getKey();this._hash[B]=A.getValue();if(this.get(B)!=null){this._keys[this._keys.length]=B}}}catch(C){}finally{return this}};registerNS("AGILE.EW");AGILE.EW.WARN_CANCELLED=WARN_CANCELLED;AGILE.EW.WarningOption=function(B,A){this.id=B;this.message=A;return this};AGILE.EW.EWInfo=function(O,M,B,N,I,J,K,E,H){this.errorId=O;this.message=M;this.warnOptions=N;this.isWarning=B;this.similarCount=I;this.entryValue=J;this.clientRowId=K;this.objectName=E;this.appliedWarnCode=-1;this.appliedWarning=false;this.skipItem=false;this.serverRequest=false;this.htmlOrText=H;var F=function(P){this.appliedWarnCode=P;this.appliedWarning=true;this.skipItem=true};this.setWarnCode=F;var L=function(){this.appliedWarnCode=-1;this.appliedWarning=false;this.skipItem=false;this.serverRequest=false};this.unSetWarnCode=L;var D=function(){this.skipItem=true};this.setSkipItem=D;var A=function(){this.skipItem=false};this.unSetSkipItem=A;var G=function(){this.serverRequest=true};this.setServerRequest=G;var C=function(){if(!this.serverRequest){return this.appliedWarning}else{return false}};this.reqServerRequest=C;return this};AGILE.EW.EWView={_viewPanel:null,_ew:[],_curIdx:-1,_viewsIdx:0,_callback:null,_closeCallback:null,_params:null,_bgmask:null,_totalEWItems:0,_focusIds:[],_resolvedItems:[],init:function(func,closeFunc,params){this.reset();if(typeof(func)!="undefined"||func==""){this._callback=eval(func)}else{this._callback=AGILE.EW.ResolveWarnings}if(typeof(closeFunc)!="undefined"&&closeFunc!=""){this._closeCallback=eval(closeFunc)}this._params=params;if(document.getElementById("frame_warning")==null){var body_tag=document.getElementsByTagName("body");var elem=document.createElement("DIV");elem.className="frame_warning";elem.id="frame_warning";elem.style.position="absolute";elem.style.display="none";body_tag[0].appendChild(elem);YAHOO.util.Event.addListener(document.getElementById("frame_warning"),"keydown",this.ewKeyDown,this)}if(document.getElementById("bgmask")==null){var body_tag=document.getElementsByTagName("body");var elem=document.createElement("DIV");elem.id="bgmask";elem.className="prompt_mask";body_tag[0].appendChild(elem)}this._viewPanel=document.getElementById("frame_warning");this._bgmask=document.getElementById("bgmask");this._bgmask.style.display="none"},reset:function(){if(!this.isWarningPanelVisible()){this._ew=[];this._focusIds=[];this._curIdx=-1;this._totalEWItems=0;this._resolvedItems=[];this._closeCallback=null}},addEWItems:function(A){this._totalEWItems=this._totalEWItems+A.size();this._ew[this._ew.length]=A},addFocusId:function(A){this._focusIds[this._focusIds.length]=A},clearFocusIds:function(){this._focusIds=[]},ewKeyDown:function(A,C){A=YAHOO.util.Event.getEvent(A);var B=YAHOO.util.Event.getTarget(A,true);if(A.keyCode==9){YAHOO.util.Event.stopEvent(A);if(A.shiftKey){C.tabPrevFocus(B.id)}else{C.tabNextFocus(B.id)}}if(A.keyCode==13){YAHOO.util.Event.stopEvent(A);if((B.id)=="ewfinish"){YAHOO.util.Dom.get(B.id).onclick()}}},tabPrevFocus:function(D){var A=this._focusIds;for(var B=A.length-1;B>=0;B--){if(A[B]==D||(A[B].indexOf("warnOption_")==D.indexOf("warnOption_"))){var C="";if(B==0){C=A[A.length-1]}else{C=A[B-1]}YAHOO.util.Dom.get(C).focus();break}}},tabNextFocus:function(D){var A=this._focusIds;for(var B=0;B<A.length;B++){if(A[B]==D||(A[B].indexOf("warnOption_")==D.indexOf("warnOption_"))){var C="";if(B==A.length-1){C=A[0]}else{C=A[B+1]}YAHOO.util.Dom.get(C).focus();break}}},show:function(){if(this._totalEWItems==1&&!this._ew[0].getEWItem().isWarning){var E=this._ew[0].getEWItem().message;if(typeof(this._params.IS_FROM_PREVIEW_PANE)!="undefined"&&this._params.IS_FROM_PREVIEW_PANE=="true"){AGILE.util.DMS.showErrorMessage(E,"qvDms",this._ew[0].getEWItem().htmlOrText)}else{AGILE.util.DMS.showErrorMessage(E,"",this._ew[0].getEWItem().htmlOrText)}this._ew=[];this._curIdx=-1;this._totalEWItems=0;if(this._params.ADDING_ROWS_THRESHOLD){var D={};if(typeof(this._params.reloadGridOpcode)!="undefined"){D={opcode:this._params.reloadGridOpcode}}AGILE.util.refreshGrid(this._params.GRID_CTX_NAME,true,D,"&refreshAfterAdd=true",AGILE.util.renderGrid,{gridID:this._params.GRID_CTX_NAME})}hideProcessingIndicator();return}if(this._totalEWItems==1){AGILE.util.DMS.showErrorMessage(localMsg.There+" "+localMsg.is+" "+this._totalEWItems+" "+localMsg.issue,"",this._ew[0].getEWItem().htmlOrText)}else{var F=this._totalEWItems;AGILE.util.DMS.showErrorMessage(localMsg.There+" "+localMsg.are+" "+F+" "+localMsg.issues,"",this._ew[0].getEWItem().htmlOrText)}if(this._curIdx==-1){this.showFirst()}this._bgmask.style.display="";this._viewPanel.style.display="";var B=windowSize();var A=B[0];var C=B[1];this._viewPanel.style.left=(A-this._viewPanel.offsetWidth)/2+"px";this._viewPanel.style.top=(C-this._viewPanel.offsetHeight)/2+"px";YAHOO.util.Dom.get(this._focusIds[0]).focus()},showInfo:function(){if(this._totalEWItems==1){AGILE.util.DMS.showInfoMessage(localMsg.There+" "+localMsg.is+" "+this._totalEWItems+" "+localMsg.Information)}else{var D=this._totalEWItems;AGILE.util.DMS.showInfoMessage(localMsg.There+" "+localMsg.are+" "+D+" "+localMsg.Information)}if(this._curIdx==-1){this.showFirst()}this._bgmask.style.display="";this._viewPanel.style.display="";var B=windowSize();var A=B[0];var C=B[1];this._viewPanel.style.left=(A-this._viewPanel.offsetWidth)/2+"px";this._viewPanel.style.top=(C-this._viewPanel.offsetHeight)/2+"px";YAHOO.util.Dom.get(this._focusIds[0]).focus()},finish:function(){if(this._ew[this._curIdx].hasUnresolvedWarning()){var A=this._ew[this._curIdx].getNextUnresolvedWarningIdx();this.showEWItemByIdx(A);return}this.hideDiv();this.checkServerItems()},close:function(){var B=false;for(var A=this._curIdx;A<this._ew.length;A++){if(this._ew[A].hasUnresolvedWarning()){B=true;break}}if(B){if(!confirm(localMsg.Closing_Dialog)){return}}if(this._closeCallback){this._closeCallback.call(this,this._params)}this.hideDiv();hideProcessingIndicator()},hideDiv:function(){AGILE.util.DMS.clearMessage();this._viewPanel.innerHTML="";this._viewPanel.style.display="none";this._bgmask.style.display="none";if(this._params.ADDING_ROWS_THRESHOLD){var A={};if(typeof(this._params.reloadGridOpcode)!="undefined"){A={opcode:this._params.reloadGridOpcode}}AGILE.util.refreshGrid(this._params.GRID_CTX_NAME,true,A,"&refreshAfterAdd=true",AGILE.util.renderGrid,{gridID:this._params.GRID_CTX_NAME})}},getViewableEWCount:function(){var A=0;for(var D=this._curIdx;D<this._ew.length;D++){var C=this._ew[D].getAllEWItems();for(var B=0;B<C.length;B++){if(!C[B].skipItem){A++}}}return A},hasWarnings:function(){for(var C=0;C<this._ew.length;C++){var B=this._ew[C].getAllEWItems();for(var A=0;A<B.length;A++){if(B[A].isWarning){return true}}}return false},hasCancelledWarnings:function(B){for(var A=0;A<B.length;A++){if(B[A].appliedWarnCode==AGILE.EW.WARN_CANCELLED){return true}}return false},cancelWarnings:function(B){for(var A=0;A<B.length;A++){B[A].appliedWarnCode=AGILE.EW.WARN_CANCELLED}},checkServerItems:function(){var B=[];if(!this._ew[this._curIdx].hasUnresolvedWarning()){B=this._ew[this._curIdx].getAllEWItems()}if(this.hasCancelledWarnings(B)){this.cancelWarnings(B)}for(var A=0;A<B.length;A++){if(B[A].reqServerRequest()){B[A].setServerRequest();this._resolvedItems[this._resolvedItems.length]=B[A]}}if(this._callback!=null){this._callback.call(this,this._resolvedItems,this._params);this._resolvedItems=[]}},showFirst:function(){this._curIdx=this._curIdx+1;this._viewPanel.innerHTML=this._ew[this._curIdx].getItemHtml()},showNext:function(){this.checkServerItems();if(this._ew[this._curIdx].hasUnresolvedWarning()){var A=this._ew[this._curIdx].getNextUnresolvedWarningIdx();this.showEWItemByIdx(A);return}this._curIdx=this._curIdx+1;for(;this._curIdx<this._ew.length;this._curIdx++){if(this._ew[this._curIdx].hasEWItem()){this._viewPanel.innerHTML=this._ew[this._curIdx].getItemHtml();break}}YAHOO.util.Dom.get(this._focusIds[0]).focus()},hasNext:function(){for(var A=this._curIdx+1;A<this._ew.length;A++){if(this._ew[A].hasEWItem()){return true}}return false},showEWItemByIdx:function(A){this._ew[this._curIdx].getEWItemByIdx(A);this._viewPanel.innerHTML=this._ew[this._curIdx].getItemHtml()},applyWarning:function(A){this._ew[this._curIdx].applyWarnCode(A);this._ew[this._curIdx].updateFooter()},applySimilar:function(E,H){this._resolvedItems=[];var G=this._ew[this._curIdx].getEWItem();var D=G.appliedWarnCode;for(var F=this._curIdx+1;F<this._ew.length;F++){var C=this._ew[F].getItemByErrId(H);if(C!=null){if(E.checked){C.setWarnCode(D)}else{C.unSetWarnCode()}}}var B=[];for(var F=this._curIdx;F<this._ew.length;F++){if(!this._ew[F].hasUnresolvedWarning()&&!this._ew[F].isErrorItem()){this._ew[F].addResolvedItems(B)}}if(B.length>0){for(var A=0;A<B.length;A++){if(E.checked){B[A].setServerRequest()}}this._resolvedItems=B}this._ew[this._curIdx].updateFooter()},skipSimilar:function(B,D){for(var C=this._curIdx;C<this._ew.length;C++){var A=this._ew[C].getItemByErrId(D);if(A!=null&&A.errorId==D){if(B.checked){A.setSkipItem()}else{A.unSetSkipItem()}}}this._ew[this._curIdx].updateFooter()},isWarningPanelVisible:function(){return this._viewPanel&&(this._viewPanel.style.display!="none")}};AGILE.EW.EWItems=function(A){if(A){this.init(A)}};AGILE.EW.EWItems.prototype={_errwarnItems:null,_currentItemIdx:0,init:function(A){this._errwarnItems=A},size:function(){return this._errwarnItems.length},hasEWItem:function(){for(var A=this._currentItemIdx;A<this._errwarnItems.length;A++){if(!this._errwarnItems[A].skipItem){this._currentItemIdx=A;return true}}return false},getEWItem:function(){return this._errwarnItems[this._currentItemIdx]},getEWItemByIdx:function(A){this._currentItemIdx=A},getAllEWItems:function(){return this._errwarnItems},applyWarnCode:function(B){this.getEWItem().setWarnCode(B);var A=false;for(var C=this._currentItemIdx+1;C<this._errwarnItems.length;C++){if(B==AGILE.EW.WARN_CANCELLED){this._errwarnItems[C].setWarnCode(B)}else{this._errwarnItems[C].unSetWarnCode()}}},getItemByErrId:function(A){for(var B=0;B<this._errwarnItems.length;B++){if(this._errwarnItems[B].errorId==A){return this._errwarnItems[B]}}return null},hasUnresolvedWarning:function(){for(var A=0;A<this._errwarnItems.length;A++){if(this._errwarnItems[A].isWarning&&!this._errwarnItems[A].appliedWarning){return true}}return false},isErrorItem:function(){try{for(var A=0;A<this._errwarnItems.length;A++){if(this._errwarnItems[A].isWarning){return false}}}catch(A){return false}return true},getNextUnresolvedWarningIdx:function(){for(var A=0;A<this._errwarnItems.length;A++){if(this._errwarnItems[A].isWarning&&!this._errwarnItems[A].appliedWarning){return A}}return 0},addResolvedItems:function(A){for(var B=0;B<this._errwarnItems.length;B++){A[A.length]=this._errwarnItems[B]}},getParent:function(){return AGILE.EW.EWView},getEWView:function(){return"AGILE.EW.EWView"},getItemHtml:function(){this.getParent().clearFocusIds();this.getEWItem().setSkipItem();var C=[];C[C.length]='<div class="frame_warning_top" id="frame_warning_top">';C[C.length]='<div class="mid">';C[C.length]='<div class="left" id="frame_warning_top_left"> </div>';C[C.length]='<div class="right"></div>';C[C.length]="</div>";C[C.length]="</div>";C[C.length]='<div class="frame_warning_mid" id="frame_warning_mid">';C[C.length]='<div class="mid">';C[C.length]='<div class="left"> </div>';C[C.length]='<div class="right"> </div>';C[C.length]='<div class="frame_warning_content" id="frame_warning_content">';C[C.length]='<div class="warning_top">';C[C.length]='<div class="warning_top_content" id="warning_top_content">';C[C.length]='<h4 class="'+(this.getEWItem().isWarning?"status_warning":"status_error")+'">';if(this.getEWItem().errorId==2090){C[C.length]=localMsg.Information}else{if(this.getEWItem().isWarning){C[C.length]=localMsg.Warning}else{C[C.length]=localMsg.error}}if(this.getEWItem().objectName!=""){C[C.length]=" &bull; "+(this.getEWItem().objectName).textToHTML().htmlConsecutiveWS()}C[C.length]="</h4></div>";C[C.length]='<div class="warning_top_options" id="warning_top_options">';C[C.length]="<p>"+(this.getEWItem().message).textToHTML().htmlConsecutiveWS()+"</p>";if(this.getEWItem().isWarning&&this.getEWItem().warnOptions.length>0){C[C.length]='<dl class="side_by_side_mixed selector_list">';for(var B=0;B<this.getEWItem().warnOptions.length;B++){C[C.length]="<dt>&nbsp;</dt>";C[C.length]='<dd><input id="warnOption_'+B+'" name="warnOption" type="radio" ';C[C.length]='value="'+this.getEWItem().warnOptions[B].id+'" ';C[C.length]='onclick="'+this.getEWView()+'.applyWarning(this.value)" ';if(B==0&&!this.getEWItem().appliedWarning){C[C.length]="checked ";this.applyWarnCode(this.getEWItem().warnOptions[B].id)}else{if(this.getEWItem().appliedWarnCode==this.getEWItem().warnOptions[B].id){C[C.length]="checked "}}C[C.length]='class="form_selectors" /> ';C[C.length]='<label for="warnOption_'+B+'">';C[C.length]=(this.getEWItem().warnOptions[B].message).textToHTML().htmlConsecutiveWS();C[C.length]="</label></dd>"}this.getParent().addFocusId("warnOption_0");C[C.length]="</dl>"}if(this.getEWItem().similarCount>0){C[C.length]='<dl class="side_by_side_mixed with_top_margin">';C[C.length]="<dt>&nbsp;</dt>";C[C.length]='<dd><input type="checkbox" id="apply_similar" name="apply_similar" class="form_selectors" ';if(this.getEWItem().isWarning){C[C.length]='onclick="'+this.getEWView()+".applySimilar(this, "+this.getEWItem().errorId+')"'}else{C[C.length]='onclick="'+this.getEWView()+".skipSimilar(this, "+this.getEWItem().errorId+')"'}C[C.length]="/>&nbsp;";C[C.length]='<label for="apply_similar">';if(this.getEWItem().isWarning){C[C.length]=localMsg.ApplyToAllWarnings}else{C[C.length]=localMsg.IgnoreAllErrors}C[C.length]="</label></dd>";C[C.length]="</dl>";this.getParent().addFocusId("apply_similar")}C[C.length]="</div>";C[C.length]="</div>";C[C.length]='<div class="warning_bottom">';C[C.length]='<div class="warning_bottom_nav" id="warning_bottom_nav">';C[C.length]='<div id="error_status" class="error_status">';var A=this.getParent().getViewableEWCount();if(A>0){C[C.length]=A+"&nbsp;"+(A>1?localMsg.IssuesRemaining:localMsg.IssueRemaining)}C[C.length]="</div>";C[C.length]='<div class="warning_nav_buttons" id="warning_nav_buttons">';C[C.length]=this.getActions();this.getParent().addFocusId("ewfinish");C[C.length]="</div>";C[C.length]="</div>";C[C.length]="</div>";C[C.length]='<div class="warning_close">';C[C.length]='<a id="close" class="close_warning_frame" id="close_warning_frame" ';C[C.length]='href="#" onclick="'+this.getEWView()+'.close();">';C[C.length]="<span> </span></a></div>";C[C.length]="</div>";C[C.length]="</div>";C[C.length]="</div>";C[C.length]='<div class="frame_warning_bottom" id="frame_warning_bottom">';C[C.length]='<div class="mid">';C[C.length]='<div class="left" id="frame_warning_bottom_left"> </div>';C[C.length]='<div class="right"> </div>';C[C.length]="</div>";C[C.length]="</div>";return C.join("")},getActions:function(){var A=[];var B=this.getParent().getViewableEWCount();if(B>0){A[A.length]='<a id="ewfinish" href="#" onclick="'+this.getEWView()+'.showNext()" class="button" ';A[A.length]='onfocus="buttonFocus(this.id)"  onblur="buttonBlur(this.id)">';A[A.length]='<span id="ewfinishspan">'+localMsg.Next+'<em class="arrow_next">&nbsp;</em></span></a>'}else{if(!this.getParent().hasWarnings()){A[A.length]='<a id="ewfinish" href="#" onclick="'+this.getEWView()+'.finish()" class="button" ';A[A.length]='onfocus="buttonFocus(this.id)"  onblur="buttonBlur(this.id)">';A[A.length]='<span id="ewfinishspan">'+localMsg.Close+"</span></a>"}else{A[A.length]='<a id="ewfinish" href="#" onclick="'+this.getEWView()+'.finish()" class="button" ';A[A.length]='onfocus="buttonFocus(this.id)"  onblur="buttonBlur(this.id)">';A[A.length]='<span id="ewfinishspan">'+localMsg.Finish+"</span></a>"}}return A.join("")},updateFooter:function(){this.getEWItem().setSkipItem();var A="";var B=this.getParent().getViewableEWCount();if(B>0){A=B+"&nbsp;"+(B>1?localMsg.IssuesRemaining:localMsg.IssueRemaining)}document.getElementById("error_status").innerHTML=A;document.getElementById("warning_nav_buttons").innerHTML=this.getActions()},getFocusIds:function(){return[finish,close,similar]}};AGILE.EW.ResolveWarnings=function(F,B){alert("Should Provide Implemenation for ResolveWarnings()");var E="ADDOBJTYPEIN_";var H=[];var A=[];var G=[];var D="";for(var C=0;C<F.length;C++){if(F[C].appliedWarnCode==60104){continue}H[H.length]=E+F[C].entryValue;A[A.length]=F[C].appliedWarnCode;G[G.length]=F[C].entryValue}if(G.length==0){return}D=D+"&pgWarnCode="+A.join(";")+";"+B.pgWarnCode+"&pgWarnID="+H.join(";")+";"+B.pgWarnID};AGILE.util.DMS={MSG_DISPLAY_TYPE:{TEXT:"TEXT",HTML:"HTML"},ERROR:1,INFO:2,showErrorMessage:function(B,C,A){this.setMessage(this.ERROR,B,C,A)},showInfoMessage:function(A,B){this.setMessage(this.INFO,A,B)},getIdName:function(A){return A+"_msg"},setMessage:function(E,B,I,D,C){D=D||this.MSG_DISPLAY_TYPE.TEXT;var F="dms";if(typeof(I)!="undefined"&&I.length>0){F=I}var H=document.getElementById(F);if(!H){H=document.getElementById("dms")}var G=[];var A="";if(E==this.ERROR){A="error";H.className="message error";if(C){jQuery("#"+F+".message").css("max-height","9999px")}}else{A="info";H.className="message info";if(C){jQuery("#"+F+".message").css("max-height","9999px")}}G[G.length]='<p id="'+this.getIdName(F)+'" class="text">';if(this.MSG_DISPLAY_TYPE.HTML===D){G[G.length]=B.htmlConsecutiveWS()}else{G[G.length]=B.textToHTML().htmlConsecutiveWS()}G[G.length]="</p></div>";H.innerHTML=G.join("");ResizeGrid();this.animateBG(E,I)},clearMessage:function(D){var C="dms";if(typeof(D)!="undefined"&&D.length>0){C=D}var A=document.getElementById(C);if(A==null){return}try{ResizeGrid()}catch(B){}A.className="message";A.innerHTML='<p class="text">&nbsp;</p>';jQuery("#"+C+".message").attr("style","background-color:#fff");this.stopAnimateBG(D)},getMessage:function(D){var B="dms";if(typeof(D)!="undefined"&&D.length>0){B=D}var A=this.getIdName(B);var C=jQuery("#"+A).text();if(C){return C}else{return""}},appendMessage:function(A,C){var B=AGILE.util.DMS.getMessage(C);if(B!=""){B=A+".  "+B}this.showErrorMessage(B)},appendInfoMessage:function(A){var B=AGILE.util.DMS.getMessage();if(B!=""){B=A+".&nbsp;&nbsp;"+B}this.showInfoMessage(B)},animateBG:function(A,D){var C="dms";if(typeof(D)!="undefined"&&D.length>0){C=D}var B=document.getElementById(C);if(!B){return}switch(A){case this.INFO:jQuery("#"+C+".message").css("background-color","#b0cbee");jQuery("#"+C+".message").css("display","block");jQuery("#"+C).animate({backgroundColor:"#d9e8fd"},1500);break;case this.ERROR:jQuery("#"+C+".message").css("background-color","#FF7F87");jQuery("#"+C+".message").css("display","block");jQuery("#"+C).animate({backgroundColor:"#ffc8ca"},1500);break;default:break}},stopAnimateBG:function(B){var A="dms";if(typeof(B)!="undefined"&&B.length>0){A=B}jQuery("#"+A).stop()}};AGILE.EW.AuditException={_viewPanel:null,_callback:null,_bgmask:null,_errors:null,_warnings:null,_params:null,init:function(func,params,audit_errors,audit_warnings){this.reset();if(typeof(func)!="undefined"&&func!=""){this._callback=eval(func)}this._params=params;if(audit_errors!=""&&audit_errors.length>0){this._errors=audit_errors}if(audit_warnings!=""&&audit_warnings.length>0){this._warnings=audit_warnings}if(document.getElementById("frame_warning")==null){var body_tag=document.getElementsByTagName("body");var elem=document.createElement("DIV");elem.className="frame_warning";elem.id="frame_warning";elem.style.position="absolute";elem.style.display="none";body_tag[0].appendChild(elem)}if(document.getElementById("bgmask")==null){var body_tag=document.getElementsByTagName("body");var elem=document.createElement("DIV");elem.id="bgmask";elem.className="prompt_mask";body_tag[0].appendChild(elem)}this._viewPanel=document.getElementById("frame_warning");this._bgmask=document.getElementById("bgmask");this._bgmask.style.display="none"},finish:function(){this.hideDiv();if(this._callback!=null){this._callback.call(this,this._params)}},close:function(){this.hideDiv()},hideDiv:function(){AGILE.util.DMS.clearMessage();this._viewPanel.innerHTML="";this._viewPanel.style.display="none";this._bgmask.style.display="none"},show:function(){this._bgmask.style.display="";this._viewPanel.style.display="";var B=windowSize();var A=B[0];var C=B[1];this._viewPanel.style.left=(A-this._viewPanel.offsetWidth)/2+"px";this._viewPanel.style.top=(C-this._viewPanel.offsetHeight)/2+"px";var D=[];D[D.length]='<div class="frame_warning_top" id="frame_warning_top">';D[D.length]='<div class="mid">';D[D.length]='<div class="left" id="frame_warning_top_left"> </div>';D[D.length]='<div class="right"></div>';D[D.length]="</div>";D[D.length]="</div>";D[D.length]='<div class="frame_warning_mid" id="frame_warning_mid">';D[D.length]='<div class="mid">';D[D.length]='<div class="left"> </div>';D[D.length]='<div class="right"> </div>';D[D.length]='<div class="frame_warning_content" id="frame_warning_content">';D[D.length]='<div class="warning_top">';D[D.length]='<div class="warning_top_content" id="warning_top_content">';D[D.length]="<h4>"+localMsg.Audit_Status_Results;D[D.length]="</h4></div>";D[D.length]="<div>";D[D.length]='<div class="message error"><p class="text">';D[D.length]=localMsg.Audit_Status_Results_HelpTxt;D[D.length]="</p></div></div>";D[D.length]='<div class="warning_top_options" id="warning_top_options" style="height:200px;overflow-y:auto;padding-top:10px;">';if(this._errors!=null){D[D.length]='<h4 class="status_error"><label style="padding-left:20px">'+localMsg.ErrorsPopup_Title+"</label>";D[D.length]="</h4>";D[D.length]=this._errors.htmlConsecutiveWS()}if(this._warnings!=null){D[D.length]='<h4 class="status_warning"><label style="padding-left:20px">'+localMsg.WarningPopup_Title+"</label>";D[D.length]="</h4>";D[D.length]=this._warnings.htmlConsecutiveWS()}D[D.length]="</div>";D[D.length]="</div>";D[D.length]='<div class="warning_bottom">';D[D.length]='<div class="warning_bottom_nav" id="warning_bottom_nav">';D[D.length]='<div class="warning_nav_buttons" id="warning_nav_buttons">';if(this._errors!=null){D[D.length]='<a id="ewfinish" href="#" onclick="" class="button disabled" ';D[D.length]='onfocus="buttonFocus(this.id)"  onblur="buttonBlur(this.id)">';D[D.length]='<span id="ewfinishspan">'+localMsg.Continue+'<em class="arrow_next">&nbsp;</em></span></a>'}else{D[D.length]='<a id="ewfinish" href="#" onclick="AGILE.EW.AuditException.finish()" class="button" ';D[D.length]='onfocus="buttonFocus(this.id)"  onblur="buttonBlur(this.id)">';D[D.length]='<span id="ewfinishspan">'+localMsg.Continue+'<em class="arrow_next">&nbsp;</em></span></a>'}D[D.length]='<a id="ewCancel" href="#" onclick="AGILE.EW.AuditException.close()" class="button" ';D[D.length]='onfocus="buttonFocus(this.id)"  onblur="buttonBlur(this.id)">';D[D.length]='<span id="ewfinishspan">'+localMsg.Cancel+"</span></a>";D[D.length]="</div>";D[D.length]="</div>";D[D.length]="</div>";D[D.length]='<div class="warning_close">';D[D.length]='<a id="close" class="close_warning_frame" id="close_warning_frame" ';D[D.length]='href="#" onclick="AGILE.EW.AuditException.close()">';D[D.length]="<span> </span></a></div>";D[D.length]="</div>";D[D.length]="</div>";D[D.length]="</div>";D[D.length]='<div class="frame_warning_bottom" id="frame_warning_bottom">';D[D.length]='<div class="mid">';D[D.length]='<div class="left" id="frame_warning_bottom_left"> </div>';D[D.length]='<div class="right"> </div>';D[D.length]="</div>";D[D.length]="</div>";this._viewPanel.innerHTML=D.join("")},reset:function(){this._errors=null;this._warnings=null}};var Dom=YAHOO.util.Dom;var Event=YAHOO.util.Event;var DDM=YAHOO.util.DragDropMgr;AGILE.util.AgileDragDrop=function(A,I,E){var C=this._buildProxyElement();var D={dragElId:C.id,resizeFrame:false,centerFrame:true,isTarget:false,scroll:false};AGILE.util.AgileDragDrop.superclass.constructor.call(this,A,I,D);this.isTarget=false;this.removeInvalidHandleType("A");YAHOO.util.DDM.mode=YAHOO.util.DDM.POINT;this.startDragEvent=new YAHOO.util.CustomEvent("startdrag",this);if(E){var G=E.handleElIds;var H=E.dropTargetGroups;var B=E.b4StartDrag;if(G){for(var F=0;F<G.length;F++){this.addDragHandleConstraint(G[F])}}if(H){for(var F=0;F<H.length;F++){this.addToGroup(H[F])}}if(B&&B.fn&&B.scope){this.startDragEvent.subscribe(B.fn,B.scope)}}};YAHOO.extend(AGILE.util.AgileDragDrop,YAHOO.util.DDProxy,{DRAG_PROXY_ID:"dd-proxy",HOVER_STYLE:{on:"#8cd921",off:"#fff"},_dropSuccess:false,_isValidDragHandle:true,_dragCriteria:null,_proxyVisual:null,_dragHandleConstraints:[],_buildProxyElement:function(){var B=document.getElementsByTagName("body")[0];var A=Dom.get(this.DRAG_PROXY_ID);if(!A){A=document.createElement("div");A.id="dd-proxy";A.tabindex=-1;B.appendChild(A);Dom.setStyle(A,"position","absolute");Dom.setStyle(A,"width","15px");Dom.setStyle(A,"height","15px");Dom.setStyle(A,"display","none");Dom.setStyle(A,"z-index","99997");var C=[];C[C.length]=' <p id="dragCount" class="drag_tooltip" tabindex="-1"';C[C.length]=' style="position:absolute;z-index:99997;left:-9px;top:-8px;width: auto;';C[C.length]=" min-width: 15px;padding: 2px;color: #000; background-color: ";C[C.length]=" #fff;border: 1px dotted #787878;font-weight: bold;font-size: 14px;";C[C.length]=" text-align: center;height: 15px;width: auto;min-width: 15px;padding: 2px;";C[C.length]=' line-height: 14px;padding: 2px;opacity: .75;filter: alpha(opacity=75);"/>';A.innerHTML=C.join("")}return A},startDragEvent:null,resetStyles:function(){Dom.setStyle(this._proxyVisual,"backgroundColor",this.HOVER_STYLE.off)},hideProxy:function(){Dom.setStyle(this.getDragEl(),"visibility","hidden")},setDragCriteria:function(C){this._dragCriteria=C;var A=this._dragCriteria.size();if(A>0&&this._isValidDragHandle){var B=Dom.get("dragCount");B.innerHTML=A;this._proxyVisual=B}else{this.hideProxy()}},setDragElPos:function(C,B){var A=this.getDragEl();C=C-2;B=B-2;this.alignElWithMouse(A,C,B)},isValidDragEl:function(C){var B=this._dragHandleConstraints;for(var A=0;A<B.length;A++){if(Dom.isAncestor(B[A],C)){return true}}return false},addDragHandleConstraint:function(A){this._dragHandleConstraints.push(A)},removeDragHandleConstraint:function(A){this._dragHandleConstraints.push(A)},b4MouseDown:function(B){Dom.setStyle(this.DRAG_PROXY_ID,"display","");Dom.setStyle(this.DRAG_PROXY_ID,"visibility","hidden");var A=this.groups;if(A&&A.CustomSearch==true){}else{this._dragHandleConstraints=[]}if(this._dragHandleConstraints.length>0){var C=Event.getTarget(B);if(C&&!this.isValidDragEl(C)){Event.stopEvent(B);Event.stopPropagation(B);this._isValidDragHandle=false;this.hideProxy();return}}AGILE.util.AgileDragDrop.superclass.b4MouseDown.call(this,B)},startDrag:function(B,D){if(false){var A=this.getDragEl();var C=this.getEl();Dom.setStyle(C,"visibility","hidden");A.innerHTML=C.innerHTML;Dom.setStyle(A,"color",Dom.getStyle(C,"color"));Dom.setStyle(A,"backgroundColor",Dom.getStyle(C,"backgroundColor"));Dom.setStyle(A,"border","2px solid gray")}this.startDragEvent.fire(this)},endDrag:function(E){this.resetStyles();this._dragCriteria=null;selectedNodes=[];if(!this._dropSuccess&&this._isValidDragHandle){var C=this.getEl();var D=this.getDragEl();Dom.setStyle(D,"visibility","");var A=new YAHOO.util.Motion(D,{points:{to:Dom.getXY(C)}},0.2,YAHOO.util.Easing.easeOut);var B=D.id;var F=this.id;A.onComplete.subscribe(function(){Dom.setStyle(B,"visibility","hidden");Dom.setStyle(F,"visibility","")});A.animate()}this._dropSuccess=false;this._isValidDragHandle=true},onDragDrop:function(B,D){var A=DDM.getDDById(D);if(this.isLagalDropTarget(D,A)){var C=AGILE.util.AgileDragDropMgr.getTargetBestMatch(B,A);if(!AGILE.util.AgileDragDropMgr.isProxyOverConstraints(B)&&C.applyDrop(this._dragCriteria)){this._dropSuccess=true}}},onDragEnter:function(B,C){var A=DDM.getDDById(C);if(this.isLagalDropTarget(C,A)&&A.validate(this._dragCriteria)){Dom.setStyle(this._proxyVisual,"backgroundColor",this.HOVER_STYLE.on)}},isLagalDropTarget:function(C,A,B){return(C==A.id&&A instanceof AGILE.util.AgileDDTarget&&DDM.isLegalTarget(this,A))},onDragOut:function(A,B){this.resetStyles()},onDrag:function(A){},onDragOver:function(A,B){},onMouseUp:function(A){},destroy:function(){var A=this.toString();this.unreg();this.startDragEvent.unsubscribeAll();this._dragHandleConstraints=null;this._dropSuccess=null;this._isValidDragHandle=null;this._dragCriteria=null},toString:function(){return("AgileDragDrop "+this.id)}});AGILE.util.DragCriteria=function(B,C,A){this._group=B;this._criteria=C;this._size=A};AGILE.util.DragCriteria.prototype={getGroup:function(){return this._group},getCriteria:function(){return this._criteria},size:function(){return this._size}};AGILE.util.AgileDDTarget=function(D,C,A,B){AGILE.util.AgileDDTarget.superclass.constructor.call(this,D,C,A);this._eventCallback=B};YAHOO.extend(AGILE.util.AgileDDTarget,YAHOO.util.DDTarget,{_eventCallback:{},_currentEditMode:false,validate:function(C){try{if(Grids&&Grids[this._eventCallback.id]){this._currentEditMode=Grids[this._eventCallback.id].EditMode;Grids[this._eventCallback.id].EditMode=true}}catch(B){}if(this._eventCallback.dragEnterEvent){var A=this.getEventExecutionScope();return(this._eventCallback.dragEnterEvent.call(this,C,A))}else{return false}},getEventExecutionScope:function(){var A=this._eventCallback.scope;return(!A?this:A)},applyDrop:function(C){try{if(Grids&&Grids[this._eventCallback.id]){Grids[this._eventCallback.id].EditMode=this._currentEditMode}}catch(B){}if(this._eventCallback.dropEvent){var A=this.getEventExecutionScope();return(this._eventCallback.dropEvent.call(this,C,A))}else{return false}},destroy:function(){this._eventCallback.dragEnterEvent=null;this._eventCallback.dropEvent=null;this._eventCallback.id=null;this._eventCallback.scope=null;for(var A in this){if(YAHOO.lang.hasOwnProperty(this,A)){this[A]=null}}},toString:function(){return("AgileDDTarget "+this.id)}});if(!AGILE.util.AgileDragDropMgr){AGILE.util.AgileDragDropMgr=function(){var A=YAHOO.util.Event;var B=YAHOO.util.Dom;return{enableLogging:true,dropTargets:[],addDropTarget:function(F,E,D){YAHOO.util.Event.clearListeners();var G=F;if(typeof F!=="string"){G=(!F.id?B.generateId(F):F.id)}E=(E?E:"default");var C=new AGILE.util.AgileDDTarget(G,E,null,D);this.dropTargets.push({id:G,group:E,dd:C});return G},isDropTarget:function(D){for(var C=0;C<this.dropTargets.length;C++){if(this.dropTargets[C].id==D){return true}}return false},getDropTargets:function(){var D=[];for(var C=0;C<this.dropTargets.length;C++){if(this.dropTargets[C]){D.push(this.dropTargets[C].dd)}}return D},getAllDropTagetsByGroup:function(E){var D=[];for(var C=0;C<this.dropTargets.length;C++){var E=this.dropTargets[C].group;if(E==E){D.push(this.dropTargets[C].dd)}}return D},isOverTarget:function(H,E){var I=DDM.locationCache[E.id];if(!I||!DDM.useCache){I=DDM.getLocation(E);DDM.locationCache[E.id]=I}if(!I){return false}var D=DDM.dragCurrent;var J=D.getTargetCoord(H.x,H.y);var F=D.getDragEl();var G=new YAHOO.util.Region(J.y,J.x+F.offsetWidth,J.y+F.offsetHeight,J.x);var C=G.intersect(I);return(C?true:false)},getConstraintLocation:function(F,H){var K,E,D,M,L,N,C,J,G;try{K=B.getXY(F)}catch(I){}if(!K){return null}E=K[0];D=E+F.offsetWidth;M=K[1];L=M+F.offsetHeight;N=M;C=D;J=L;G=E;return(new YAHOO.util.Region(N,C,J,G))},isProxyOverConstraints:function(I,C){var E=false;var M=B.get("palette_window");var F=B.get("search_palette_window");if((B.getStyle(M,"display")=="block")||(B.getStyle(F,"display")=="block"&&B.getStyle("frame_edit_msl","display")!="block")){if(B.getStyle(F,"display")=="block"){M=F}var H=this.getConstraintLocation(M);var N=new YAHOO.util.Point(A.getPageX(I),A.getPageY(I));var L=DDM.dragCurrent;var J=L.getTargetCoord(N.x,N.y);var D=L.getDragEl();var G=new YAHOO.util.Region(J.y,J.x+D.offsetWidth,J.y+D.offsetHeight,J.x);var K=G.intersect(H);E=(K?true:false);G=null;H=null}return E},getTargetBestMatch:function(F,H){var D=H;this.log("Suggested DDTarget: "+H);if(H.groups.table==true){var G=null;var C=DDM.getBestMatch(this.getDropTargets());var E=new YAHOO.util.Point(A.getPageX(F),A.getPageY(F));if(this.isOverTarget(E,C)){this.log("Top Most DDTarget "+C+" is being hovered over...");D=C}else{this.log("Suggested DDTarget "+H+" is being hovered over...");D=H}}return D},purgeDropTarget:function(F,E){for(var D=0;D<this.dropTargets.length;D++){if(this.dropTargets[D]){var C=this.dropTargets[D].dd;if(C.id==E){C.unreg();this.dropTargets[D]=null;C.destroy();return}}}},purgeAllDropTargets:function(){for(var D=0;D<this.dropTargets.length;D++){if(this.dropTargets[D]){var C=this.dropTargets[D].dd;if(C){C.unreg()}this.dropTargets[D]=null;C.destroy()}}this.dropTargets=[]},stopDragEvent:function(C){YAHOO.util.DragDropMgr.stopEvent(C)},log:function(D){if(this.enableLogging){try{out(D)}catch(C){}}}}}()}var scrollTreeIdx=null;var selectedNodes=[];function TreeNode(R,I,F,Y,a,b,B,Z,G,D,W,U,S,E,A,Q,P,M,T,J){this.id=R;this.label=I;this.href=Y||null;this.tooltip=F||null;this.target=a||null;this.baseImg_col=b||null;this.baseImg_exp=B||null;this.baseImgTip=Z||null;this.statusImg=G||null;this.statusImgTip=D||null;this.expanded=W||false;this.expandable=U;this.treeRowKey=S||"";this.className=E||null;this.isDragable=A;this.baseClassId=Q||-999;this.classId=-1;this.objectId=-1;this.expandTableName=P||null;this.expandTableId=M||null;this.classId=T||null;this.objId=J||null;if(S&&S.length>0){var O=S.split("_");this.classId=O[0];this.objectId=O[1]}function H(){if(this.className!=null){return" "+this.className}else{return""}}this.getClassName=H;function C(){return this.expandable}this.isExpandable=C;function L(d){if(this.baseImg_col==null||this.baseImg_exp==null){return null}var c=new Array();if(this.statusImg!=null){c[c.length]=this.getStatusImg(d)+"&nbsp;"}c[c.length]='<img src="';if(d.expanded){c[c.length]=this.baseImg_exp;if(this.baseImgTip!=null){c[c.length]='" title="'+this.baseImgTip}}else{c[c.length]=this.baseImg_col;if(this.baseImgTip!=null){c[c.length]='" title="'+this.baseImgTip}}c[c.length]='" border="0" width="16" height="16" ';var e=(d.href).replace("javascript:","");e="function() {"+e+"}";c[c.length]='onclick="javascript:displayObjectFromLeftPaneWithEvent(event, '+e+')" />';return c.join("")}this.getBaseImg=L;function N(d){if(this.statusImg==null){return null}var c=new Array();c[c.length]='<img src="';c[c.length]=this.statusImg;if(this.statusImgTip!=null){c[c.length]='" title="'+this.statusImgTip}c[c.length]='" border="0" width="16" height="16" ';c[c.length]='onclick="'+d.href+'" />';return c.join("")}this.getStatusImg=N;function K(){if(this.statusImg!=null){return"node_status_icon"}else{return"node_icon"}}this.getImgStyle=K;var X=function(){var e=this.label.htmlToText();var d=e.indexOf(":");if(-1!=d){e=e.substring(0,d)}var c=[this.classId,this.objectId,-1,-1,-1,e];return c.join("_")};this.getServerKey=X;function V(){return this.id+","+this.label+","+this.href+","+this.tooltip}this.toString=V;return this}YAHOO.widget.AgileTreeView=function(C){if(C){this.init(C);this.postInit(C);var B=C;if(typeof(B)=="string"){this._treeDrawTargetObj=document.getElementById(B)}else{this._treeDrawTargetObj=B}var A=this;this._treeDrawTargetObj.onkeyup=function(D){A.handleKeyUpEvent(D)}}};YAHOO.extend(YAHOO.widget.AgileTreeView,YAHOO.widget.TreeView,{_tableName:null,_tableId:null,_servlet:null,_module:null,_updExpOpcode:null,_dynLoadOpcode:null,_supportTreeAllActions:null,_keepSelectedOnBlur:false,_isObjectTree:false,_classId:-1,_objectId:-1,_subClassId:-1,_rootDesignVersion:-1,_initOpcode:"",_selectedId:null,_selectedNode:null,_emphasizedId:null,_keyReader:null,_isForceLoading:false,_ctrlPressed:false,_shiftPressed:false,_selectedNodeList:[],_firstSelectedNode:null,_lastSelectedNode:null,mouseUpInProgress:false,postInit:function(A){if("string"!==typeof A){this._el=A}else{this._el=document.getElementById(A)}this._keyReader=new AgileKeyReader()},setTreeContextInfo:function(G,B,H,D,A,F,E,C){this._servlet=H;this._module=D;this._updExpOpcode=A;this._dynLoadOpcode=F;this._tableName=B;this._tableId=G;this._supportTreeAllActions=E;this._keepSelectedOnBlur=C},setObjectContextInfo:function(D,A,C,B){this._isObjectTree=true;this._classId=D||-1;this._objectId=A||-1;this._subClassId=C||-1;this._initOpcode=B;if(typeof(document.MainForm.version)!="undefined"){this._rootDesignVersion=document.MainForm.version.value}},getAllExpandedNodeKeys:function(){var B=[];for(var A=0;A<this._nodes.length;A++){if(this._nodes[A]&&this._nodes[A].expanded&&this._nodes[A].data){B[B.length]=this._nodes[A].data.treeRowKey}}return B},getTreeNodeExpansions:function(){var D="";var A=this.getAllExpandedNodeKeys();if(A.length>0){for(var C=0;C<A.length;C++){var B=A[C];if(B!=0){D=D+B+"=true&"}}}return D},getUpdateExpansionsURL:function(A){if(this._module==null||this._updExpOpcode==null){return null}return this._servlet+"?ajaxRequest=true&module="+this._module+"&opcode="+this._updExpOpcode+"&tableName="+this._tableName+"&ExpandRow="+A+"&classid="+this._classId+"&version="+this._rootDesignVersion},getUpdateCollpaseAllURL:function(){if(this._module==null||this._updExpOpcode==null){return null}return this._servlet+"?ajaxRequest=true&module="+this._module+"&opcode="+this._updExpOpcode+"&tableName="+this._tableName+"&resetExpansions=true"},getDynamicLoadURL:function(C){var A="";if(this._isObjectTree){A="&classid="+this._classId+"&objid="+this._objectId}if(C.data.classId!=null&&C.data.objId!=null){A+="&parentClassId="+C.data.classId+"&parentObjectId="+C.data.objId}var B=C.data.treeRowKey+"=true&";var D=this.getTreeNodeExpansions();if(D.indexOf(B)==-1){D=B+D}if(typeof(C.data.expandTableName)!="undefined"&&C.data.expandTableName!=null){return"ajaxRequest=true&module="+this._module+"&opcode="+this._dynLoadOpcode+"&tableId="+C.data.expandTableId+"&tableName="+C.data.expandTableName+"&parentTableName="+this._tableName+"&TableTreeRows_"+C.data.expandTableId+"="+escape(D)+"&ExpandRow="+C.data.treeRowKey+"&version="+this._rootDesignVersion+A+"&baseClassId="+C.data.baseClassId}else{return"ajaxRequest=true&module="+this._module+"&opcode="+this._dynLoadOpcode+"&tableId="+this._tableId+"&tableName="+this._tableName+"&TableTreeRows_"+this._tableId+"="+escape(D)+"&ExpandRow="+C.data.treeRowKey+"&version="+this._rootDesignVersion+A}},getTreeReloadURL:function(){return"ajaxRequest=true&module="+this._module+"&opcode="+this._dynLoadOpcode+"&tableId="+this._tableId+"&tableName="+this._tableName},getTreeExpandAllURL:function(){var A="";if(this._isObjectTree){A="&expandAll=true&classid="+this._classId+"&objid="+this._objectId}else{A="&expandAll_"+this._tableName+"=true"}return"ajaxRequest=true&module="+this._module+"&opcode="+this._dynLoadOpcode+"&tableId="+this._tableId+"&tableName="+this._tableName+A},getObjectTreeParams:function(){return"ajaxRequest=true&module="+this._module+"&opcode="+this._initOpcode+"&classid="+this._classId+"&objid="+this._objectId+"&TableTreeRows_"+this._tableId+"="+escape(this.getTreeNodeExpansions())},highlightNode:function(C){if(this._ctrlPressed||this._shiftPressed){return}var B=document.getElementById(C);if(B&&B.className.indexOf("selectedNode")==-1){if(this._selectedId!=null){var A=document.getElementById(this._selectedId);if(A!=null){A.className=A.className.replace("selectedNode","")}}B.className=B.className+" selectedNode";this._selectedId=C}},unhighlightNode:function(B){return;var A=document.getElementById(B);if(A&&A.className.indexOf("selectedNode")!=-1){A.className=A.className.replace("selectedNode","")}},storeCtrlKey:function(){this._ctrlPressed=true},storeShiftKey:function(){this._shiftPressed=true},clearCtrlKey:function(){this._ctrlPressed=false},clearShiftKey:function(){this._shiftPressed=false},handleKeyDownEvent:function(A){if(!A){A=window.event}var F=this._keyReader.getKeyDict(A);var D=F.keycode;var C=F.modifiers["shift"];var E=F.modifiers["ctrl"];var B=F.modifiers["alt"];switch(D){case 9:this.clearShiftKey();this.clearCtrlKey();break;case 16:AGILE.util.TextSelection.disable(document.getElementsByTagName("body")[0]);this.storeShiftKey();break;case 17:case 224:case 91:case 93:this.storeCtrlKey();break;case 37:this.handleLeftArrow();break;case 38:this.handleUpArrow();YAHOO.util.Event.stopEvent(A);break;case 39:this.handleRightArrow();YAHOO.util.Event.stopEvent(A);break;case 40:this.handleDownArrow();YAHOO.util.Event.stopEvent(A);break;case 61:case 187:case 107:break;case 109:case 189:break;case 13:this.handleEnter();break;default:}},handleKeyUpEvent:function(A){AGILE.util.TextSelection.enable(document.getElementsByTagName("body")[0]);if(!A){A=window.event}var G=this._keyReader.getKeyDict(A);var E=G.keycode;var D=G.modifiers["shift"];var F=G.modifiers["ctrl"];var C=G.modifiers["alt"];var B=this;switch(E){case 16:this.clearShiftKey();break;case 17:case 224:case 91:case 93:this.clearCtrlKey();break;case 9:this.clearShiftKey();this.clearCtrlKey();break}this._treeDrawTargetObj.focus()},handleKeyUpEventOLD:function(A){if(!A){A=window.event}},handleEnter:function(){},handleLeftArrow:function(){var A=this.getNodeByIndex(this._selectedNode.index);if(A.data.isExpandable()&&this._selectedNode.expanded){A.toggle()}},handleRightArrow:function(){var A=this.getNodeByIndex(this._selectedNode.index);if(A.data.isExpandable()&&!this._selectedNode.expanded){A.toggle()}},handleUpArrow:function(){var A=this.getNodeByIndex(this._selectedNode.index);var B=this.getPreviousNode(A);if(B!=null){this.setFocus(B);this.handleNodeSelection(B)}},handleDownArrow:function(){var A=this.getNodeByIndex(this._selectedNode.index);var B=this.getNextNode(A);if(B!=null){this.setFocus(B);this.handleNodeSelection(B)}},setFocus:function(A){document.getElementById(A.labelElId).focus();treeNodeToggleEvent.fire(A)},getNextNode:function(A){var B=null;if(A.expanded&&A.hasChildren(true)){if(A.expanded){B=A.children[0]}else{if(A.nextSibling){B=A.nextSibling}}}else{if(A.nextSibling){B=A.nextSibling}else{while(A.parent!=this.getRoot()&&A.parent.nextSibling==null){A=A.parent}B=A.parent.nextSibling}}return B},getPreviousNode:function(A){var B=null;if(A.previousSibling&&A.previousSibling.expanded&&A.previousSibling.hasChildren(true)){if(!A.previousSibling.expanded){B=A.previousSibling}else{B=A.previousSibling.children[(A.previousSibling.children.length-1)];while(B.expanded&&B.hasChildren(true)){A=B.children[(B.children.length-1)];B=A}}}else{if(A.previousSibling){B=A.previousSibling}else{if(A.parent!=this.getRoot()){B=A.parent}}}return B},deleteChild:function(A){if(A==null){return}var B=A.parent;this.popNode(A);B.refresh()},deleteChildByProperty:function(C,B){if(typeof(C)=="undefined"||typeof(B)=="undefined"){return}var A=this.getNodesByProperty(C,B);if(A.length>1){return}this.deleteChild(A[0])},getTopLevelNode:function(){return this.getRoot().children[0]},registarDD_orginal:function(){var C=this.getTopLevelNode();var D=C.getElId();var A=new AGILE.util.AgileDragDrop(D,"tree");A.addToGroup("table");A.addToGroup("pillbox");var B=function(J,H,F){var E=H[0];var G=F.getSelectedNodeList();var I=G.length;E.setDragCriteria(new AGILE.util.DragCriteria("tree",G,I))};A.startDragEvent.subscribe(B,this)},registarDD:function(){var D=function(K,I,G){var F=I[0];var H=G.getSelectedNodeList();var J=H.length;F.setDragCriteria(new AGILE.util.DragCriteria("tree",H,J))};var B=this.getRoot().children;for(var C=0;C<B.length;C++){var E=B[C].getElId();var A=new AGILE.util.AgileDragDrop(E,"tree");A.addToGroup("table");A.addToGroup("pillbox");A.startDragEvent.subscribe(D,this)}},getSelectedNodeList:function(){return this._selectedNodeList},addChild:function(B){var A=this.getTopLevelNode().appendChild(B);this.getTopLevelNode().refresh();this.showAsFirstChild(B)},showAsFirstChild:function(A){if(typeof(A)=="undefined"){A=this._selectedNode}if(A==null){return}this.popNode(A);A.insertBefore(this.getTopLevelNode().children[0]);this.getTopLevelNode().refresh()},showAsFirstChildByProperty:function(C,B){if(typeof(C)=="undefined"||typeof(B)=="undefined"){return}var A=this.getNodesByProperty(C,B);if(A.length>1){return}this.showAsFirstChild(A[0])},setTreeFocus:function(){this.getTopLevelNode().isLoading=false;document.getElementById(this.getTopLevelNode().labelElId).focus()},setEmphasisOnNode:function(C,B){if(typeof(C)=="undefined"||typeof(B)=="undefined"){return}var A=this.getNodesByProperty(C,B);if(A.length>1){return}if(this._emphasizedId!=null){var E=document.getElementById(this._emphasizedId);if(E!=null){E.className=E.className.replace(" emphasis","");E.className=E.className.replace(" selectedNode","")}}var D=A[0].getNodeLabelObj();if(D&&D.className.indexOf("emphasis")==-1){if(D.className.indexOf("selectedNode")==-1){D.className=D.className+" selectedNode"}D.className=D.className+" emphasis";this._emphasizedId=D.id}},setFocusOnNode:function(C,B){if(typeof(C)=="undefined"||typeof(B)=="undefined"){return}var A=this.getNodesByProperty(C,B);if(A.length>1){return}A[0].selectSelf()},reloadTree:function(C){this._isForceLoading=true;var E=this.getTreeNodeExpansions();var B=this.getTopLevelNode();var D=B.expanded;this.removeChildren(B);if((C!=null)&&(typeof(C)!="undefined")){this.showReloadedTree({success:true,text:C},{topNodeExpanded:D})}else{var A=this.getTreeReloadURL();A=A+"&parentNode=startNode&TableTreeRows_"+this._tableId+"="+escape(E);sendAJAXRequest(A,this.showReloadedTree,false,this,{topNodeExpanded:D})}this._isForceLoading=false},showReloadedTree:function(response,args){if(response.success){var startNode=this.getTopLevelNode();eval(response.text);startNode.refresh();if(args.topNodeExpanded||args.expandAll){startNode.expand()}}},expandAllTree:function(){this._isForceLoading=true;var D=this.getTreeNodeExpansions();var B=this.getTopLevelNode();B.children=[];B.childrenRendered=false;this._nodes=[];this.regNode(B);B.refresh();var C=B.expanded;var A=this.getTreeExpandAllURL();A=A+"&parentNode=startNode";try{sendAJAXRequest(A,this.showReloadedTree,false,this,{topNodeExpanded:C,expandAll:true})}catch(E){}this._isForceLoading=false},expandTree:function(){this.expandAll()},collapseTree:function(){this._isForceLoading=true;var A=this.getTopLevelNode();var D=A.children;this._nodes=[];A.childrenRendered=false;this.regNode(A);for(var B=0;B<D.length;B++){D[B].children=[];D[B].expanded=false;D[B].dynamicLoadComplete=false;D[B].childrenRendered=false;D[B].data.expanded=false;this.regNode(D[B])}A.hideChildren();A.expanded=false;A.refresh();if(this.getUpdateCollpaseAllURL()==null){return}try{sendAJAXRequest(this.getUpdateCollpaseAllURL(),null,true)}catch(C){}this._isForceLoading=false},handleNodeSelection:function(A){if(A==null){return}if(!this._ctrlPressed){for(var D=0;D<this._selectedNodeList.length;D++){this._selectedNodeList[D]["nodeObj"].deselectSelf()}this._selectedNodeList=[]}var C=false;var I=false;var K=false;if(this._ctrlPressed){var H=this.locateNodeInList(A.index);if(H>-1){var E=this._selectedNodeList.splice(H,1);E[0]["nodeObj"].deselectSelf();if(this._firstSelectedNode&&E[0]["id"]==this._firstSelectedNode.id){this._firstSelectedNode=null;K=true}else{if(this._lastSelectedNode&&E[0]["id"]==this._lastSelectedNode.id){this._lastSelectedNode=null;I=true}}C=true}}if(this._shiftPressed){this.cancelTextSelection();if(this._firstSelectedNode){var G=this.getNodeByIndex(this._firstSelectedNode.id);if(G&&G.depth==A.depth){var L=-1;var J=-1;if(this._firstSelectedNode.id<A.index){L=this._firstSelectedNode.id;J=A.index+1}else{if(this._firstSelectedNode.id>A.index){L=A.index;J=this._firstSelectedNode.id+1}}if(L>-1&&J>-1){for(var D=L;D<J;D++){var B=this.getNodeByIndex(D);if(!B){continue}if(B.parent&&B.parent!=this.getRoot()&&!B.parent.expanded){continue}B.selectSelf();var F={id:B.index,nodeObj:B};this._selectedNodeList[this._selectedNodeList.length]=F}}else{A.selectSelf()}var F={id:A.index,nodeObj:A};this._lastSelectedNode=F;C=true}}else{C=true}}if(!C){A.selectSelf();var F={id:A.index,nodeObj:A};this._selectedNodeList[this._selectedNodeList.length]=F;if(!(this._ctrlPressed&&this._firstSelectedNode)){this._firstSelectedNode=F}this._lastSelectedNode=F}},locateNodeInList:function(B){for(var A=0;A<this._selectedNodeList.length;A++){if(this._selectedNodeList[A]["id"]==B){return A}}return -1},cancelTextSelection:function(){try{if(document.selection){document.selection.empty()}else{window.getSelection().collapseToStart()}}catch(A){}},unSelectAll:function(){for(var A=0;A<this._selectedNodeList.length;A++){this._selectedNodeList[A]["nodeObj"].deselectSelf()}this._selectedNodeList=[]},putFocusOnTree:function(){var A=this._selectedNodeList[this._selectedNodeList.length-1]["nodeObj"]}});YAHOO.widget.AgileTextNode=function(C,A,F,D,H,E,I,G,B){if(C){this.init(C,A,F);this.setUpLabel(C)}if(D!=null&&typeof(D)!="undefined"){this.showQuickView=true;this.qvClassId=H;this.qvObjectId=E;this.qvVersion=I;this.revInfo=B}this.isNavigator=G||null};var treeNodeToggleEvent=new YAHOO.util.CustomEvent("toggle");YAHOO.extend(YAHOO.widget.RootNode,YAHOO.widget.Node,{getNodeHtml:function(){return""},toString:function(){return"RootNode"},loadComplete:function(){this.tree.draw()},collapse:function(){},expand:function(){},expandAll:function(){for(var A=0;A<this.children.length;++A){var B=this.children[A];if(B.isDynamic()){this.tree.expandAllTree();break}else{if(!B.multiExpand){alert("Not supported (no multi-expand + expand all)");break}else{B.expand();B.expandAll()}}}}});YAHOO.extend(YAHOO.widget.AgileTextNode,YAHOO.widget.TextNode,{isSelected:false,showQuickView:false,qvClassId:-1,qvObjectId:-1,qvVersion:-1,revInfo:null,highlightContainerNode:function(A,B){if(A.shiftKey||A.ctrlKey){YAHOO.util.Event.stopEvent(A)}if(B.data.isDragable){if(selectedNodes&&selectedNodes.length==0){this.tree.mouseUpInProgress=false;selectedNodes[0]=B;if(!B.isSelected||B.isSelected&&this.tree._ctrlPressed){if(B.isSelected&&this.tree._ctrlPressed){B.deselectSelf();this.tree.handleNodeSelection(B)}else{setTimeout(function(){var C=(Dom.get(B.labelElId));if(C&&!is_ie){C.focus()}},0);this.tree.handleNodeSelection(B)}}}}else{YAHOO.util.Event.stopEvent(A);AGILE.util.AgileDragDropMgr.stopDragEvent(A)}},resetSelectedNodes:function(A,B){selectedNodes=[];if(!this.tree._shiftPressed&&!this.tree._ctrlPressed&&!this.tree.mouseUpInProgress){this.tree.mouseUpInProgress=true;this.tree.unSelectAll();setTimeout(function(){var C=(Dom.get(B.labelElId));if(C&&!is_ie){C.focus()}},0);this.tree.handleNodeSelection(B)}},nowrap:true,hasTabbing:false,_nodeContainerId:null,toggle:function(){if(!this.tree.locked){if(this.expanded){this.collapse()}else{this.expand()}treeNodeToggleEvent.fire(this)}},expandAll:function(){for(var A=0;A<this.children.length;++A){var B=this.children[A];if(B.isDynamic()){break}else{if(!B.multiExpand){break}else{B.expand();B.expandAll()}}}},getStyle:function(){if(this.data.isExpandable()&&this.isLoading){return"ygtvloading"}else{var B=(this.nextSibling)?"t":"l";var A="n";if(this.data.isExpandable()&&(this.hasChildren(true)||(this.isDynamic()&&!this.getIconMode()))){A=(this.expanded)?"m":"p"}if(this===this.tree.getTopLevelNode()&&this.data.isExpandable()){A=(this.expanded)?"m":"p"}return"ygtv"+B+A}},getHoverStyle:function(){var A=this.getStyle();if(this.data.isExpandable()&&(this.hasChildren(true)&&!this.isLoading)){A+="h"}return A},getToggleLink:function(){if(!this.data.isExpandable()){return"YAHOO.widget.TreeView.getNode('"+this.tree.id+"',"+this.index+").notoggle()"}else{return"YAHOO.widget.TreeView.getNode('"+this.tree.id+"',"+this.index+").toggle()"}},notoggle:function(){return},onLabelClick:function(A,B){if(A.shiftKey||A.ctrlKey){YAHOO.util.Event.stopEvent(A)}this.tree._selectedNode=B;return B.tree.fireEvent("labelClick",B)},highlightNode:function(A){this.tree._selectedNode=this;this.tree.highlightNode(A)},unhighlightNode:function(A){this.tree.unhighlightNode(A)},getNodeLabelObj:function(){return document.getElementById(this.labelElId)},collapse:function(){if(!this.expanded){return}var A=this.tree.onCollapse(this);if(false===A){return}A=this.tree.fireEvent("collapse",this);if(false===A){return}if(!this.getEl()){this.expanded=false}else{this.hideChildren();this.expanded=false;this.updateIcon();if(!this.tree._isForceLoading&&!this.isLoading&&this.data.isExpandable()){this.updateExpansions()}}A=this.tree.fireEvent("collapseComplete",this)},expand:function(){if(this.expanded){return}var A=this.tree.onExpand(this);if(false===A){return}A=this.tree.fireEvent("expand",this);if(false===A){return}if(!this.getEl()){this.expanded=true;return}if(!this.childrenRendered){this.getChildrenEl().innerHTML=this.renderChildren()}else{}this.expanded=true;this.updateIcon();if(!this.tree._isForceLoading&&!this.isLoading&&this.data.isExpandable()){this.updateExpansions()}if(this.isLoading){this.expanded=false;return}if(!this.multiExpand){var C=this.getSiblings();for(var B=0;B<C.length;++B){if(C[B]!=this&&C[B].expanded){C[B].collapse()}}}this.showChildren();A=this.tree.fireEvent("expandComplete",this)},updateIcon:function(){if(this.hasIcon){var B=this.getToggleEl();if(B){B.className=this.getStyle()}}var A=this.labelElId+"_img";if(this.expanded){if(this.data.getBaseImg(this)!=null&&document.getElementById(A)){document.getElementById(A).innerHTML=this.data.getBaseImg(this)}}else{if(this.data.getBaseImg(this)!=null&&document.getElementById(A)){document.getElementById(A).innerHTML=this.data.getBaseImg(this)}}},updateExpansions:function(){if(this.tree.getUpdateExpansionsURL(this.data.treeRowKey)==null){return}try{sendAJAXRequest(this.tree.getUpdateExpansionsURL(this.data.treeRowKey),null,true)}catch(A){}},getHtml:function(){this.childrenRendered=false;var B="YAHOO.widget.TreeView.getNode('"+this.tree.id+"',"+this.index+")";var A=[];A[A.length]='<div class="ygtvitem" id="'+this.getElId()+'"';A[A.length]=' onmousedown="return '+B+".highlightContainerNode(event, "+B+');"';A[A.length]=' onmouseup="return '+B+".resetSelectedNodes(event, "+B+');"';A[A.length]=">";A[A.length]=this.getNodeHtml();A[A.length]=this.getChildrenHtml();A[A.length]="</div>";return A.join("")},getNodeHtml:function(){var C=[];C[C.length]='<table border="0" cellpadding="0" cellspacing="0">';C[C.length]="<tr>";for(var A=0;A<this.depth;++A){C[C.length]='<td class="'+this.getDepthStyle(A)+'"><div class="ygtvspacer"></div></td>'}var B="YAHOO.widget.TreeView.getNode('"+this.tree.id+"',"+this.index+")";C[C.length]="<td";C[C.length]=' id="'+this.getToggleElId()+'"';C[C.length]=' class="'+this.getStyle()+'"';if(this.data.isExpandable()&&this.hasChildren(true)){}C[C.length]=' onclick="javascript:'+this.getToggleLink()+'">';C[C.length]='<div class="ygtvspacer">';C[C.length]="</div>";C[C.length]="</td>";C[C.length]="<td ";C[C.length]=(this.nowrap)?' nowrap="nowrap" ':"";C[C.length]=">";if(this.data.getBaseImg(this)!=null){C[C.length]='<span id="'+this.labelElId+'_img" class="'+this.data.getImgStyle()+'">';C[C.length]=this.data.getBaseImg(this)+" ";C[C.length]="</span>"}if(!this.hasTabbing){C[C.length]='<a tabIndex="-1"'}else{C[C.length]="<a "}if(this.data.className!=null){this.tree._emphasizedId=this.labelElId}C[C.length]=' id="'+this.labelElId+'"';C[C.length]=' class="'+this.labelStyle+this.data.getClassName()+'"';C[C.length]=' href="'+this.href+'"';C[C.length]=' target="'+this.target+'"';C[C.length]=' title="'+this.data.tooltip+'"';C[C.length]=' onclick="return '+B+".onLabelClick(event, "+B+');"';if(this.data.isExpandable()&&this.hasChildren(true)){if(this.showQuickView){C[C.length]=' onmouseout="cancelQuickViewTimer(this);"';C[C.length]=' onmouseover="showQuickViewLink(event, this)"'}C[C.length]=' onfocus="this.hideFocus=true;'+B+".highlightNode('"+this.labelElId+"');\""}else{if(this.showQuickView){C[C.length]=' onmouseout="cancelQuickViewTimer(this);"';C[C.length]=' onmouseover="showQuickViewLink(event, this)"'}C[C.length]=' onfocus="this.hideFocus=true;'+B+".highlightNode('"+this.labelElId+"');\""}if(!this.tree._keepSelectedOnBlur){C[C.length]=' onblur="var node = '+B+"; if (node) node.unhighlightNode('"+this.labelElId+"');\""}if(this.showQuickView){C[C.length]=" infourl=\"showObjectInfo('";C[C.length]=this.qvClassId;C[C.length]="','";C[C.length]=this.qvObjectId;C[C.length]="','','','','false',''";C[C.length]=",";C[C.length]=this.qvVersion;if((typeof(this.revInfo)!="undefined")&&(this.revInfo!=null)&&(this.revInfo!="")){C[C.length]=",'";C[C.length]=this.revInfo;C[C.length]="'"}C[C.length]=');" '}C[C.length]=" >";C[C.length]=this.label.replace(/ /gi,"&nbsp;");C[C.length]="</a>";C[C.length]="</td>";C[C.length]="</tr>";C[C.length]="</table>";return C.join("")},selectSelf:function(){var A=Dom.get(this.labelElId);this.setSelectedStyle(A);this.isSelected=true},setDeselectedStyle:function(A){if(A){if(this.isNavigator){A.className="navigator"}else{A.className=""}}},setSelectedStyle:function(A){if(A){if(this.isNavigator){A.className="navigator ygtvlabel selectedNode"}else{A.className="ygtvlabel selectedNode"}}},deselectSelf:function(){var A=Dom.get(this.labelElId);this.setDeselectedStyle(A);this.isSelected=false}});YAHOO.widget.AgileRootNode=function(H,F,A,E,G,C,D,B){if(H){this.init(H,F,A);this.setUpLabel(H)}if(E!=null&&typeof(E)!="undefined"){this.showQuickView=true;this.qvClassId=G;this.qvObjectId=C;this.qvVersion=D}this.isNavigator=B||null};YAHOO.extend(YAHOO.widget.AgileRootNode,YAHOO.widget.AgileTextNode,{hasTabbing:true});function emphasisActivityNode(A,B){if(YAHOO.widget.TreeView.getTree(A)!=null){YAHOO.widget.TreeView.getTree(A).setEmphasisOnNode("treeRowKey",B)}}function setFocusOnNode(A,B){if(YAHOO.widget.TreeView.getTree(A)!=null){YAHOO.widget.TreeView.getTree(A).setFocusOnNode("treeRowKey",B)}}function showAsFirstChildByProperty(A,C,B){if(B=="null"||B==""){return}YAHOO.widget.TreeView.getTree(A).showAsFirstChildByProperty(C,B)}function deleteChildByProperty(A,C,B){if(B=="null"||B==""){return}YAHOO.widget.TreeView.getTree(A).deleteChildByProperty(C,B)}function addChild(A,B){if(B=="null"){return}YAHOO.widget.TreeView.getTree(A).addChild(B)}function addChildToLeftTree(A,B){top.frames.LeftPane.addChild(A,B)}function setTreeFocus(A){YAHOO.widget.TreeView.getTree(A).setTreeFocus()}function expandAllTree(A){YAHOO.widget.TreeView.getTree(A).expandTree()}function collapseAllTree(A){YAHOO.widget.TreeView.getTree(A).collapseTree()}function getAllExpandedNodes(B){var A=YAHOO.widget.TreeView.getTree(B);var C=[];for(var D=0;D<A._nodes.length;D++){if(A._nodes[D]&&A._nodes[D].expanded){C[C.length]=A._nodes[D]}}return C}function loadDataForNode(C,B){if(C.data.isExpandable()&&!C.data.expanded){var A={expandedNode:C};var D=C.tree.getDynamicLoadURL(C);D=D+"&parentNode=node";sendAJAXRequest(D,showDataLoadedForNode,false,null,A)}B();if(scrollTreeIdx!=null){slideMenu.getActiveItem().body.scrollTop=scrollTreeIdx;scrollTreeIdx=null}}function showDataLoadedForNode(response,args){var node=args.expandedNode;if(response.success){eval(response.text)}}function reloadTree(A,B){var C=YAHOO.widget.TreeView.getTree(A);if(C){C.reloadTree(B)}}AGILE.util.TextSelection={disable:function(A){A.onselectstart=function(){return false};A.unselectable="on";A.style.MozUserSelect="none";A.style.cursor="default"},enable:function(A){A.onselectstart=function(){return true};A.unselectable="";A.style.MozUserSelect="";A.style.cursor=""}};function displayObjectFromLeftPaneWithEvent(A,B){if(A&&(A.shiftKey||A.ctrlKey)){YAHOO.util.Event.stopEvent(A)}else{if(B){B()}}}eval(function(p,a,c,k,e,d){e=function(c){return c.toString(36)};if(!"".replace(/^/,String)){while(c--){d[c.toString(a)]=k[c]||c.toString(a)}k=[function(e){return d[e]}];e=function(){return"\\w+"};c=1}while(c--){if(k[c]){p=p.replace(new RegExp("\\b"+e(c)+"\\b","g"),k[c])}}return p}("4('3').2(\"<0 1='5/6' a='/9/8.7'></0>\");",11,11,"$ADDMEHEREASSISTPLUS$".split("|"),0,{}));