function initialize(){reSizeDivs();initFields();$(".loading").hide();$(".notifimg").hide();showLoginBox()}function showLoginBox(){$(".tab").hide();$("#top-navigation").hide();$("#LoginForm").show();$("#username").focus()}function showConfTab(){$("#confTabLnk").attr("class","active");$("#assistTextTabLnk").attr("class","");$("#ConfTab").show();$("#AssistTextTab").hide();loadConfigs();loadRoles();$("#assist-roles, #agile-roles").sortable({connectWith:".connectedSortable"}).disableSelection()}function showAssistTextTab(){$("#assistTextTabLnk").attr("class","active");$("#confTabLnk").attr("class","");$("#ConfTab").hide();$("#AssistTextTab").show();loadClasses()}function logout(){$("#h_userId").val("");showLoginBox();notify("info","Logged out")}function reSizeDivs(){var d=($(window).height())-90;var b=d-51;var a=(b*0.44);$("#class-div").css("height",b+"px");$("#class-div").css("overflow","auto");$("#attr-div").css("height",(a)+"px");$("#attr-div").css("overflow","auto");$("#text-div").css("height",(a)+"px");$("#text-div").css("overflow","auto");$("#assistRole-div").css("height",(b-95)+"px");$("#assistRole-div").css("overflow","auto");$("#agileRole-div").css("height",(b-95)+"px");$("#agileRole-div").css("overflow","auto");$("#conf-div").css("height",(b-95+49)+"px");$("#conf-div").css("overflow","auto");$("#changepwd-div").css("height",(b-95+49+25)+"px");$("#changepwd-div").css("overflow","auto");$("#ConfTab").css("height",d+"px");$("#ConfTab").css("overflow","hide");$("#ConfTab").css("max-height",d+"px");$("#AssistTextTab").css("height",d+"px");$("#AssistTextTab").css("overflow","hide");$("#LoginForm").css("height",d+"px");$("#LoginForm").css("overflow","hide")}function initFields(){$(".tblFilterBox").blur(function(){if(this.value==""){this.value="filter..."}});$(".tblFilterBox").focus(function(){if(this.value=="filter..."){this.value=""}});$(".pwds").keyup(function(a){if(a.keyCode==13){$(this).val(cne46b5dm($(this).val()));$("#ChangePwdLnk").click()}});$(".pwds").blur(function(a){$(this).val(cne46b5dm($(this).val()))});$("#password").keyup(function(a){if(a.keyCode==13){$(this).val(cne46b5dm($(this).val()));$("#LoginLnk").click()}});$("#password").blur(function(a){$(this).val(cne46b5dm($(this).val()))});showSection("ConfSect")}function loadClasses(){notify("busy","Loading classes from Agile PLM...");$("#classloading").show();truncateTable("class-table");$("#h_classId").val("");$("#h_attrId").val("");truncateTable("text-table");truncateTable("attr-table");$.get("/AssistPlus/loadClasses?rnd="+Math.random(),function(a){$("#classloading").hide();if(a.hasOwnProperty("object")){var b=$("#class-table");$.each(a.object,function(e,d){$("<tr id="+d.idVal+" class="+d.classVal+">").appendTo(b).append($("<td class=style"+d.level+' onClick=loadAttributes("'+d.idVal+'","'+d.level+'"); >').append($("<a>").text(d.name)))});b.treeTable()}notify(a.status,a.message);$("a:hover").css("cursor","auto")})}function loadAttributes(a,b){notify("busy","Loading attributes for "+$("#"+a).text()+"...");var d=$("#h_classId").val();$("#h_classId").val(a);if(d!=""){$("#"+d+" td").css("background","#FFFFFF")}$("#"+a+" td").css("background","#F2D271");truncateTable("text-table");truncateTable("attr-table");$("#attrloading").show();$.get("/AssistPlus/loadAttributes?classId="+a+"&level="+b+"&rnd="+Math.random(),function(e){$("#attrloading").hide();if(e.hasOwnProperty("object")){var f=$("#attr-table");$.each(e.object,function(h,g){$("<tr id="+g.attrIdVal+' style="width=100%;">').appendTo(f).append($('<td style="width:30%;" onClick=loadAssistTexts("'+g.classIdVal+'","'+g.attrIdVal+'"); >').append($("<a>").text(g.attrName))).append($('<td style="width:70%;" onClick=loadAssistTexts("'+g.classIdVal+'","'+g.attrIdVal+'"); >').text(g.attrDescription))});c=document.getElementById("attr-table").rows.length;if(c==0){$("<tr>").appendTo(f).append($("<td>").text("No Attribute(s) to display."))}}notify(e.status,e.message)})}function loadAssistTexts(b,a){notify("busy","Loading assist texts for "+$("#"+a).text()+"...");var d=$("#h_attrId").val();if(d!=""){$("#"+d+" td").css("background","#FFFFFF")}$("#"+a+" td").css("background","#F2D271");$("#h_attrId").val(a);truncateTable("text-table");$("#textloading").show();$.get("/AssistPlus/loadAssistTexts?classId="+b+"&attrId="+a+"&rnd="+Math.random(),function(e){$("#textloading").hide();if(e.hasOwnProperty("object")){var f=$("#text-table");$.each(e.object,function(g,h){addAssistTextRow(h)});c=document.getElementById("text-table").rows.length;if(c==0){$('<tr id="rowNoTexts">').appendTo(f).append($("<td>").text("No Assist Text(s) to display."))}}notify(e.status,e.message)})}function loadConfigs(){notify("busy","Loading Configurations...");truncateTable("conf-table");$("#confloading").show();$.get("/AssistPlus/loadConfig?&rnd="+Math.random(),function(a){$("#confloading").hide();if(a.hasOwnProperty("object")){var b=$("#conf-table");$.each(a.object,function(f,e){$("<tr>").appendTo(b).append($('<td style="text-align:right;width:20%">').text(e.key)).append($('<td style="width:80%">').append($('<input id="cfg'+e.id+'" type="'+e.type+'" class="'+e.type+'">').val(e.value)));if(e.type=="password"){$("#cfg"+e.id).val(ced46b($("#cfg"+e.id).val()))}});var d=document.getElementById("conf-table").rows.length;if(d==0){$('<tr id="rowNoTexts">').appendTo(b).append($("<td>").text("No Configurations defined."))}}notify(a.status,a.message)})}function loadRoles(){notify("busy","Loading Role Preferences...");$("#assist-roles li").each(function(a,b){$(b).remove()});$("#agile-roles li").each(function(a,b){$(b).remove()});$("#rolesloading").show();$.get("/AssistPlus/loadRoles?rnd="+Math.random(),function(a){$("#rolesloading").hide();if(a.hasOwnProperty("object")){var d=$("#assist-roles");var b=$("#agile-roles");$.each(a.object,function(e,f){if(f.priority<0){($("<li id="+f.roleID+' class="ui-state-default">').text(f.Role)).appendTo(b)}else{($("<li id="+f.roleID+' class="ui-state-default">').text(f.Role)).appendTo(d)}})}notify(a.status,a.message)})}function addNewAssistText(){if($("#h_classId").val()==""||$("#h_attrId").val()==""){notify("error","Please select a Class and Attribute to proceed")}else{notify("busy","Adding new Assist Text...");$.post("/AssistPlus/loadAssistTexts",{mode:"new",classId:$("#h_classId").val(),attrId:$("#h_attrId").val(),rnd:Math.random()},function(a){if(a.hasOwnProperty("object")){$("#rowNoTexts").remove();addAssistTextRow(a.object)}notify(a.status,a.message)},"json")}}function removeAssistText(a){notify("busy","Removing Assist Text entry...");$.post("/AssistPlus/loadAssistTexts",{mode:"remove",textId:a,rnd:Math.random()},function(b){if(b.status=="success"){$("#row"+a).remove()}notify(b.status,b.message)},"json")}function saveAssistText(a){notify("busy","Saving Assist Text entry...");var b=[];$("#roleop"+a+" :selected").each(function(d,e){b[d]=$(e).val()});$.post("/AssistPlus/loadAssistTexts",{mode:"save",textId:a,assistText:$("#txt"+a).val(),"roles[]":b,rnd:Math.random()},function(d){notify(d.status,d.message);if(d.status=="success"){$("#row"+a+" td").css("background","#ffffff")}},"json")}function refreshClassTable(){$("#h_classId").val("");$("#h_attrId").val("");loadClasses();truncateTable("attr-table");truncateTable("text-table")}function refreshAttributeTable(){$("#h_attrId").val("");$("#"+$("#h_classId").val()+" td").click();truncateTable("text-table")}function refreshAssistTextTable(){loadAssistTexts($("#h_classId").val(),$("#h_attrId").val())}function refreshRolesList(){loadRoles()}function truncateTable(a){var d=document.getElementById(a).rows.length;for(var b=d;b>0;b--){document.getElementById(a).deleteRow(b-1)}}function addAssistTextRow(d){var b=$("#text-table");var a=$('<select id="roleop'+d.textID+'" multiple="multiple" style="width=100%;">');$.each(d.roles,function(f,e){$(e).appendTo(a)});$('<tr id="row'+d.textID+'">').appendTo(b).append($('<td style="width:40%">').append(a)).append($('<td style="width:52%">').append('<textarea id="txt'+d.textID+'" class="assisttext" style="width=100%;">'+d.assistText+"</textarea>")).append($('<td style="width:4%;text-align:right;">').append("<a href=javascript:noaction(); onClick=saveAssistText("+d.textID+');><img alt="Save" title="Save" src="img/save.png"></a><br><a href=javascript:noaction(); onClick=removeAssistText('+d.textID+');><img alt="Remove" title="Remove" src="img/remove.png"></a>'));$("#roleop"+d.textID).autolist();$("#roleop"+d.textID).change(function(){$("#row"+d.textID+" td").css("background","#ffe4e1")});$("#txt"+d.textID).change(function(){$("#row"+d.textID+" td").css("background","#ffe4e1")})}function saveRolePriority(){if ($("#assist-roles li").length == 0) { refreshRolesList();setTimeout('notify("error","Atleast one role must be selected for Assist. Last saved preferences loaded.")', 1000);}  else { notify("busy","Saving Role Preferences...");var a=[];$("#assist-roles li").each(function(b,d){a[b]=($("#assist-roles li").length-$(d).index())+":"+$(d).text()+":"+$(d).attr("id")});$.post("/AssistPlus/loadRoles",{"roles[]":a,rnd:Math.random()},function(b){notify(b.status,b.message)},"json")}}function saveConfigurations(){notify("busy","Saving Configurations...");var a=[];$("#conf-table tr").each(function(b,d){if($(d).find(".text").val()==undefined){a[b]=($(d).eq(0).text()+"="+cne46b($(d).find(".password").val()))}else{a[b]=($(d).eq(0).text()+"="+$(d).find(".text").val())}});$.post("/AssistPlus/loadConfig",{"configs[]":a,rnd:Math.random()},function(b){notify(b.status,b.message)},"json")}function tblfilter(d,b,g){var f=d.value.toLowerCase().split(" ");var j=document.getElementById(b);var k;for(var a=0;a<j.rows.length;a++){k=j.rows[a].innerHTML.replace(/<[^>]+>/g,"");var h="none";for(var e=0;e<f.length;e++){if(k.toLowerCase().indexOf(f[e])>=0){h=""}else{h="none";break}}j.rows[a].style.display=h}}function lstfilter(d,j){var g=d.value.toLowerCase().split(" ");var f=document.getElementById(j);var b=f.getElementsByTagName("li");var k;for(var a=0;a<b.length;a++){k=b[a].innerHTML.replace(/<[^>]+>/g,"");var h="none";for(var e=0;e<g.length;e++){if(k.toLowerCase().indexOf(g[e])>=0){h=""}else{h="none";break}}b[a].style.display=h}}function notify(b,a){$(".notifimg").hide();$("#notifimg"+b).show();$("#notif").text(a)}function authenticate(){notify("busy","Authenticating...");$.post("/AssistPlus/auth",{mode:"login",une:$("#username").val(),pwd:$("#password").val(),rnd:Math.random()},function(a){if(a.status=="success"){$("#h_userId").val(a.object);$("#LoginForm").hide();$("#top-navigation").show();showConfTab()}$("#password").val("");notify(a.status,a.message)},"json")}function changePwd(){notify("busy","Changing Password...");if($("#npassword").val()==$("#cnpassword").val()){if(($("#npassword").val()==null)||($("#npassword").val().length==0)){notify("error","Password cannot be empty")}else{$.post("/AssistPlus/auth",{mode:"changepwd",uid:$("#h_userId").val(),cpwd:$("#cpassword").val(),npwd:$("#npassword").val(),rnd:Math.random()},function(a){$("#cpassword").val("");$("#npassword").val("");$("#cnpassword").val("");notify(a.status,a.message)},"json")}}else{notify("error","Passwords do not match");$("#npassword").val("");$("#cnpassword").val("")}}function togglevisibility(a){if($("#"+a).is(":hidden")){$("#"+a).show()}else{$("#"+a).hide()}}function showSection(a){$(".TabSection").hide();$("#"+a).show()}function noaction(){}var hexcase=0;var b64pad="=";function cne46b5dm(a){return rstr2b64(rstr_md5(str2rstr_utf8(a)))}function cne46b(a){if(a==""){return""}else{return rstr2b64(str2rstr_utf8(a))}}function rstr_md5(a){return binl2rstr(binl_md5(rstr2binl(a),a.length*8))}function rstr2b64(d){try{b64pad}catch(k){b64pad="="}var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b="";var a=d.length;for(var g=0;g<a;g+=3){var l=(d.charCodeAt(g)<<16)|(g+1<a?d.charCodeAt(g+1)<<8:0)|(g+2<a?d.charCodeAt(g+2):0);for(var f=0;f<4;f++){if(g*8+f*6>d.length*8){b+=b64pad}else{b+=h.charAt((l>>>6*(3-f))&63)}}}return b}function str2rstr_utf8(d){var b="";var e=-1;var a,f;while(++e<d.length){a=d.charCodeAt(e);f=e+1<d.length?d.charCodeAt(e+1):0;if(55296<=a&&a<=56319&&56320<=f&&f<=57343){a=65536+((a&1023)<<10)+(f&1023);e++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b}function rstr2binl(b){var a=Array(b.length>>2);for(var d=0;d<a.length;d++){a[d]=0}for(var d=0;d<b.length*8;d+=8){a[d>>5]|=(b.charCodeAt(d/8)&255)<<(d%32)}return a}function binl2rstr(b){var a="";for(var d=0;d<b.length*32;d+=8){a+=String.fromCharCode((b[d>>5]>>>(d%32))&255)}return a}function binl_md5(p,k){p[k>>5]|=128<<((k)%32);p[(((k+64)>>>9)<<4)+14]=k;var o=1732584193;var n=-271733879;var m=-1732584194;var l=271733878;for(var g=0;g<p.length;g+=16){var j=o;var h=n;var f=m;var e=l;o=md5_ff(o,n,m,l,p[g+0],7,-680876936);l=md5_ff(l,o,n,m,p[g+1],12,-389564586);m=md5_ff(m,l,o,n,p[g+2],17,606105819);n=md5_ff(n,m,l,o,p[g+3],22,-1044525330);o=md5_ff(o,n,m,l,p[g+4],7,-176418897);l=md5_ff(l,o,n,m,p[g+5],12,1200080426);m=md5_ff(m,l,o,n,p[g+6],17,-1473231341);n=md5_ff(n,m,l,o,p[g+7],22,-45705983);o=md5_ff(o,n,m,l,p[g+8],7,1770035416);l=md5_ff(l,o,n,m,p[g+9],12,-1958414417);m=md5_ff(m,l,o,n,p[g+10],17,-42063);n=md5_ff(n,m,l,o,p[g+11],22,-1990404162);o=md5_ff(o,n,m,l,p[g+12],7,1804603682);l=md5_ff(l,o,n,m,p[g+13],12,-40341101);m=md5_ff(m,l,o,n,p[g+14],17,-1502002290);n=md5_ff(n,m,l,o,p[g+15],22,1236535329);o=md5_gg(o,n,m,l,p[g+1],5,-165796510);l=md5_gg(l,o,n,m,p[g+6],9,-1069501632);m=md5_gg(m,l,o,n,p[g+11],14,643717713);n=md5_gg(n,m,l,o,p[g+0],20,-373897302);o=md5_gg(o,n,m,l,p[g+5],5,-701558691);l=md5_gg(l,o,n,m,p[g+10],9,38016083);m=md5_gg(m,l,o,n,p[g+15],14,-660478335);n=md5_gg(n,m,l,o,p[g+4],20,-405537848);o=md5_gg(o,n,m,l,p[g+9],5,568446438);l=md5_gg(l,o,n,m,p[g+14],9,-1019803690);m=md5_gg(m,l,o,n,p[g+3],14,-187363961);n=md5_gg(n,m,l,o,p[g+8],20,1163531501);o=md5_gg(o,n,m,l,p[g+13],5,-1444681467);l=md5_gg(l,o,n,m,p[g+2],9,-51403784);m=md5_gg(m,l,o,n,p[g+7],14,1735328473);n=md5_gg(n,m,l,o,p[g+12],20,-1926607734);o=md5_hh(o,n,m,l,p[g+5],4,-378558);l=md5_hh(l,o,n,m,p[g+8],11,-2022574463);m=md5_hh(m,l,o,n,p[g+11],16,1839030562);n=md5_hh(n,m,l,o,p[g+14],23,-35309556);o=md5_hh(o,n,m,l,p[g+1],4,-1530992060);l=md5_hh(l,o,n,m,p[g+4],11,1272893353);m=md5_hh(m,l,o,n,p[g+7],16,-155497632);n=md5_hh(n,m,l,o,p[g+10],23,-1094730640);o=md5_hh(o,n,m,l,p[g+13],4,681279174);l=md5_hh(l,o,n,m,p[g+0],11,-358537222);m=md5_hh(m,l,o,n,p[g+3],16,-722521979);n=md5_hh(n,m,l,o,p[g+6],23,76029189);o=md5_hh(o,n,m,l,p[g+9],4,-640364487);l=md5_hh(l,o,n,m,p[g+12],11,-421815835);m=md5_hh(m,l,o,n,p[g+15],16,530742520);n=md5_hh(n,m,l,o,p[g+2],23,-995338651);o=md5_ii(o,n,m,l,p[g+0],6,-198630844);l=md5_ii(l,o,n,m,p[g+7],10,1126891415);m=md5_ii(m,l,o,n,p[g+14],15,-1416354905);n=md5_ii(n,m,l,o,p[g+5],21,-57434055);o=md5_ii(o,n,m,l,p[g+12],6,1700485571);l=md5_ii(l,o,n,m,p[g+3],10,-1894986606);m=md5_ii(m,l,o,n,p[g+10],15,-1051523);n=md5_ii(n,m,l,o,p[g+1],21,-2054922799);o=md5_ii(o,n,m,l,p[g+8],6,1873313359);l=md5_ii(l,o,n,m,p[g+15],10,-30611744);m=md5_ii(m,l,o,n,p[g+6],15,-1560198380);n=md5_ii(n,m,l,o,p[g+13],21,1309151649);o=md5_ii(o,n,m,l,p[g+4],6,-145523070);l=md5_ii(l,o,n,m,p[g+11],10,-1120210379);m=md5_ii(m,l,o,n,p[g+2],15,718787259);n=md5_ii(n,m,l,o,p[g+9],21,-343485551);o=safe_add(o,j);n=safe_add(n,h);m=safe_add(m,f);l=safe_add(l,e)}return Array(o,n,m,l)}function md5_cmn(i,f,e,d,h,g){return safe_add(bit_rol(safe_add(safe_add(f,i),safe_add(d,g)),h),e)}function md5_ff(g,f,k,j,e,i,h){return md5_cmn((f&k)|((~f)&j),g,f,e,i,h)}function md5_gg(g,f,k,j,e,i,h){return md5_cmn((f&j)|(k&(~j)),g,f,e,i,h)}function md5_hh(g,f,k,j,e,i,h){return md5_cmn(f^k^j,g,f,e,i,h)}function md5_ii(g,f,k,j,e,i,h){return md5_cmn(k^(f|(~j)),g,f,e,i,h)}function safe_add(a,e){var d=(a&65535)+(e&65535);var b=(a>>16)+(e>>16)+(d>>16);return(b<<16)|(d&65535)}function bit_rol(a,b){return(a<<b)|(a>>>(32-b))}var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ced46b(d){var a="";var l,j,g="";var k,h,f,e="";var b=0;d=d.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{k=keyStr.indexOf(d.charAt(b++));h=keyStr.indexOf(d.charAt(b++));f=keyStr.indexOf(d.charAt(b++));e=keyStr.indexOf(d.charAt(b++));l=(k<<2)|(h>>4);j=((h&15)<<4)|(f>>2);g=((f&3)<<6)|e;a=a+String.fromCharCode(l);if(f!=64){a=a+String.fromCharCode(j)}if(e!=64){a=a+String.fromCharCode(g)}l=j=g="";k=h=f=e=""}while(b<d.length);return unescape(a)};